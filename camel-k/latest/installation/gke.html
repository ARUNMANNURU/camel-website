<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Installing Camel K on Google Kubernetes Engine (GKE) :: Apache Camel</title><link rel="canonical" href="https://camel.apache.org/staging/camel-k/latest/installation/gke.html"><meta name="generator" content="Antora 2.0.0"><link rel="stylesheet" href="../../../_/css/site.css"></head><body class="article"><header class="header"><nav class="navbar shadow border-bottom"><div class="navbar-brand"><a class="navbar-item nav-logo" href="../../.." title="Apache Camel"></a><button class="navbar-burger" data-target="topbar-nav"><span></span><span></span><span></span></button></div><div id="topbar-nav" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="../../../">Home</a><a class="navbar-item" href="../../../news/">News</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../../..#">Projects</a><div class="navbar-dropdown"><a class="navbar-item" href="../../../projects/camel-k/">Camel K</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../../..#">Documentation</a><div class="navbar-dropdown"><a class="navbar-item" href="../../../docs/getting-started/">Getting started</a><a class="navbar-item" href="../../../manual/latest/">User manual</a><a class="navbar-item" href="../../../components/latest/">Component reference</a><a class="navbar-item" href="../../../camel-k/latest/">Camel K</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../../..#">Community</a><div class="navbar-dropdown"><a class="navbar-item" href="../../../community/support/">Support</a><a class="navbar-item" href="../../..https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a><a class="navbar-item" href="../../../community/user-stories/">User stories</a><a class="navbar-item" href="../../../community/articles/">Articles</a><a class="navbar-item" href="../../../community/books/">Books</a><a class="navbar-item" href="../../../community/team/">Team</a><a class="navbar-item" href="../../../community/camel-extra/">Camel extra</a></div></div><a class="navbar-item" href="../../../download/">Download</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../../..#">About</a><div class="navbar-dropdown"><a class="navbar-item" href="../../..https://www.apache.org/events/current-event.html">Apache events</a><a class="navbar-item" href="../../..https://www.apache.org/licenses/">License</a><a class="navbar-item" href="../../../security/">Security</a><a class="navbar-item" href="../../..https://www.apache.org/foundation/sponsorship.html">Sponsorship</a><a class="navbar-item" href="../../..https://www.apache.org/foundation/thanks.html">Thanks</a></div></div></div></div></nav></header><div class="main-wrapper"><div class="navigation-container" data-component="camel-k" data-version="latest"><aside class="navigation"><div class="panels"><div class="navigation-menu is-active" data-panel="menu"><nav class="nav-menu"><h3 class="title"><a href="../index.html">Apache Camel K</a></h3><ul class="nav-list"><li class="nav-item" data-depth="0"><ul class="nav-list"><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="installation.html">Installation</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="minikube.html">Minikube</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="minishift.html">Minishift</a></li><li class="nav-item is-current-page" data-depth="2"><a class="nav-link" href="gke.html">Google Kubernetes Engine (GKE)</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="openshift.html">OpenShift</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="../running/running.html">Running</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="../running/dev-mode.html">Dev Mode</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="../configuration/configuration.html">Configuration</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/components.html">Components</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/logging.html">Logging</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/dependencies.html">Dependencies</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/configmap-secret.html">ConfigMap/Secret</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="../languages/languages.html">Languages</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="../languages/groovy.html">Groovy</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../languages/kotlin.html">Kotlin</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../languages/javascript.html">JavaScript</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../languages/java.html">Java</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../languages/xml.html">XML</a></li></ul></li><li class="nav-item" data-depth="1"><a class="nav-link" href="../traits.html">Traits</a></li><li class="nav-item" data-depth="1"><a class="nav-link" href="../uninstalling.html">Uninstalling</a></li></ul></li></ul></nav></div><div class="navigation-explore" data-panel="explore"><div class="context"><span class="title">Apache Camel K</span><span class="version">latest</span></div><ul class="components"><li class="component is-current"><span class="title">Apache Camel K</span><ul class="versions"><li class="version is-current is-latest"><a href="../index.html">latest</a></li></ul></li><li class="component"><span class="title">Component reference</span><ul class="versions"><li class="version is-latest"><a href="../../../components/latest/index.html">latest</a></li></ul></li><li class="component"><span class="title">User manual</span><ul class="versions"><li class="version is-latest"><a href="../../../manual/latest/index.html">latest</a></li></ul></li></ul></div></div></aside></div><main class="main"><div class="toolbar" role="navigation"><button class="navigation-toggle"></button><a href="../../../manual/latest/index.html" class="home-link"></a><nav class="crumbs" aria-label="breadcrumbs"><ul><li class="crumb"><a href="../index.html">Apache Camel K</a></li><li class="crumb"><a href="installation.html">Installation</a></li><li class="crumb"><a href="gke.html">Google Kubernetes Engine (GKE)</a></li></ul></nav><div class="edit-this-page"><a href="https://github.com/apache/camel-k/edit/antora/docs/modules/ROOT/pages/installation/gke.adoc">Edit this Page</a></div></div><article class="doc"><h1>Installing Camel K on Google Kubernetes Engine (GKE)</h1><div class="paragraph"><p>This guide assumes you&#8217;ve already created a Kubernetes Engine cluster on<a href="https://console.cloud.google.com" class="bare">https://console.cloud.google.com</a>.</p></div><div class="paragraph"><p>Make sure you&#8217;ve selected a version of Kubernetes greater than<strong>1.11</strong>when creating the cluster. You can create it in any region.</p></div><div class="paragraph"><p>In the list of clusters for the current project, GKE provides a connection string that you need to execute on a shell to configure the<code>kubectl</code>command.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">the connection string contains a<code>--project</code>flag that indicates your<strong>project ID</strong>. You should keep that information for the last step.</td></tr></table></div><div class="paragraph"><p>After executing the connection string, if everything is installed correctly, you should be able to execute:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code>kubectl get pod</code></pre></div></div><div class="paragraph"><p>When the cluster is first installed, you should find that "no pods are present" in the cluster. You can proceed with the installation then.</p></div><div class="paragraph"><p>Before installing Camel K on a fresh GKE cluster, you need to perform some extra steps to give to your account the required cluster-admin permissions. This means executing the following command (<strong>replacing "<a href="mailto:your-address@gmail.com">your-address@gmail.com</a>" with your account email address</strong>):</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code>kubectl create clusterrolebinding user-cluster-admin-binding --clusterrole=cluster-admin --user=your-address@gmail.com</code></pre></div></div><div class="paragraph"><p>The command above is needed to make sure your user is able to delegate some permissions to Camel K service accounts.</p></div><div class="paragraph"><p>Users of<strong>GKE</strong>are expected to use the<code>gcr.io</code>registry to push and pull images. In order to push images to<code>gcr.io</code>, you need to provide a valid key to Camel K. The best way to obtain a valid key is from the web console:</p></div><div class="ulist"><ul><li><p>Go to<a href="https://console.cloud.google.com" class="bare">https://console.cloud.google.com</a></p></li><li><p>Make sure the project where you created the Kubernetes cluster is selected in the drop-down list</p></li><li><p>To avoid confusion, it&#8217;s suggested to use the "English" language in preferences of the Google Cloud console</p></li><li><p>Select "IAM &amp; admin" from the navigation menu, then "Service accounts"</p></li><li><p>Create a new service account specifying the following id:<strong>"camel-k-builder"</strong></p></li><li><p>You&#8217;ll be asked to select a role. It&#8217;s important to select the<strong>"Storage Admin" role</strong>from the "Storage" menu</p></li><li><p>Finish creating the service account</p></li><li><p>From the action menu of the service account you&#8217;ve created,<strong>create a key</strong>using the JSON format</p></li></ul></div><div class="paragraph"><p>A<code>.json</code>file with the key will be downloaded to your machine. You need to store that key in a Kubernetes secret.</p></div><div class="paragraph"><p>It&#8217;s<strong>important</strong>to rename the file you&#8217;ve just downloaded to<code>kaniko-secret.json</code>(make sure you write it correctly). After the renaming, execute the following command to create the secret:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code>kubectl create secret generic kaniko-secret --from-file=kaniko-secret.json</code></pre></div></div><div class="paragraph"><p>You&#8217;re ready to install Camel K. You need to get the<strong>kamel</strong>CLI tool the from<a href="https://github.com/apache/camel-k/releases">release page</a>and put it on your system path.</p></div><div class="paragraph"><p>You should now execute the following command to install cluster resources and the operator (in the current namespace):</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code>kamel install --registry gcr.io --organization &lt;&lt;your-project-id&gt;&gt; --push-secret kaniko-secret</code></pre></div></div><div class="paragraph"><p>Use the project id that you&#8217;ve annotated when executing the first connection string.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content">the project id is<strong>NOT</strong>the cluster id!</td></tr></table></div><div class="paragraph"><p>You&#8217;re now ready to play with Camel K!</p></div></article></main></div><footer class="footer"><p>This page was built using the Antora default UI.</p><p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p></footer><script src="../../../_/js/site.js"></script><script src="../../../_/js/vendor/highlight.js"></script><script>hljs.initHighlighting()</script></body></html>