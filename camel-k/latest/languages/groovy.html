<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Writing Integrations in Groovy :: Apache Camel</title><link rel="canonical" href="https://camel.apache.org/camel-k/latest/languages/groovy.html"><meta name="generator" content="Antora 2.0.0-rc.1"><link rel="stylesheet" href="../../../_/css/site.css"></head><body class="article"><header class="header"><nav class="navbar"><div class="navbar-brand"><a class="navbar-item" href="https://camel.apache.org">Apache Camel</a><button class="navbar-burger" data-target="topbar-nav"><span></span><span></span><span></span></button></div><div id="topbar-nav" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="#">Home</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Products</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Product A</a><a class="navbar-item" href="#">Product B</a><a class="navbar-item" href="#">Product C</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Services</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Service A</a><a class="navbar-item" href="#">Service B</a><a class="navbar-item" href="#">Service C</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Resources</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Resource A</a><a class="navbar-item" href="#">Resource B</a><a class="navbar-item" href="#">Resource C</a></div></div><div class="navbar-item"><span class="control"><a class="button is-primary" href="#">Download</a></span></div></div></div></nav></header><div class="main-wrapper"><div class="navigation-container" data-component="camel-k" data-version="latest"><aside class="navigation"><div class="panels"><div class="navigation-menu is-active" data-panel="menu"><nav class="nav-menu"><h3 class="title"><a href="../index.html">Apache Camel K</a></h3><ul class="nav-list"><li class="nav-item" data-depth="0"><ul class="nav-list"><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="../installation/installation.html">Installation</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="../installation/minikube.html">Minikube</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../installation/minishift.html">Minishift</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../installation/gke.html">Google Kubernetes Engine (GKE)</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../installation/openshift.html">OpenShift</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="../running/running.html">Running</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="../running/dev-mode.html">Dev Mode</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="../configuration/configuration.html">Configuration</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/components.html">Components</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/logging.html">Logging</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/dependencies.html">Dependencies</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="../configuration/configmap-secret.html">ConfigMap/Secret</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="languages.html">Languages</a><ul class="nav-list"><li class="nav-item is-current-page" data-depth="2"><a class="nav-link" href="groovy.html">Groovy</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="kotlin.html">Kotlin</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="javascript.html">JavaScript</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="java.html">Java</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="xml.html">XML</a></li></ul></li><li class="nav-item" data-depth="1"><a class="nav-link" href="../traits.html">Traits</a></li><li class="nav-item" data-depth="1"><a class="nav-link" href="../uninstalling.html">Uninstalling</a></li></ul></li></ul></nav></div><div class="navigation-explore" data-panel="explore"><div class="context"><span class="title">Apache Camel K</span><span class="version">latest</span></div><ul class="components"><li class="component is-current"><span class="title">Apache Camel K</span><ul class="versions"><li class="version is-current is-latest"><a href="../index.html">latest</a></li></ul></li><li class="component"><span class="title">Component reference</span><ul class="versions"><li class="version is-latest"><a href="../../../components/latest/index.html">latest</a></li></ul></li><li class="component"><span class="title">User manual</span><ul class="versions"><li class="version is-latest"><a href="../../../manual/latest/index.html">latest</a></li></ul></li></ul></div></div></aside></div><main class="main"><div class="toolbar" role="navigation"><button class="navigation-toggle"></button><a href="../../../manual/latest/index.html" class="home-link"></a><nav class="crumbs" aria-label="breadcrumbs"><ul><li class="crumb"><a href="../index.html">Apache Camel K</a></li><li class="crumb"><a href="languages.html">Languages</a></li><li class="crumb"><a href="groovy.html">Groovy</a></li></ul></nav><div class="edit-this-page"><a href="https://github.com/apache/camel-k/edit/antora/docs/modules/ROOT/pages/languages/groovy.adoc">Edit this Page</a></div></div><article class="doc"><h1>Writing Integrations in Groovy</h1><div id="preamble"><div class="sectionbody"><div class="paragraph"><p>An integration written in Groovy looks very similar to a Java one except it can leverages Groovy&#8217;s language enhancements over Java:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">from('timer:tick')
    .process { it.in.body = 'Hello Camel K!' }
    .to('log:info')</code></pre></div></div><div class="paragraph"><p>Camel K extends the Camel Java DSL making it easier to configure the context in which the integration runs using the top level<em>context</em>block</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">context {
  // configure the context here
}</code></pre></div></div><div class="paragraph"><p>At the moment the enhanced DSL provides a way to bind items to the registry, to configure the components the context creates and some improvements over the REST DSL.</p></div></div></div><div class="sect1"><h2 id="_registry_configuration"><a class="anchor" href="#_registry_configuration"></a>Registry Configuration</h2><div class="sectionbody"><div class="paragraph"><p>The registry is accessible using the<em>registry</em>block inside the<em>context</em>one:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">context {
    registry {
      bind "my-cache", Caffeine.newBuilder().build() <i class="conum" data-value="1"></i><b>(1)</b>
      bind "my-processor", processor { <i class="conum" data-value="2"></i><b>(2)</b>
         it.in.body = 'Hello Camel K!'
      }
      bind "my-predicate", predicate { <i class="conum" data-value="3"></i><b>(3)</b>
         it.in.body != null
      }
    }
}</code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>bind a bean to the context</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>define a custom processor to be used later in the routes by ref</td></tr><tr><td><i class="conum" data-value="3"></i><b>3</b></td><td>define a custom predicate to be used later in the routes by ref</td></tr></table></div></div></div><div class="sect1"><h2 id="_components_configuration"><a class="anchor" href="#_components_configuration"></a>Components Configuration</h2><div class="sectionbody"><div class="paragraph"><p>Components can be configured within the<em>components</em>block inside the<em>context</em>one:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">context {
    components {
        'seda' { <i class="conum" data-value="1"></i><b>(1)</b>
            queueSize = 1234
            concurrentConsumers = 12
        }

        'log' { <i class="conum" data-value="2"></i><b>(2)</b>
            exchangeFormatter = {
                'body ==&gt; ' + it.in.body
            } as org.apache.camel.spi.ExchangeFormatter
        }
    }
}</code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>configure the properties of the component whit name<em>seda</em></td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>configure the properties of the component whit name<em>log</em></td></tr></table></div><div class="paragraph"><p>Setting the property<em>exchangeFormatter</em>looks a little ugly as you have to declare the type of your closure. For demonstration purpose we have created a Groovy extension module that simplify configuring the<em>exchangeFormatter</em>so you can rewrite your DSL as</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">context {
    components {
        ...

        'log' {
            formatter {
                'body ==&gt; ' + it.in.body
            }
        }
    }
}</code></pre></div></div><div class="paragraph"><p>which is much better.</p></div><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><div class="paragraph"><p>You can provide your custom extensions by packaging them in a dependency you declare for your integration.</p></div></td></tr></table></div></div></div><div class="sect1"><h2 id="_rest_endpoints"><a class="anchor" href="#_rest_endpoints"></a>Rest Endpoints</h2><div class="sectionbody"><div class="paragraph"><p>Integrations&#8217;s REST endpoints can be configured using the top level<em>rest</em>block:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">rest {
    configuration { <i class="conum" data-value="1"></i><b>(1)</b>
        host = 'my-host'
        port '9192'
    }

    path('/my/path') { <i class="conum" data-value="2"></i><b>(2)</b>
        // standard Rest DSL
    }
}</code></pre></div></div><div class="colist arabic"><table><tr><td><i class="conum" data-value="1"></i><b>1</b></td><td>Configure the rest engine</td></tr><tr><td><i class="conum" data-value="2"></i><b>2</b></td><td>Configure the rest endpoint for the base path '/my/path'</td></tr></table></div></div></div></article></main></div><footer class="footer"><p>This page was built using the Antora default UI.</p><p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p></footer><script src="../../../_/js/site.js"></script><script src="../../../_/js/vendor/highlight.js"></script><script>hljs.initHighlighting()</script></body></html>