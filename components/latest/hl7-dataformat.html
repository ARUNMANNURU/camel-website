<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>HL7 DataFormat - Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/components/latest/hl7-dataformat.html"> <meta name="generator" content="Antora 2.1.0"> <link rel="stylesheet" href="../../_/css/site-1c739ae396.css"> <meta name="application-name" content="Apache Camel"> <link rel="manifest" href="../../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar"> <div class="navbar-brand"> <a class="nav-logo" href="../.."><span>Apache Camel</span></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item" href="../../blog/">Blog</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Projects</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../projects/camel-k/">Camel K</a> <a class="navbar-item" href="../../projects/camel-quarkus/">Camel Quarkus</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Documentation</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../docs/getting-started/">Getting started</a> <a class="navbar-item" href="../../manual/latest/">User manual</a> <a class="navbar-item" href="../../components/latest/">Component reference</a> <a class="navbar-item" href="../../camel-k/latest/">Camel K</a> <a class="navbar-item" href="../../camel-quarkus/latest/">Camel Quarkus</a> <a class="navbar-item" href="../../manual/latest/enterprise-integration-patterns.html">Enterprise Integration Patterns</a> <a class="navbar-item" href="../../manual/latest/camel-3-migration-guide.html">Camel 3 Migration Guide</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Community</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../community/support/">Support</a> <a class="navbar-item" href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a> <a class="navbar-item" href="../../community/user-stories/">User stories</a> <a class="navbar-item" href="../../community/articles/">Articles</a> <a class="navbar-item" href="../../community/books/">Books</a> <a class="navbar-item" href="../../community/team/">Team</a> </div> </div> <a class="navbar-item" href="../../download/">Download</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">About</a> <div class="navbar-dropdown"> <a class="navbar-item" href="https://www.apache.org/events/current-event.html">Apache events</a> <a class="navbar-item" href="https://www.apache.org/licenses/">License</a> <a class="navbar-item" href="../../security/">Security</a> <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a> <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a> </div> </div> </div> </div> <div class="navbar-tools"> <a href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#github"/></svg></a> <a href="https://gitter.im/apache/apache-camel" title="Chat on Gitter"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#gitter"/></svg></a> <a href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#twitter"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <div class="body"> <div class="nav-container" data-component="components" data-version="latest"> <aside class="nav"> <div class="panels"> <div class="nav-panel-explore is-active" data-panel="explore"> <div class="context"> <span class="title">Component reference</span> <span class="version">latest</span> </div> <ul class="components"> <li class="component"> <span class="title">Apache Camel extensions for Quarkus</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-quarkus/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Apache Camel K</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-k/latest/index.html">latest</a> </li> </ul> </li> <li class="component is-current"> <span class="title">Component reference</span> <ul class="versions"> <li class="version is-current is-latest"> <a href="index.html">latest</a> </li> <li class="version"> <a href="../2.x/index.html">2.x</a> </li> </ul> </li> <li class="component"> <span class="title">User manual</span> <ul class="versions"> <li class="version is-latest"> <a href="../../manual/latest/index.html">latest</a> </li> </ul> </li> </ul> </div> </div> </aside> </div> <main role="main"> <div class="toolbar" role="navigation"> <button class="nav-toggle"></button> <a href="../../manual/latest/index.html" class="home-link"></a> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">Component reference</a></li> <li><a href="hl7-dataformat.html">HL7 DataFormat</a></li> </ul> </nav> <div class="page-versions"> <button class="version-menu-toggle" title="Show other versions of page" type="button">latest</button> <div class="version-menu"> <a class="version is-current" href="hl7-dataformat.html">latest</a> <a class="version" href="../2.x/hl7-dataformat.html">2.x</a> </div> </div> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/master/components/camel-hl7/src/main/docs/hl7-dataformat.adoc">Edit this Page</a></div> </div> <article class="doc"> <h1 class="page">HL7 DataFormat</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel version 2.0</strong></p> </div> <div class="paragraph"> <p>The HL7 component is used for working with the HL7 MLLP protocol and <a href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=185">HL7 v2 messages</a> using the <a href="http://hl7api.sourceforge.net">HAPI library</a>.</p> </div> <div class="paragraph"> <p>This component supports the following:</p> </div> <div class="ulist"> <ul> <li> <p>HL7 MLLP codec for <a href="mina-component.html" class="page">Mina</a></p> </li> <li> <p>HL7 MLLP codec for <a href="netty-component.html" class="page">Netty</a></p> </li> <li> <p>Type Converter from/to HAPI and String</p> </li> <li> <p>HL7 DataFormat using the HAPI library</p> </li> <li> <p>Even more ease-of-use as it&#8217;s integrated well with the <a href="mina-component.html" class="page">camel-mina</a> component.</p> </li> </ul> </div> <div class="paragraph"> <p>Maven users will need to add the following dependency to their <code>pom.xml</code> for this component:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
    &lt;artifactId&gt;camel-hl7&lt;/artifactId&gt;
    &lt;version&gt;x.x.x&lt;/version&gt;
    &lt;!-- use the same version as your Camel core version --&gt;
&lt;/dependency&gt;</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_hl7_mllp_protocol"><a class="anchor" href="#_hl7_mllp_protocol"></a>HL7 MLLP protocol</h2> <div class="sectionbody"> <div class="paragraph"> <p>HL7 is often used with the HL7 MLLP protocol, which is a text based TCP socket based protocol. This component ships with a Mina and Netty Codec that conforms to the MLLP protocol so you can easily expose an HL7 listener accepting HL7 requests over the TCP transport layer. To expose a HL7 listener service, the <a href="mina-component.html" class="page">camel-mina</a> or <a href="netty-component.html" class="page">camel-netty</a> component is used with the <code>HL7MLLPCodec</code> (mina) or <code>HL7MLLPNettyDecoder/HL7MLLPNettyEncoder</code> (Netty).</p> </div> <div class="paragraph"> <p>HL7 MLLP codec can be configured as follows:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Default Value</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>startByte</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x0b</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The start byte spanning the HL7 payload.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>endByte1</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x1c</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The first end byte spanning the HL7 payload.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>endByte2</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>0x0d</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The 2nd end byte spanning the HL7 payload.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>charset</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">JVM Default</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The encoding (a <a href="http://docs.oracle.com/javase/6/docs/api/java/nio/charset/Charset.html">charset name</a>) to use for the codec. If not provided, Camel will use the <a href="http://docs.oracle.com/javase/6/docs/api/java/nio/charset/Charset.html#defaultCharset()">JVM default Charset</a>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>produceString</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If true, the codec creates a string using the defined charset. If false, the codec sends a plain byte array into the route, so that the HL7 Data Format can determine the actual charset from the HL7 message content.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>convertLFtoCR</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Will convert <code>\n</code> to <code>\r</code> (<code>0x0d</code>, 13 decimal) as HL7 stipulates <code>\r</code> as segment terminators. The HAPI library requires the use of <code>\r</code>.</p></td> </tr> </tbody> </table></div> <div class="sect2"> <h3 id="_exposing_an_hl7_listener_using_mina"><a class="anchor" href="#_exposing_an_hl7_listener_using_mina"></a>Exposing an HL7 listener using Mina</h3> <div class="paragraph"> <p>In the Spring XML file, we configure a mina endpoint to listen for HL7 requests using TCP on port <code>8888</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;endpoint id="hl7MinaListener" uri="mina:tcp://localhost:8888?sync=true&amp;amp;codec=#hl7codec"/&gt;</code></pre> </div> </div> <div class="paragraph"> <p><strong>sync=true</strong> indicates that this listener is synchronous and therefore will return a HL7 response to the caller. The HL7 codec is setup with <strong>codec=#hl7codec</strong>. Note that <code>hl7codec</code> is just a Spring bean ID, so it could be named <code>mygreatcodecforhl7</code> or whatever. The codec is also set up in the Spring XML file:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="hl7codec" class="org.apache.camel.component.hl7.HL7MLLPCodec"&gt;
    &lt;property name="charset" value="iso-8859-1"/&gt;
&lt;/bean&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The endpoint <strong>hl7MinaLlistener</strong> can then be used in a route as a consumer, as this Java DSL example illustrates:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("hl7MinaListener")
  .bean("patientLookupService");</code></pre> </div> </div> <div class="paragraph"> <p>This is a very simple route that will listen for HL7 and route it to a service named <strong>patientLookupService</strong>. This is also Spring bean ID, configured in the Spring XML as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="patientLookupService" class="com.mycompany.healthcare.service.PatientLookupService"/&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The business logic can be implemented in POJO classes that do not depend on Camel, as shown here:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import ca.uhn.hl7v2.HL7Exception;
import ca.uhn.hl7v2.model.Message;
import ca.uhn.hl7v2.model.v24.segment.QRD;

public class PatientLookupService {
    public Message lookupPatient(Message input) throws HL7Exception {
        QRD qrd = (QRD)input.get("QRD");
        String patientId = qrd.getWhoSubjectFilter(0).getIDNumber().getValue();

        // find patient data based on the patient id and create a HL7 model object with the response
        Message response = ... create and set response data
        return response
    }</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="_exposing_an_hl7_listener_using_netty_available_from_camel_2_15_onwards"><a class="anchor" href="#_exposing_an_hl7_listener_using_netty_available_from_camel_2_15_onwards"></a>Exposing an HL7 listener using Netty (available from Camel 2.15 onwards)</h3> <div class="paragraph"> <p>In the Spring XML file, we configure a netty endpoint to listen for HL7 requests using TCP on port <code>8888</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;endpoint id="hl7NettyListener" uri="netty:tcp://localhost:8888?sync=true&amp;amp;encoder=#hl7encoder&amp;amp;decoder=#hl7decoder"/&gt;</code></pre> </div> </div> <div class="paragraph"> <p><strong>sync=true</strong> indicates that this listener is synchronous and therefore will return a HL7 response to the caller. The HL7 codec is setup with <strong>encoder=#hl7encoder*and*decoder=#hl7decoder</strong>. Note that <code>hl7encoder</code> and <code>hl7decoder</code> are just bean IDs, so they could be named differently. The beans can be set in the Spring XML file:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="hl7decoder" class="org.apache.camel.component.hl7.HL7MLLPNettyDecoderFactory"/&gt;
&lt;bean id="hl7encoder" class="org.apache.camel.component.hl7.HL7MLLPNettyEncoderFactory"/&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The endpoint <strong>hl7NettyListener</strong> can then be used in a route as a consumer, as this Java DSL example illustrates:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("hl7NettyListener")
  .bean("patientLookupService");</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_hl7_model_using_java_lang_string_or_byte"><a class="anchor" href="#_hl7_model_using_java_lang_string_or_byte"></a>HL7 Model using java.lang.String or byte[]</h2> <div class="sectionbody"> <div class="paragraph"> <p>The HL7 MLLP codec uses plain String as its data format. Camel uses its Type Converter to convert to/from strings to the HAPI HL7 model objects, but you can use the plain String objects if you prefer, for instance if you wish to parse the data yourself.</p> </div> <div class="paragraph"> <p>You can also let both the Mina and Netty codecs use a plain <code>byte[]</code> as its data format by setting the <code>produceString</code> property to false. The Type Converter is also capable of converting the <code>byte[]</code> to/from HAPI HL7 model objects.</p> </div> </div> </div> <div class="sect1"> <h2 id="_hl7v2_model_using_hapi"><a class="anchor" href="#_hl7v2_model_using_hapi"></a>HL7v2 Model using HAPI</h2> <div class="sectionbody"> <div class="paragraph"> <p>The HL7v2 model uses Java objects from the HAPI library. Using this library, you can encode and decode from the EDI format (ER7) that is mostly used with HL7v2.</p> </div> <div class="paragraph"> <p>The sample below is a request to lookup a patient with the patient ID <code>0101701234</code>.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">MSH|^~\\&amp;|MYSENDER|MYRECEIVER|MYAPPLICATION||200612211200||QRY^A19|1234|P|2.4
QRD|200612211200|R|I|GetPatient|||1^RD|0101701234|DEM||</code></pre> </div> </div> <div class="paragraph"> <p>Using the HL7 model you can work with a <code>ca.uhn.hl7v2.model.Message</code> object, e.g. to retrieve a patient ID:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Message msg = exchange.getIn().getBody(Message.class);
QRD qrd = (QRD)msg.get("QRD");
String patientId = qrd.getWhoSubjectFilter(0).getIDNumber().getValue();  // 0101701234</code></pre> </div> </div> <div class="paragraph"> <p>This is powerful when combined with the HL7 listener, because you don&#8217;t have to work with <code>byte[]</code>, <code>String</code> or any other simple object formats. You can just use the HAPI HL7v2 model objects. If you know the message type in advance, you can be more type-safe:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">QRY_A19 msg = exchange.getIn().getBody(QRY_A19.class);
String patientId = msg.getQRD().getWhoSubjectFilter(0).getIDNumber().getValue();</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_hl7_dataformat"><a class="anchor" href="#_hl7_dataformat"></a>HL7 DataFormat</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <a href="#">HL7</a> component ships with a HL7 data format that can be used to marshal or unmarshal HL7 model objects.</p> </div> <div class="paragraph"> <p>The HL7 dataformat supports 2 options, which are listed below.</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Default</th> <th class="tableblock halign-left valign-top">Java Type</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>validate</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to validate the HL7 message Is by default true.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>contentTypeHeader</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether the data format should set the Content-Type header with the type from the data format if the data format is capable of doing so. For example application/xml for data formats marshalling to XML, or application/json for data formats marshalling to JSon etc.</p></td> </tr> </tbody> </table></div> </div> </div> <div class="sect1"> <h2 id="_spring_boot_auto_configuration"><a class="anchor" href="#_spring_boot_auto_configuration"></a>Spring Boot Auto-Configuration</h2> <div class="sectionbody"> <div class="paragraph"> <p>When using Spring Boot make sure to use the following Maven dependency to have support for auto configuration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
  &lt;artifactId&gt;camel-hl7-starter&lt;/artifactId&gt;
  &lt;version&gt;x.x.x&lt;/version&gt;
  &lt;!-- use the same version as your Camel core version --&gt;
&lt;/dependency&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The component supports 3 options, which are listed below.</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-center valign-top">Default</th> <th class="tableblock halign-left valign-top">Type</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.dataformat.hl7.content-type-header</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether the data format should set the Content-Type header with the type from the data format if the data format is capable of doing so. For example application/xml for data formats marshalling to XML, or application/json for data formats marshalling to JSon etc.</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.dataformat.hl7.enabled</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Enable hl7 dataformat</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.dataformat.hl7.validate</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to validate the HL7 message Is by default true.</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> </tbody> </table></div> <div class="ulist"> <ul> <li> <p><code>marshal</code> = from Message to byte stream (can be used when responding using the HL7 MLLP codec)</p> </li> <li> <p><code>unmarshal</code> = from byte stream to Message (can be used when receiving streamed data from the HL7 MLLP</p> </li> </ul> </div> <div class="paragraph"> <p>To use the data format, simply instantiate an instance and invoke the marshal or unmarshal operation in the route builder:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  DataFormat hl7 = new HL7DataFormat();

  from("direct:hl7in")
    .marshal(hl7)
    .to("jms:queue:hl7out");</code></pre> </div> </div> <div class="paragraph"> <p>In the sample above, the HL7 is marshalled from a HAPI Message object to a byte stream and put on a JMS queue.<br> The next example is the opposite:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  DataFormat hl7 = new HL7DataFormat();

  from("jms:queue:hl7out")
    .unmarshal(hl7)
    .to("patientLookupService");</code></pre> </div> </div> <div class="paragraph"> <p>Here we unmarshal the byte stream into a HAPI Message object that is passed to our patient lookup service.</p> </div> <div class="sect2"> <h3 id="_serializable_messages"><a class="anchor" href="#_serializable_messages"></a>Serializable messages</h3> <div class="paragraph"> <p>As of HAPI 2.0, the HL7v2 model classes are fully serializable. So you can put HL7v2 messages directly into a JMS queue (i.e. without calling <code>marshal()</code> and read them again directly from the queue (i.e. without calling <code>unmarshal()</code>.</p> </div> </div> <div class="sect2"> <h3 id="_segment_separators"><a class="anchor" href="#_segment_separators"></a>Segment separators</h3> <div class="paragraph"> <p>Unmarshalling does not automatically fix segment separators anymore by converting <code>\n</code> to <code>\r</code>. If you <br> need this conversion, <code>org.apache.camel.component.hl7.HL7#convertLFToCR</code> provides a handy <code>Expression</code> for this purpose.</p> </div> </div> <div class="sect2"> <h3 id="_charset"><a class="anchor" href="#_charset"></a>Charset</h3> <div class="paragraph"> <p>Both <code>marshal and unmarshal</code> evaluate the charset provided in the field <code>MSH-18</code>. If this field is empty, by default the charset contained in the corresponding Camel charset property/header is assumed. You can even change this default behavior by overriding the <code>guessCharsetName</code> method when inheriting from the <code>HL7DataFormat</code> class.</p> </div> <div class="paragraph"> <p>There is a shorthand syntax in Camel for well-known data formats that are commonly used. Then you don&#8217;t need to create an instance of the <code>HL7DataFormat</code> object:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  from("direct:hl7in")
    .marshal().hl7()
    .to("jms:queue:hl7out");

  from("jms:queue:hl7out")
    .unmarshal().hl7()
    .to("patientLookupService");</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="_message_headers"><a class="anchor" href="#_message_headers"></a>Message Headers</h2> <div class="sectionbody"> <div class="paragraph"> <p>The unmarshal operation adds these fields from the MSH segment as headers on the Camel message:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Key</th> <th class="tableblock halign-left valign-top">MSH field</th> <th class="tableblock halign-left valign-top">Example</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7SendingApplication</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-3</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MYSERVER</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7SendingFacility</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-4</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MYSERVERAPP</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7ReceivingApplication</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-5</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MYCLIENT</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7ReceivingFacility</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-6</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MYCLIENTAPP</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7Timestamp</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-7</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>20071231235900</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7Security</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-8</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>null</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7MessageType</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-9-1</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>ADT</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7TriggerEvent</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-9-2</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>A01</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7MessageControl</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-10</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>1234</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7ProcessingId</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-11</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>P</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7VersionId</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-12</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.4</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">`CamelHL7Context</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">``</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>contains the <a href="http://hl7api.sourceforge.net/base/apidocs/ca/uhn/hl7v2/HapiContext.html">HapiContext</a> that was used to parse the message</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CamelHL7Charset</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>MSH-18</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>UNICODE UTF-8</code></p></td> </tr> </tbody> </table></div> <div class="paragraph"> <p>All headers except <code>CamelHL7Context `are `String</code> types. If a header value is missing, its value is <code>null</code>.</p> </div> </div> </div> <div class="sect1"> <h2 id="_dependencies"><a class="anchor" href="#_dependencies"></a>Dependencies</h2> <div class="sectionbody"> <div class="paragraph"> <p>To use HL7 in your Camel routes you&#8217;ll need to add a dependency on <strong>camel-hl7</strong> listed above, which implements this data format.</p> </div> <div class="paragraph"> <p>The HAPI library is split into a <a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-base">base library</a> and several structure libraries, one for each HL7v2 message version:</p> </div> <div class="ulist"> <ul> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v21">v2.1 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v22">v2.2 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v23">v2.3 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v231">v2.3.1 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v24">v2.4 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v25">v2.5 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v251">v2.5.1 structures library</a></p> </li> <li> <p><a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-structures-v26">v2.6 structures library</a></p> </li> </ul> </div> <div class="paragraph"> <p>By default <code>camel-hl7</code> only references the HAPI <a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-base">base library</a>. Applications are responsible for including structure libraries themselves. For example, if an application works with HL7v2 message versions 2.4 and 2.5 then the following dependencies must be added:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt;
    &lt;artifactId&gt;hapi-structures-v24&lt;/artifactId&gt;
    &lt;version&gt;2.2&lt;/version&gt;
    &lt;!-- use the same version as your hapi-base version --&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt;
    &lt;artifactId&gt;hapi-structures-v25&lt;/artifactId&gt;
    &lt;version&gt;2.2&lt;/version&gt;
    &lt;!-- use the same version as your hapi-base version --&gt;
&lt;/dependency&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Alternatively, an OSGi bundle containing the base library, all structures libraries and required dependencies (on the bundle classpath) can be downloaded from the <a href="http://repo1.maven.org/maven2/ca/uhn/hapi/hapi-osgi-base">central Maven repository</a>.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;ca.uhn.hapi&lt;/groupId&gt;
    &lt;artifactId&gt;hapi-osgi-base&lt;/artifactId&gt;
    &lt;version&gt;2.2&lt;/version&gt;
&lt;/dependency&gt;</code></pre> </div> </div> </div> </div> </article> </main> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../../_/img/logo-d.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <dl> <dt>Overview</dt> <dd><a href="../../blog/">Blog</a></dd> <dd><a href="../../components/latest/">Components</a></dd> <dd><a href="../../download/">Download</a></dd> <dd><a href="../../docs/getting-started/">Getting started</a></dd> <dd><a href="../../manual/latest/faq.html">FAQ</a></dd> </dl> <dl> <dt>Community</dt> <dd><a href="../../community/support/">Support</a></dd> <dd><a href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a></dd> <dd><a href="../../community/user-stories/">User stories</a></dd> <dd><a href="../../community/articles/">Articles</a></dd> <dd><a href="../../community/books/">Books</a></dd> <dd><a href="../../community/team/">Team</a></dd> </dl> <dl> <dt>About</dt> <dd><a href="../../acknowledgments/">Acknowledgments</a> </dd><dd><a target="_blank" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p> &copy; 2004-2019 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> </div> </footer> <script src="../../_/js/site-f4f4dbc142.js"></script> <script async src="../../_/js/vendor/highlight-54157f17f1.js"></script> <script async src="../../_/js/vendor/svg4everybody-195d47ce7d.js"></script> <script type="application/ld+json"> {
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Apache Camel",
  "url": "https://camel.apache.org",
  "sameAs": [
     "https://twitter.com/ApacheCamel"
  ],
  "logo": "../../_/img/logo-d.svg",
  "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL."
} </script> <script type="application/ld+json"> { 
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Apache Camel",
        "item": "https://camel.apache.org"
        },
        {
        "@type": "ListItem",
        "position": 2,
        "name": "Component reference",
        "item": "https://camel.apache.org/components/latest/index.html"
        },
        {
        "@type": "ListItem",
        "position": 3,
        "name": "HL7 DataFormat","item": "https://camel.apache.org/components/latest/hl7-dataformat.html"}
        ]
    } </script> </body> </html> 