<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>XPath Language - Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/components/latest/xpath-language.html"> <meta name="generator" content="Antora 2.1.0"> <link rel="stylesheet" href="../../_/css/site-1c739ae396.css"> <meta name="application-name" content="Apache Camel"> <link rel="manifest" href="../../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar"> <div class="navbar-brand"> <a class="nav-logo" href="../.."><span>Apache Camel</span></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item" href="../../blog/">Blog</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Projects</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../projects/camel-k/">Camel K</a> <a class="navbar-item" href="../../projects/camel-quarkus/">Camel Quarkus</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Documentation</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../docs/getting-started/">Getting started</a> <a class="navbar-item" href="../../manual/latest/">User manual</a> <a class="navbar-item" href="../../components/latest/">Component reference</a> <a class="navbar-item" href="../../camel-k/latest/">Camel K</a> <a class="navbar-item" href="../../camel-quarkus/latest/">Camel Quarkus</a> <a class="navbar-item" href="../../manual/latest/enterprise-integration-patterns.html">Enterprise Integration Patterns</a> <a class="navbar-item" href="../../manual/latest/camel-3-migration-guide.html">Camel 3 Migration Guide</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Community</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../community/support/">Support</a> <a class="navbar-item" href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a> <a class="navbar-item" href="../../community/user-stories/">User stories</a> <a class="navbar-item" href="../../community/articles/">Articles</a> <a class="navbar-item" href="../../community/books/">Books</a> <a class="navbar-item" href="../../community/team/">Team</a> </div> </div> <a class="navbar-item" href="../../download/">Download</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">About</a> <div class="navbar-dropdown"> <a class="navbar-item" href="https://www.apache.org/events/current-event.html">Apache events</a> <a class="navbar-item" href="https://www.apache.org/licenses/">License</a> <a class="navbar-item" href="../../security/">Security</a> <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a> <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a> </div> </div> </div> </div> <div class="navbar-tools"> <a href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#github"/></svg></a> <a href="https://gitter.im/apache/apache-camel" title="Chat on Gitter"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#gitter"/></svg></a> <a href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#twitter"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <div class="body"> <div class="nav-container" data-component="components" data-version="latest"> <aside class="nav"> <div class="panels"> <div class="nav-panel-explore is-active" data-panel="explore"> <div class="context"> <span class="title">Component reference</span> <span class="version">latest</span> </div> <ul class="components"> <li class="component"> <span class="title">Apache Camel extensions for Quarkus</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-quarkus/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Apache Camel K</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-k/latest/index.html">latest</a> </li> </ul> </li> <li class="component is-current"> <span class="title">Component reference</span> <ul class="versions"> <li class="version is-current is-latest"> <a href="index.html">latest</a> </li> <li class="version"> <a href="../2.x/index.html">2.x</a> </li> </ul> </li> <li class="component"> <span class="title">User manual</span> <ul class="versions"> <li class="version is-latest"> <a href="../../manual/latest/index.html">latest</a> </li> </ul> </li> </ul> </div> </div> </aside> </div> <main role="main"> <div class="toolbar" role="navigation"> <button class="nav-toggle"></button> <a href="../../manual/latest/index.html" class="home-link"></a> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">Component reference</a></li> <li><a href="xpath-language.html">XPath Language</a></li> </ul> </nav> <div class="page-versions"> <button class="version-menu-toggle" title="Show other versions of page" type="button">latest</button> <div class="version-menu"> <a class="version is-current" href="xpath-language.html">latest</a> <a class="version is-missing" href="../2.x/index.html">2.x</a> </div> </div> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/master/components/camel-xpath/src/main/docs/xpath-language.adoc">Edit this Page</a></div> </div> <article class="doc"> <h1 class="page">XPath Language</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel version 1.1</strong></p> </div> <div class="paragraph"> <p>Camel supports <a href="http://www.w3.org/TR/xpath">XPath</a> to allow an Expression or Predicate to be used in the DSL or <a href="../../manual/latest/xml-configuration.html" class="page">Xml Configuration</a>. For example you could use XPath to create an Predicate in a <a href="../../manual/latest/filter-eip.html" class="page">Message Filter</a> or as an Expression for a Recipient List.</p> </div> <div class="paragraph"> <p><strong>Streams</strong></p> </div> <div class="paragraph"> <p>If the message body is stream based, which means the input it receives is submitted to Camel as a stream. That means you will only be able to read the content of the stream <strong>once</strong>. So often when you use <a href="#">XPath</a> as <a href="#">Message Filter</a> or Content Based Router then you need to access the data multiple times, and you should use Stream Caching or convert the message body to a <code>String</code> prior which is safe to be re-read multiple times.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("queue:foo").
  filter().xpath("//foo")).
  to("queue:bar")</code></pre> </div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("queue:foo").
  choice().xpath("//foo")).to("queue:bar").
  otherwise().to("queue:others");</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_xpath_language_options"><a class="anchor" href="#_xpath_language_options"></a>XPath Language options</h2> <div class="sectionbody"> <div class="paragraph"> <p>The XPath language supports 9 options, which are listed below.</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Default</th> <th class="tableblock halign-left valign-top">Java Type</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">documentType</p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Name of class for document type The default value is org.w3c.dom.Document</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">resultType</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>NODESET</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Sets the class name of the result type (type from output) The default result type is NodeSet</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">saxon</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to use Saxon.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">factoryRef</p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">References to a custom XPathFactory to lookup in the registry</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">objectModel</p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The XPath object model to use</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">logNamespaces</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to log namespaces which can assist during trouble shooting</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">headerName</p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Name of header to use as input, instead of the message body</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">threadSafety</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to enable thread-safety for the returned result of the xpath expression. This applies to when using NODESET as the result type, and the returned set has multiple elements. In this situation there can be thread-safety issues if you process the NODESET concurrently such as from a Camel Splitter EIP in parallel processing mode. This option prevents concurrency issues by doing defensive copies of the nodes. It is recommended to turn this option on if you are using camel-saxon or Saxon in your application. Saxon has thread-safety issues which can be prevented by turning this option on.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">trim</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to trim the value to remove leading and trailing whitespaces and line breaks</p></td> </tr> </tbody> </table></div> </div> </div> <div class="sect1"> <h2 id="_spring_boot_auto_configuration"><a class="anchor" href="#_spring_boot_auto_configuration"></a>Spring Boot Auto-Configuration</h2> <div class="sectionbody"> <div class="paragraph"> <p>When using Spring Boot make sure to use the following Maven dependency to have support for auto configuration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
  &lt;artifactId&gt;camel-xpath-starter&lt;/artifactId&gt;
  &lt;version&gt;x.x.x&lt;/version&gt;
  &lt;!-- use the same version as your Camel core version --&gt;
&lt;/dependency&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The component supports 8 options, which are listed below.</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-center valign-top">Default</th> <th class="tableblock halign-left valign-top">Type</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.document-type</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Name of class for document type The default value is org.w3c.dom.Document</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.enabled</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to enable auto configuration of the xpath language. This is enabled by default.</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.factory-ref</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">References to a custom XPathFactory to lookup in the registry</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.log-namespaces</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to log namespaces which can assist during trouble shooting</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.object-model</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The XPath object model to use</p></td> <td class="tableblock halign-center valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.saxon</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to use Saxon.</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.thread-safety</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to enable thread-safety for the returned result of the xpath expression. This applies to when using NODESET as the result type, and the returned set has multiple elements. In this situation there can be thread-safety issues if you process the NODESET concurrently such as from a Camel Splitter EIP in parallel processing mode. This option prevents concurrency issues by doing defensive copies of the nodes. It is recommended to turn this option on if you are using camel-saxon or Saxon in your application. Saxon has thread-safety issues which can be prevented by turning this option on.</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><strong>camel.language.xpath.trim</strong></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to trim the value to remove leading and trailing whitespaces and line breaks</p></td> <td class="tableblock halign-center valign-top"><p class="tableblock">true</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td> </tr> </tbody> </table></div> </div> </div> <div class="sect1"> <h2 id="_namespaces"><a class="anchor" href="#_namespaces"></a>Namespaces</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can easily use namespaces with XPath expressions using the Namespaces helper class.</p> </div> </div> </div> <div class="sect1"> <h2 id="_variables"><a class="anchor" href="#_variables"></a>Variables</h2> <div class="sectionbody"> <div class="paragraph"> <p>Variables in XPath is defined in different namespaces. The default namespace is <code>http://camel.apache.org/schema/spring</code>.</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Namespace URI</th> <th class="tableblock halign-left valign-top">Local part</th> <th class="tableblock halign-left valign-top">Type</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://camel.apache.org/xml/in/">http://camel.apache.org/xml/in/</a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">in</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">the exchange.in message</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://camel.apache.org/xml/out/">http://camel.apache.org/xml/out/</a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">out</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Message</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">the exchange.out message</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://camel.apache.org/xml/function/">http://camel.apache.org/xml/function/</a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">functions</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Additional functions</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://camel.apache.org/xml/variables/environment-variables">http://camel.apache.org/xml/variables/environment-variables</a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">env</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">OS environment variables</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://camel.apache.org/xml/variables/system-properties">http://camel.apache.org/xml/variables/system-properties</a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">system</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Java System properties</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://camel.apache.org/xml/variables/exchange-property">http://camel.apache.org/xml/variables/exchange-property</a></p></td> <td class="tableblock halign-left valign-top"></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">the exchange property</p></td> </tr> </tbody> </table></div> <div class="paragraph"> <p>Camel will resolve variables according to either:</p> </div> <div class="ulist"> <ul> <li> <p>namespace given</p> </li> <li> <p>no namespace given</p> </li> </ul> </div> <div class="sect2"> <h3 id="_namespace_given"><a class="anchor" href="#_namespace_given"></a>Namespace given</h3> <div class="paragraph"> <p>If the namespace is given then Camel is instructed exactly what to return. However when resolving either <strong>in</strong> or <strong>out</strong> Camel will try to resolve a header with the given local part first, and return it. If the local part has the value <strong>body</strong> then the body is returned instead.</p> </div> </div> <div class="sect2"> <h3 id="_no_namespace_given"><a class="anchor" href="#_no_namespace_given"></a>No namespace given</h3> <div class="paragraph"> <p>If there is no namespace given then Camel resolves only based on the local part. Camel will try to resolve a variable in the following steps:</p> </div> <div class="ulist"> <ul> <li> <p>from <code>variables</code> that has been set using the <code>variable(name, value)</code> fluent builder</p> </li> <li> <p>from message.in.header if there is a header with the given key</p> </li> <li> <p>from exchange.properties if there is a property with the given key</p> </li> </ul> </div> </div> </div> </div> <div class="sect1"> <h2 id="_functions"><a class="anchor" href="#_functions"></a>Functions</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel adds the following XPath functions that can be used to access the exchange:</p> </div> <div class="table-wrapper"><table class="tableblock frame-all grid-all stretch"> <colgroup> <col> <col> <col> <col> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Function</th> <th class="tableblock halign-left valign-top">Argument</th> <th class="tableblock halign-left valign-top">Type</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">in:body</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Will return the <strong>in</strong> message body.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">in:header</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">the header name</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Will return the <strong>in</strong> message header.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">out:body</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Will return the <strong>out</strong> message body.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">out:header</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">the header name</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Will return the <strong>out</strong> message header.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">function:properties</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">key for property</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">To lookup a property using the <a href="properties-component.html" class="page">Properties</a> component (property placeholders).</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">function:simple</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">simple expression</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">To evaluate a <a href="../../manual/latest/simple-language.html" class="page">Simple</a> expression.</p></td> </tr> </tbody> </table></div> <div class="admonitionblock caution"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-caution" title="Caution"></i> </td> <td class="content"> <code>function:properties</code> and <code>function:simple</code> is not supported when the return type is a <code>NodeSet</code>, such as when using with a Splitter EIP. </td> </tr> </table></div> </div> <div class="paragraph"> <p>Here&#8217;s an example showing some of these functions in use.</p> </div> </div> </div> <div class="sect1"> <h2 id="_using_xml_configuration"><a class="anchor" href="#_using_xml_configuration"></a>Using XML configuration</h2> <div class="sectionbody"> <div class="paragraph"> <p>If you prefer to configure your routes in your Spring XML file then you can use XPath expressions as follows</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd"&gt;

  &lt;camelContext id="camel" xmlns="http://activemq.apache.org/camel/schema/spring" xmlns:foo="http://example.com/person"&gt;
    &lt;route&gt;
      &lt;from uri="activemq:MyQueue"/&gt;
      &lt;filter&gt;
        &lt;xpath&gt;/foo:person[@name='James']&lt;/xpath&gt;
        &lt;to uri="mqseries:SomeOtherQueue"/&gt;
      &lt;/filter&gt;
    &lt;/route&gt;
  &lt;/camelContext&gt;
&lt;/beans&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Notice how we can reuse the namespace prefixes, <strong>foo</strong> in this case, in the XPath expression for easier namespace based XPath expressions!</p> </div> <div class="paragraph"> <p>See also this <a href="http://camel.465427.n5.nabble.com/fail-filter-XPATH-camel-td476424.html">discussion on the mailinglist</a> about using your own namespaces with xpath</p> </div> </div> </div> <div class="sect1"> <h2 id="_setting_result_type"><a class="anchor" href="#_setting_result_type"></a>Setting result type</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <a href="#">XPath</a> expression will return a result type using native XML objects such as <code>org.w3c.dom.NodeList</code>. But many times you want a result type to be a String. To do this you have to instruct the <a href="#">XPath</a> which result type to use.</p> </div> <div class="paragraph"> <p>In Java DSL:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">xpath("/foo:person/@id", String.class)</code></pre> </div> </div> <div class="paragraph"> <p>In Spring DSL you use the <strong>resultType</strong> attribute to provide a fully qualified classname:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;xpath resultType="java.lang.String"&gt;/foo:person/@id&lt;/xpath&gt;</code></pre> </div> </div> <div class="paragraph"> <p>In @XPath:<br> <strong>Available as of Camel 2.1</strong></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@XPath(value = "concat('foo-',//order/name/)", resultType = String.class) String name)</code></pre> </div> </div> <div class="paragraph"> <p>Where we use the xpath function concat to prefix the order name with <code>foo-</code>. In this case we have to specify that we want a String as result type so the concat function works.</p> </div> </div> </div> <div class="sect1"> <h2 id="_using_xpath_on_headers"><a class="anchor" href="#_using_xpath_on_headers"></a>Using XPath on Headers</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.11</strong></p> </div> <div class="paragraph"> <p>Some users may have XML stored in a header. To apply an XPath to a header&#8217;s value you can do this by defining the 'headerName' attribute.</p> </div> <div class="paragraph"> <p>And in Java DSL you specify the headerName as the 2nd parameter as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  xpath("/invoice/@orderType = 'premium'", "invoiceDetails")</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h2> <div class="sectionbody"> <div class="paragraph"> <p>Here is a simple <a href="https://github.com/apache/camel/blob/master/camel-core/src/test/java/org/apache/camel/processor/XPathFilterTest.java">example</a> using an XPath expression as a predicate in a Message Filter</p> </div> <div class="paragraph"> <p>If you have a standard set of namespaces you wish to work with and wish to share them across many different XPath expressions you can use the NamespaceBuilder as shown <a href="https://github.com/apache/camel/blob/master/camel-core/src/test/java/org/apache/camel/processor/XPathWithNamespaceBuilderFilterTest.java">in this example</a></p> </div> <div class="paragraph"> <p>In this sample we have a choice construct. The first choice evaulates if the message has a header key <strong>type</strong> that has the value <strong>Camel</strong>.<br> The 2nd choice evaluates if the message body has a name tag <strong>&lt;name&gt;</strong> which values is <strong>Kong</strong>.<br> If neither is true the message is routed in the otherwise block:</p> </div> <div class="paragraph"> <p>And the spring XML equivalent of the route:</p> </div> </div> </div> <div class="sect1"> <h2 id="_xpath_injection"><a class="anchor" href="#_xpath_injection"></a>XPath injection</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can use Bean Integration to invoke a method on a bean and use various languages such as XPath to extract a value from the message and bind it to a method parameter.</p> </div> <div class="paragraph"> <p>The default XPath annotation has SOAP and XML namespaces available. If you want to use your own namespace URIs in an XPath expression you can use your own copy of the <a href="http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/language/XPath.html">XPath annotation</a> to create whatever namespace prefixes you want to use.</p> </div> <div class="paragraph"> <p>i.e. cut and paste upper code to your own project in a different package and/or annotation name then add whatever namespace prefix/uris you want in scope when you use your annotation on a method parameter. Then when you use your annotation on a method parameter all the namespaces you want will be available for use in your XPath expression.</p> </div> <div class="paragraph"> <p>For example</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Foo {

    @MessageDriven(uri = "activemq:my.queue")
    public void doSomething(@MyXPath("/ns1:foo/ns2:bar/text()") String correlationID, @Body String body) {
        // process the inbound message here
    }
}</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_using_xpathbuilder_without_an_exchange"><a class="anchor" href="#_using_xpathbuilder_without_an_exchange"></a>Using XPathBuilder without an Exchange</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.3</strong></p> </div> <div class="paragraph"> <p>You can now use the <code>org.apache.camel.builder.XPathBuilder</code> without the need for an Exchange. This comes handy if you want to use it as a helper to do custom xpath evaluations.</p> </div> <div class="paragraph"> <p>It requires that you pass in a CamelContext since a lot of the moving parts inside the XPathBuilder requires access to the Camel Type Converter and hence why CamelContext is needed.</p> </div> <div class="paragraph"> <p>For example you can do something like this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">boolean matches = XPathBuilder.xpath("/foo/bar/@xyz").matches(context, "&lt;foo&gt;&lt;bar xyz='cheese'/&gt;&lt;/foo&gt;"));</code></pre> </div> </div> <div class="paragraph"> <p>This will match the given predicate.</p> </div> <div class="paragraph"> <p>You can also evaluate for example as shown in the following three examples:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String name = XPathBuilder.xpath("foo/bar").evaluate(context, "&lt;foo&gt;&lt;bar&gt;cheese&lt;/bar&gt;&lt;/foo&gt;", String.class);
Integer number = XPathBuilder.xpath("foo/bar").evaluate(context, "&lt;foo&gt;&lt;bar&gt;123&lt;/bar&gt;&lt;/foo&gt;", Integer.class);
Boolean bool = XPathBuilder.xpath("foo/bar").evaluate(context, "&lt;foo&gt;&lt;bar&gt;true&lt;/bar&gt;&lt;/foo&gt;", Boolean.class);</code></pre> </div> </div> <div class="paragraph"> <p>Evaluating with a String result is a common requirement and thus you can do it a bit simpler:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String name = XPathBuilder.xpath("foo/bar").evaluate(context, "&lt;foo&gt;&lt;bar&gt;cheese&lt;/bar&gt;&lt;/foo&gt;");</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_using_saxon_with_xpathbuilder"><a class="anchor" href="#_using_saxon_with_xpathbuilder"></a>Using Saxon with XPathBuilder</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.3</strong></p> </div> <div class="paragraph"> <p>You need to add <strong>camel-saxon</strong> as dependency to your project.</p> </div> <div class="paragraph"> <p>Its now easier to use <a href="http://saxon.sourceforge.net/">Saxon</a> with the XPathBuilder which can be done in several ways as shown below.<br> Where as the latter ones are the easiest ones.</p> </div> <div class="ulist"> <ul> <li> <p>Using a factory</p> </li> <li> <p>Using ObjectModel</p> </li> </ul> </div> <div class="paragraph"> <p>The easy one</p> </div> </div> </div> <div class="sect1"> <h2 id="_setting_a_custom_xpathfactory_using_system_property"><a class="anchor" href="#_setting_a_custom_xpathfactory_using_system_property"></a>Setting a custom XPathFactory using System Property</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.3</strong></p> </div> <div class="paragraph"> <p>Camel now supports reading the <a href="http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/xpath/XPathFactory.html#newInstance(java.lang.String)">JVM system property <code>javax.xml.xpath.XPathFactory</code></a> that can be used to set a custom XPathFactory to use.</p> </div> <div class="paragraph"> <p>This unit test shows how this can be done to use Saxon instead:</p> </div> <div class="paragraph"> <p>Camel will log at <code>INFO</code> level if it uses a non default XPathFactory such as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code>XPathBuilder  INFO  Using system property javax.xml.xpath.XPathFactory:http://saxon.sf.net/jaxp/xpath/om with value:
                    net.sf.saxon.xpath.XPathFactoryImpl when creating XPathFactory</code></pre> </div> </div> <div class="paragraph"> <p>To use Apache Xerces you can configure the system property</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code>-Djavax.xml.xpath.XPathFactory=org.apache.xpath.jaxp.XPathFactoryImpl</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_enabling_saxon_from_spring_dsl"><a class="anchor" href="#_enabling_saxon_from_spring_dsl"></a>Enabling Saxon from Spring DSL</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.10</strong></p> </div> <div class="paragraph"> <p>Similarly to Java DSL, to enable Saxon from Spring DSL you have three options:</p> </div> <div class="paragraph"> <p>Specifying the factory</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;xpath factoryRef="saxonFactory" resultType="java.lang.String"&gt;current-dateTime()&lt;/xpath&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Specifying the object model</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;xpath objectModel="http://saxon.sf.net/jaxp/xpath/om" resultType="java.lang.String"&gt;current-dateTime()&lt;/xpath&gt;</code></pre> </div> </div> <div class="paragraph"> <p>Shortcut</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;xpath saxon="true" resultType="java.lang.String"&gt;current-dateTime()&lt;/xpath&gt;</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_namespace_auditing_to_aid_debugging"><a class="anchor" href="#_namespace_auditing_to_aid_debugging"></a>Namespace auditing to aid debugging</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.10</strong></p> </div> <div class="paragraph"> <p>A large number of XPath-related issues that users frequently face are linked to the usage of namespaces. You may have some misalignment between the namespaces present in your message and those that your XPath expression is aware of or referencing. XPath predicates or expressions that are unable to locate the XML elements and attributes due to namespaces issues may simply look like "they are not working", when in reality all there is to it is a lack of namespace definition.</p> </div> <div class="paragraph"> <p>Namespaces in XML are completely necessary, and while we would love to simplify their usage by implementing some magic or voodoo to wire namespaces automatically, truth is that any action down this path would disagree with the standards and would greatly hinder interoperability.</p> </div> <div class="paragraph"> <p>Therefore, the utmost we can do is assist you in debugging such issues by adding two new features to the XPath Expression Language and are thus accesible from both predicates and expressions.</p> </div> <div class="paragraph"> <p>#=== Logging the Namespace Context of your XPath expression/predicate</p> </div> <div class="paragraph"> <p>Every time a new XPath expression is created in the internal pool, Camel will log the namespace context of the expression under the <code>org.apache.camel.builder.xml.XPathBuilder</code> logger. Since Camel represents Namespace Contexts in a hierarchical fashion (parent-child relationships), the entire tree is output in a recursive manner with the following format:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code>[me: {prefix -&gt; namespace}, {prefix -&gt; namespace}], [parent: [me: {prefix -&gt; namespace}, {prefix -&gt; namespace}], [parent: [me: {prefix -&gt; namespace}]]]</code></pre> </div> </div> <div class="paragraph"> <p>Any of these options can be used to activate this logging:</p> </div> <div class="olist arabic"> <ol class="arabic"> <li> <p>Enable TRACE logging on the <code>org.apache.camel.builder.xml.XPathBuilder</code> logger, or some parent logger such as <code>org.apache.camel</code> or the root logger</p> </li> <li> <p>Enable the <code>logNamespaces</code> option as indicated in <a href="#">Auditing Namespaces</a>, in which case the logging will occur on the INFO level</p> </li> </ol> </div> </div> </div> <div class="sect1"> <h2 id="_auditing_namespaces"><a class="anchor" href="#_auditing_namespaces"></a>Auditing namespaces</h2> <div class="sectionbody"> <div class="paragraph"> <p>Camel is able to discover and dump all namespaces present on every incoming message before evaluating an XPath expression, providing all the richness of information you need to help you analyse and pinpoint possible namespace issues.</p> </div> <div class="paragraph"> <p>To achieve this, it in turn internally uses another specially tailored XPath expression to extract all namespace mappings that appear in the message, displaying the prefix and the full namespace URI(s) for each individual mapping.</p> </div> <div class="paragraph"> <p>Some points to take into account:</p> </div> <div class="ulist"> <ul> <li> <p>The implicit XML namespace (xmlns:xml="http://www.w3.org/XML/1998/namespace") is suppressed from the output because it adds no value</p> </li> <li> <p>Default namespaces are listed under the DEFAULT keyword in the output</p> </li> <li> <p>Keep in mind that namespaces can be remapped under different scopes. Think of a top-level 'a' prefix which in inner elements can be assigned a different namespace, or the default namespace changing in inner scopes. For each discovered prefix, all associated URIs are listed.</p> </li> </ul> </div> <div class="paragraph"> <p>You can enable this option in Java DSL and Spring DSL.</p> </div> <div class="paragraph"> <p>Java DSL:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">XPathBuilder.xpath("/foo:person/@id", String.class).logNamespaces()</code></pre> </div> </div> <div class="paragraph"> <p>Spring DSL:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;xpath logNamespaces="true" resultType="String"&gt;/foo:person/@id&lt;/xpath&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The result of the auditing will be appear at the INFO level under the <code>org.apache.camel.builder.xml.XPathBuilder</code> logger and will look like the following:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code>2012-01-16 13:23:45,878 [stSaxonWithFlag] INFO  XPathBuilder  - Namespaces discovered in message:
{xmlns:a=[http://apache.org/camel], DEFAULT=[http://apache.org/default],
xmlns:b=[http://apache.org/camelA, http://apache.org/camelB]}</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_loading_script_from_external_resource"><a class="anchor" href="#_loading_script_from_external_resource"></a>Loading script from external resource</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Available as of Camel 2.11</strong></p> </div> <div class="paragraph"> <p>You can externalize the script and have Camel load it from a resource such as <code>"classpath:"</code>, <code>"file:"</code>, or <code>"http:"</code>.<br> This is done using the following syntax: <code>"resource:scheme:location"</code>, eg to refer to a file on the classpath you can do:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">.setHeader("myHeader").xpath("resource:classpath:myxpath.txt", String.class)</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="_dependencies"><a class="anchor" href="#_dependencies"></a>Dependencies</h2> <div class="sectionbody"> <div class="paragraph"> <p>The XPath language is part of camel-core.</p> </div> </div> </div> </article> </main> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../../_/img/logo-d.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <dl> <dt>Overview</dt> <dd><a href="../../blog/">Blog</a></dd> <dd><a href="../../components/latest/">Components</a></dd> <dd><a href="../../download/">Download</a></dd> <dd><a href="../../docs/getting-started/">Getting started</a></dd> <dd><a href="../../manual/latest/faq.html">FAQ</a></dd> </dl> <dl> <dt>Community</dt> <dd><a href="../../community/support/">Support</a></dd> <dd><a href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a></dd> <dd><a href="../../community/user-stories/">User stories</a></dd> <dd><a href="../../community/articles/">Articles</a></dd> <dd><a href="../../community/books/">Books</a></dd> <dd><a href="../../community/team/">Team</a></dd> </dl> <dl> <dt>About</dt> <dd><a href="../../acknowledgments/">Acknowledgments</a> </dd><dd><a target="_blank" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p> &copy; 2004-2019 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> </div> </footer> <script src="../../_/js/site-f4f4dbc142.js"></script> <script async src="../../_/js/vendor/highlight-54157f17f1.js"></script> <script async src="../../_/js/vendor/svg4everybody-195d47ce7d.js"></script> <script type="application/ld+json"> {
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Apache Camel",
  "url": "https://camel.apache.org",
  "sameAs": [
     "https://twitter.com/ApacheCamel"
  ],
  "logo": "../../_/img/logo-d.svg",
  "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL."
} </script> <script type="application/ld+json"> { 
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Apache Camel",
        "item": "https://camel.apache.org"
        },
        {
        "@type": "ListItem",
        "position": 2,
        "name": "Component reference",
        "item": "https://camel.apache.org/components/latest/index.html"
        },
        {
        "@type": "ListItem",
        "position": 3,
        "name": "XPath Language","item": "https://camel.apache.org/components/latest/xpath-language.html"}
        ]
    } </script> </body> </html> 