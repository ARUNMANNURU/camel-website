<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Untitled :: Apache Camel</title><link rel="canonical" href="https://camel.apache.org/manual/latest/configuring-route-startup-ordering-and-autostartup.html"><meta name="generator" content="Antora 2.0.0"><link rel="stylesheet" href="../../_/css/site.css"></head><body class="article"><header class="header"><nav class="navbar"><div class="navbar-brand"><a class="navbar-item" href="https://camel.apache.org">Apache Camel</a><button class="navbar-burger" data-target="topbar-nav"><span></span><span></span><span></span></button></div><div id="topbar-nav" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="#">Home</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Products</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Product A</a><a class="navbar-item" href="#">Product B</a><a class="navbar-item" href="#">Product C</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Services</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Service A</a><a class="navbar-item" href="#">Service B</a><a class="navbar-item" href="#">Service C</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Resources</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Resource A</a><a class="navbar-item" href="#">Resource B</a><a class="navbar-item" href="#">Resource C</a></div></div><div class="navbar-item"><span class="control"><a class="button is-primary" href="#">Download</a></span></div></div></div></nav></header><div class="main-wrapper"><div class="navigation-container" data-component="manual" data-version="latest"><aside class="navigation"><div class="panels"><div class="navigation-menu is-active" data-panel="menu"><nav class="nav-menu"><h3 class="title"><a href="index.html">User manual</a></h3><ul class="nav-list"><li class="nav-item" data-depth="0"><ul class="nav-list"><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="getting-started.html">Getting started</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="architecture.html">Architecture</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="async.html">Async</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="asynchronous-routing-engine.html">Asynchronous Routing Engine</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="backlogdebugger.html">Backlog debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bam.html">Business Activity Monitoring</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="batch-consumer.html">Batch Consumer</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camel-core.html">Core</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camelcontext.html">Context</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="endpoint.html">Endpoints</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="cep.html">Complex Event Processing</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="component.html">Component</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="debugger.html">Debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="delay-interceptor.html">Delay interceptor</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dependency-injection.html">Dependency Injection</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dozer-type-conversion.html">Dozer Type Conversion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bean-integration.html">Bean Integration</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="error-handler.html">Error Handler</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange.html">Message Exchange</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="expression.html">Expressions</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="injector.html">Injector</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="intercept.html">Intercept</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="inversion-of-control-with-smart-defaults.html">Inversion Of Control With Smart Defaults</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="lifecycle.html">Camel Lifecycle</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="oncompletion.html">OnCompletion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="predicate.html">Predicates</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="registry.html">Registry</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="route-builder.html">RouteBuilder</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="routes.html">Routes</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><span class="nav-text">Domain Specific Languages</span><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="dsl.html">Camel Domain Specific Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="java-dsl.html">Java DSL</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="spring.html">Spring support</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="groovy-dsl.html">Groovy DSL</a></li><li class="nav-item" data-depth="2"><button class="nav-toggle"></button><span class="nav-text">Scala DSL</span><ul class="nav-list"><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl.html">About the Scala DSL</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-getting-started.html">Getting Started</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-eip.html">EIP</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-supported-languages.html">Supported languages</a></li></ul></li></ul></li><li class="nav-item" data-depth="1"><a class="nav-link" href="using-osgi-blueprint-with-camel.html">Using OSGi blueprint with Camel</a></li></ul></li></ul></nav></div><div class="navigation-explore" data-panel="explore"><div class="context"><span class="title">User manual</span><span class="version">latest</span></div><ul class="components"><li class="component"><span class="title">Apache Camel K</span><ul class="versions"><li class="version is-latest"><a href="../../camel-k/latest/index.html">latest</a></li></ul></li><li class="component"><span class="title">Component reference</span><ul class="versions"><li class="version is-latest"><a href="../../components/latest/index.html">latest</a></li></ul></li><li class="component is-current"><span class="title">User manual</span><ul class="versions"><li class="version is-current is-latest"><a href="index.html">latest</a></li></ul></li></ul></div></div></aside></div><main class="main"><div class="toolbar" role="navigation"><button class="navigation-toggle"></button><a href="index.html" class="home-link"></a><nav class="crumbs" aria-label="breadcrumbs"></nav></div><article class="doc"><div class="sect2"><h3 id="Configuringroutestartuporderingandautostartup-Configuringroutesstartuporderingandautostartup"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Configuringroutesstartuporderingandautostartup"></a>Configuring routes startup ordering and autostartup</h3><div class="paragraph"><p><strong>Available as of Camel 2.1</strong></p></div><div class="paragraph"><p>Camel now supports configuring two aspects:</p></div><div class="ulist"><ul><li><p>auto startup</p></li><li><p>order of starting routes</p></li></ul></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-ConfiguringwhetherCamelshouldbeautostartedornotinXMLDSL"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-ConfiguringwhetherCamelshouldbeautostartedornotinXMLDSL"></a>Configuring whether Camel should be auto started or not in XML DSL</h4><div class="paragraph"><p>The old option<code>shouldStartContext</code>have been removed and replaced with this new<code>autoStartup</code>option instead. What it allows is to configure Camel to<strong>not</strong>auto start when Spring starts.</p></div><div class="paragraph"><p>For example the route below we have configured<code>autoStartup=false</code>to prevent Camel starting when Spring starts.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;camelContext id="myCamel" xmlns="http://camel.apache.org/schema/spring" autoStartup="false"&gt;
        &lt;route&gt;
            &lt;from uri="direct:start"/&gt;
            &lt;to uri="mock:result"/&gt;
        &lt;/route&gt;
    &lt;/camelContext&gt;</code></pre></div></div><div class="paragraph"><p>So how do you start Camel then?</p></div><div class="paragraph"><p>The<code>autoStartup</code>option on the<code>&lt;camelContext&gt;</code>is only used once, so you can manually start Camel later by invoking its<code>start</code>method as shown below:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    ApplicationContext ac = ...
    SpringCamelContext camel = (SpringCamelContext) ac.getBean("myCamel");

    // now start Camel manually
    camel.start();</code></pre></div></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-ConfiguringwhetherarouteshouldbestartedornotinXMLDSL"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-ConfiguringwhetherarouteshouldbestartedornotinXMLDSL"></a>Configuring whether a route should be started or not in XML DSL</h4><div class="paragraph"><p>You can use the<code>autoStartup</code>option to configure if a given route should be started when Camel starts. By default a route is auto started.</p></div><div class="paragraph"><p>You can disable or enable it as follows.</p></div><div class="paragraph"><p>In XML DSL you define it as follows:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route autoStartup="false"&gt;
   &lt;from uri="activemq:queue:special"/&gt;
   &lt;to uri="file://backup"/&gt;
&lt;/route&gt;</code></pre></div></div><div class="paragraph"><p>And to explicit state it should be started:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route autoStartup="true"&gt;
   &lt;from uri="activemq:queue:special"/&gt;
   &lt;to uri="file://backup"/&gt;
&lt;/route&gt;</code></pre></div></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-ConfiguringwhetherarouteshouldbestartedornotinJavaDSL"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-ConfiguringwhetherarouteshouldbestartedornotinJavaDSL"></a>Configuring whether a route should be started or not in Java DSL</h4><div class="paragraph"><p>You can use the<code>autoStartup</code>option to configure if a given route should be started when Camel starts. By default a route is auto started.</p></div><div class="paragraph"><p>You can disable or enable it as follows:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("activemq:queue:special").noAutoStartup().to("file://backup");</code></pre></div></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-ConfiguringwhetherarouteshouldbestartedornotusingabooleanorStringinJavaDSL"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-ConfiguringwhetherarouteshouldbestartedornotusingabooleanorStringinJavaDSL"></a>Configuring whether a route should be started or not, using a boolean or String, in Java DSL</h4><div class="paragraph"><p><strong>Available as of Camel 2.9</strong></p></div><div class="paragraph"><p>To startup based on a boolean, String or<a href="#properties-component">Property</a>, do one of the following:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">boolean startupRoute = true;
from("activemq:queue:special").autoStartup(startupRoute).to("file://backup");
...
String startupRoute = "true";
from("activemq:queue:special").autoStartup(startupRoute).to("file://backup");
...
from("activemq:queue:special").autoStartup("{{startupRouteProperty}}").to("file://backup");</code></pre></div></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-Configuringstartingorderforroutes"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Configuringstartingorderforroutes"></a>Configuring starting order for routes</h4><div class="paragraph"><p>You can also configure the order in which routes are started. Previously Camel started the routes in a non deterministic order. Now you have fine grained control in which order the routes should be started. There is a new attribute<code>startupOrder</code>which is an<code>Integer</code>that states the order. Camel then sorts the routes before starting time. The routes with the lowest<code>startupOrder</code>are started first and the ones with the highest are started last.</p></div><div class="admonitionblock important"><table><tr><td class="icon"><i class="fa icon-important" title="Important"></i></td><td class="content">All<code>startupOrder</code>defined must be unique among all routes in your<a href="camelcontext.adoc">CamelContext</a>. Otherwise if there are clashes in<code>startupOrder</code>numbers among routes, the routes will fail to start up throwing<code>org.apache.camel.FailedToStartRouteException</code>.</td></tr></table></div><div class="paragraph"><p>Normally you should also use numbers that are lower than 1000, as routes without an explicit<code>startupOrder</code>definition will have a number starting from 1000 auto assigned. So view numbers from 1000 upwards as reserved internally for Camel itself.</p></div><div class="paragraph"><p>However, you can also utilise much higher numbers than 1000 (to avoid collisions with those auto assigned numbers) to specify the last routes to start up. Normally the usage of numbers starting from 10000 should be safe for the purpose.</p></div><div class="paragraph"><p>In terms of the<code>startupOrder</code>there are no strict rules that it must start from 1 and increment by 1. You can for example use: 100, 200, 205, 89 if you like. Only rule of thumb is that the numbers must be unique.</p></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-Whydoyouwanttocontrolthestartingorder"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Whydoyouwanttocontrolthestartingorder"></a>Why do you want to control the starting order?</h4><div class="paragraph"><p>It can help in cases where routes are inter dependent on each other and also help with graceful shutting down Camel as Camel can stop the routes in the correct order as well.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p><strong>Stopping routes</strong></p></div><div class="paragraph"><p><strong>Camel 2.2:</strong>Camel will stop the routes in the<strong>same</strong>order that they were started.</p></div><div class="paragraph"><p><strong>Camel 2.3:</strong>Camel will stop the routes in the<strong>reverse</strong>order that they were started.</p></div></td></tr></table></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-Examples"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Examples"></a>Examples</h4><div class="paragraph"><p>Let&#8217;s try a couple of examples.</p></div><div class="sect4"><h5 id="Configuringroutestartuporderingandautostartup-Simpleexample"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Simpleexample"></a>Simple example</h5><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    from("seda:foo").startupOrder(1).to("mock:result");
    from("direct:start").startupOrder(2).to("seda:foo");</code></pre></div></div><div class="paragraph"><p>And the same example with XML DSL:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;route startupOrder="1"&gt;
        &lt;from uri="seda:foo"/&gt;
        &lt;to uri="mock:result"/&gt;
    &lt;/route&gt;

    &lt;route startupOrder="2"&gt;
        &lt;from uri="direct:start"/&gt;
        &lt;to uri="seda:foo"/&gt;
    &lt;/route&gt;</code></pre></div></div><div class="paragraph"><p>In this example we have two routes in which we have started that the<code>direct:start</code>route should be started<strong>after</strong>the<code>seda:foo</code>route. As<code>direct:start</code>is consider the input and we want that<code>seda:foo</code>route to be up and running beforehand.</p></div><div class="paragraph"><p>You can also mix and match routes with and without<code>startupOrder</code>define.</p></div></div><div class="sect4"><h5 id="Configuringroutestartuporderingandautostartup-RouteswithstartupOrdermixedwithrouteswithout"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-RouteswithstartupOrdermixedwithrouteswithout"></a>Routes with startupOrder mixed with routes without</h5><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    from("seda:foo").startupOrder(1).to("mock:result");
    from("direct:start").startupOrder(2).to("seda:foo");

    from("direct:bar").to("seda:bar");</code></pre></div></div><div class="paragraph"><p>And the same example with XML DSL:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;route startupOrder="1"&gt;
        &lt;from uri="seda:foo"/&gt;
        &lt;to uri="mock:result"/&gt;
    &lt;/route&gt;

    &lt;route startupOrder="2"&gt;
        &lt;from uri="direct:start"/&gt;
        &lt;to uri="seda:foo"/&gt;
    &lt;/route&gt;

    &lt;route&gt;
        &lt;from uri="direct:bar"/&gt;
        &lt;to uri="seda:bar"/&gt;
    &lt;/route&gt;</code></pre></div></div><div class="paragraph"><p>In the route above we have<strong>not</strong>define a<code>startupOrder</code>on the last route<code>direct:bar</code>in which Camel will auto assign a number for it, in which this case will be 1000. So therefore the route will be started last.</p></div><div class="paragraph"><p>So you can use this to your advantage to only assign a<code>startupOrder</code>on the routes which really needs it.</p></div></div><div class="sect4"><h5 id="Configuringroutestartuporderingandautostartup-Routestostartuplast"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Routestostartuplast"></a>Routes to start up last</h5><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    // use auto assigned startup ordering
    from("direct:start").to("seda:foo");

    // should start first
    from("seda:foo").startupOrder(1).to("mock:result");

    // should start last after the default routes
    from("direct:bar").startupOrder(12345).to("seda:bar");

    // use auto assigned startup ordering
    from("seda:bar").to("mock:other");</code></pre></div></div><div class="paragraph"><p>In the example above the order of startups of routes should be:</p></div><div class="olist arabic"><ol class="arabic"><li><p><code>seda://foo</code></p></li><li><p><code>direct://start</code></p></li><li><p><code>seda://bar</code></p></li><li><p><code>direct://bar</code></p></li></ol></div></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-Shutdown"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Shutdown"></a>Shutdown</h4><div class="paragraph"><p><strong>Camel 2.2:</strong>Camel will shutdown the routes in the<strong>same</strong>order that they were started.</p></div><div class="paragraph"><p><strong>Camel 2.3:</strong>Camel will shutdown the routes in the<strong>reverse</strong>order that they were started.</p></div><div class="paragraph"><p>See also<a href="graceful-shutdown.adoc">Graceful Shutdown</a>.</p></div></div><div class="sect3"><h4 id="Configuringroutestartuporderingandautostartup-Seealso"><a class="anchor" href="#Configuringroutestartuporderingandautostartup-Seealso"></a>See also</h4><div class="ulist"><ul><li><p><a href="configuring-camel.adoc">Configuring Camel</a></p></li><li><p><a href="graceful-shutdown.adoc">Graceful Shutdown</a></p></li><li><p><a href="user-guide.html">User Guide</a></p></li></ul></div></div></div></article></main></div><footer class="footer"><p>This page was built using the Antora default UI.</p><p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p></footer><script src="../../_/js/site.js"></script><script src="../../_/js/vendor/highlight.js"></script><script>hljs.initHighlighting()</script></body></html>