<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Dead Letter Channel - Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/manual/latest/dead-letter-channel.html"> <meta name="generator" content="Antora 2.1.0"> <link rel="stylesheet" href="../../_/css/site-fa71c55e36.css"> <meta name="application-name" content="Apache Camel"> <link rel="manifest" href="../../site.webmanifest"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../favicon-128.png" sizes="128x128"> </head> <body class="article"> <header class="header"> <nav class="navbar"> <div class="navbar-brand"> <a class="nav-logo" href="../.."><span>Apache Camel</span></a> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item" href="../../blog/">Blog</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Projects</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../projects/camel-k/">Camel K</a> <a class="navbar-item" href="../../projects/camel-quarkus/">Camel Quarkus</a> <a class="navbar-item" href="../../projects/camel-kafka-connector/">Camel Kafka Connector</a> <a class="navbar-item" href="../../camel-spring-boot/latest/">Camel Spring Boot</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Documentation</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../manual/latest/getting-started.html">Getting started</a> <a class="navbar-item" href="../../manual/latest/">User manual</a> <a class="navbar-item" href="../../components/latest/">Component reference</a> <a class="navbar-item" href="https://www.javadoc.io/doc/org.apache.camel/camel-api/latest/index.html">API Documentation</a> <a class="navbar-item" href="../../camel-k/latest/">Camel K</a> <a class="navbar-item" href="../../camel-quarkus/latest/">Camel Quarkus</a> <a class="navbar-item" href="../../camel-kafka-connector/latest/">Camel Kafka Connector</a> <a class="navbar-item" href="../../manual/latest/enterprise-integration-patterns.html">Enterprise Integration Patterns</a> <a class="navbar-item" href="../../manual/latest/camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a> <a class="navbar-item" href="../../manual/latest/camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Community</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../community/support/">Support</a> <a class="navbar-item" href="../../manual/latest/contributing.html">Contributing</a> <a class="navbar-item" href="../../community/user-stories/">User stories</a> <a class="navbar-item" href="../../community/articles/">Articles</a> <a class="navbar-item" href="../../community/books/">Books</a> <a class="navbar-item" href="../../community/team/">Team</a> </div> </div> <a class="navbar-item" href="../../download/">Download</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">About</a> <div class="navbar-dropdown"> <a class="navbar-item" href="https://www.apache.org/events/current-event.html">Apache events</a> <a class="navbar-item" href="https://www.apache.org/licenses/">License</a> <a class="navbar-item" href="../../security/">Security</a> <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a> <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a> </div> </div> </div> </div> <div class="navbar-fill"></div> <div class="navbar-search results-hidden"> <input id="search" class="search" placeholder="Search" autocomplete="off"> <div id="search_results"></div> </div> <div id="social-media" class="navbar-tools"> <a href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#github"/></svg></a> <a href="https://gitter.im/apache/apache-camel" title="Chat on Gitter"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#gitter"/></svg></a> <a href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon"><use xlink:href="../../_/img/brand-logos.svg#twitter"/></svg></a> </div> <button class="navbar-burger" data-target="topbar-nav" type="button"> <span></span> <span></span> <span></span> </button> </div> </nav> </header> <div class="body"> <div class="nav-container" data-component="manual" data-version="latest"> <aside class="nav"> <div class="panels"> <div class="nav-panel-menu is-active" data-panel="menu"> <nav class="nav-menu"> <h3 class="title"><a href="index.html">User manual</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <a class="nav-link" href="getting-started.html">Getting started</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <a class="nav-link" href="architecture.html">Architecture</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="async.html">Async</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="asynchronous-routing-engine.html">Asynchronous Routing Engine</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlogdebugger.html">Backlog debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bam.html">Business Activity Monitoring</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-consumer.html">Batch Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-core.html">Core</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext.html">Context</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint.html">Endpoints</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="cep.html">Complex Event Processing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component.html">Component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="debugger.html">Debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-interceptor.html">Delay interceptor</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dependency-injection.html">Dependency Injection</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dozer-type-conversion.html">Dozer Type Conversion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-integration.html">Bean Integration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-binding.html">Bean Binding</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-producing.html">POJO Producing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error Handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange.html">Message Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="expression.html">Expressions</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="content-enricher.html">Content Enrichment</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="injector.html">Injector</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="intercept.html">Intercept</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="inversion-of-control-with-smart-defaults.html">Inversion Of Control With Smart Defaults</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="jmx.html">JMX</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="oncompletion.html">OnCompletion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="predicate.html">Predicates</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="registry.html">Registry</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-builder.html">RouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routes.html">Routes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transformer.html">Transformer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validator.html">Validator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring-remoting.html">Spring Remoting</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hiding-middleware.html">Hiding Middleware</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="health-check.html">Health Checks</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <span class="nav-text">Domain Specific Languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="java-dsl.html">Java DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring.html">Spring support</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="using-osgi-blueprint-with-camel.html">Using OSGi blueprint with Camel</a> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <span class="nav-text">Supported expression languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="properties-component.html">Properties Component</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <a class="nav-link" href="enterprise-integration-patterns.html">Enterprise Integration Patterns</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="aggregate-eip.html">Aggregate EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-config-eip.html">Batch-config EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-eip.html">Bean EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="choice-eip.html">Choice EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="circuitBreaker-eip.html">CircuitBreaker EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="claimCheck-eip.html">Claim Check EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="content-based-router-eip.html">Content Based Router</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="content-filter-eip.html">Content Filter</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="convertBodyTo-eip.html">Convert Body To EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="customLoadBalancer-eip.html">Custom Load Balancer EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-eip.html">Delay EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dynamic-router.html">Dynamic Router</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dynamicRouter-eip.html">Dynamic Router EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="enrich-eip.html">Enrich EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="eventDrivenConsumer-eip.html">Event Driven Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="failover-eip.html">Failover EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="filter-eip.html">Filter EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="from-eip.html">From EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hystrix-eip.html">Hystrix EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hystrixConfiguration-eip.html">Hystrix Configuration EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="idempotentConsumer-eip.html">Idempotent Consumer EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="inOnly-eip.html">In Only EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="inOut-eip.html">In Out EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="loadBalance-eip.html">Load Balance EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="log-eip.html">Log EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="loop-eip.html">Loop EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="marshal-eip.html">Marshal EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="multicast-eip.html">Multicast EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="onFallback-eip.html">On Fallback EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="otherwise-eip.html">Otherwise EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pipeline-eip.html">Pipeline EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pollEnrich-eip.html">Poll Enrich EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="process-eip.html">Process EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="random-eip.html">Random EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="recipientList-eip.html">Recipient List EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeHeader-eip.html">Remove Header EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeHeaders-eip.html">Remove Headers EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeProperties-eip.html">Remove Properties EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeProperty-eip.html">Remove Property EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="requestReply-eip.html">Request Reply</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="resequence-eip.html">Resequence EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="resilience4j-eip.html">Resilience4j EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="resilience4jConfiguration-eip.html">Resilience4j Configuration EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="rollback-eip.html">Rollback EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="roundRobin-eip.html">Round Robin EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routingSlip-eip.html">Routing Slip EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="saga-eip.html">Saga EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sample-eip.html">Sample EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="script-eip.html">Script EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="serviceCall-eip.html">Service Call EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setBody-eip.html">Set Body EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setHeader-eip.html">Set Header EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setOutHeader-eip.html">Set Out Header EIP (deprecated)</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setProperty-eip.html">Set Property EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sort-eip.html">Sort EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="split-eip.html">Split EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="step-eip.html">Step EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sticky-eip.html">Sticky EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stop-eip.html">Stop EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stream-config-eip.html">Stream-config EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="threads-eip.html">Threads EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="throttle-eip.html">Throttle EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="to-eip.html">To EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="toD-eip.html">To D EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="topic-eip.html">Topic EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transform-eip.html">Transform EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="unmarshal-eip.html">Unmarshal EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validate-eip.html">Validate EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="weighted-eip.html">Weighted EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="when-eip.html">When EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="wireTap-eip.html">Wire Tap EIP</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-item-toggle"></button> <span class="nav-text">Frequently asked questions</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/does-camel-work-on-ibms-jdk.html">Does Camel work on IBM&#8217;s JDK?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="support.html">How can I get help?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-mule.html">How does Camel compare to Mule?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-servicemix.html">How does Camel compare to ServiceMix?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-servicemix-eip.html">How does Camel compare to ServiceMix EIP?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-synapse.html">How does Camel compare to Synapse?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work-with-activemq.html">How does Camel work with ActiveMQ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work-with-servicemix.html">How does Camel work with ServiceMix?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-camel-api-compare-to.html">How does the Camel API compare to?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-run-camel-using-java-webstart.html">How do I run Camel using Java WebStart?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/if-i-use-servicemix-when-should-i-use-camel.html">If I use ServiceMix when should I use Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-camel-an-esb.html">Is Camel an ESB?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-camel-ioc-friendly.html">Is Camel IoC friendly?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-are-the-dependencies.html">What are the dependencies?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-jars-do-i-need.html">What jars do I need?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">What languages are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/classloader-issue-of-servicemix-camel-component.html">Classloader issue of servicemix-camel component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="configuring-camel.html">How do I add a component?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-run-activemq-and-camel-in-jboss.html">How do I run ActiveMQ and Camel in JBoss?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-time-period-in-a-human-friendly-syntax.html">How do I specify time period in a human friendly syntax?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-a-big-uber-jar.html">How do I use a big (uber) JAR?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-camel-inside-servicemix.html">How do I use Camel inside ServiceMix?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-spring-property-placeholder-with-camel-xml.html">How do I use Spring Property Placeholder with Camel XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-package-applications-using-camel-and-activemq.html">How should I package applications using Camel and ActiveMQ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-importing-bunch-of-cxf-packages-when-start-up-the-camel-cxf-endpoint-from-osgi-platform-.html">How to avoid importing bunch of cxf packages when start up the camel-cxf endpoint from OSGi platform?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-define-a-static-camel-converter-method-in-scala.html">How to define a static Camel converter method in Scala?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/should-i-deploy-camel-inside-the-activemq-broker-or-in-another-application.html">Should I deploy Camel inside the ActiveMQ broker or in another application?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-camel-core-testsjar.html">Using camel-core-tests.jar</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-java-14-logging.html">How do I use Java 1.4 logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-invoke-camel-routes-from-jbi.html">How do I invoke Camel routes from JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-javaxnamingnoinitialcontextexception.html">Exception - javax.naming.NoInitialContextException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-camel-throw-so-many-noclassdeffoundexception-on-startup.html">Why do Camel throw so many NoClassDefFoundException on startup?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="camel-3-migration-guide.html">Camel 2.x to 3.0 Migration Guide</a> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="camel-3x-upgrade-guide.html">Camel 3.x Upgrade Guide</a> </li> </ul> </li> </ul> </nav> </div> <div class="nav-panel-explore" data-panel="explore"> <div class="context"> <span class="title">User manual</span> <span class="version">latest</span> </div> <ul class="components"> <li class="component"> <span class="title">Apache Camel extensions for Quarkus</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-quarkus/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Apache Camel K</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-k/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Apache Camel Kafka Connector</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-kafka-connector/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Camel Spring Boot Starters</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-spring-boot/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Component reference</span> <ul class="versions"> <li class="version is-latest"> <a href="../../components/latest/index.html">latest</a> </li> <li class="version"> <a href="../../components/3.0.x/index.html">3.0.x</a> </li> <li class="version"> <a href="../../components/2.x/index.html">2.x</a> </li> </ul> </li> <li class="component is-current"> <span class="title">User manual</span> <ul class="versions"> <li class="version is-current is-latest"> <a href="index.html">latest</a> </li> </ul> </li> </ul> </div> </div> </aside> </div> <main role="main"> <div class="toolbar" role="navigation"> <button class="nav-toggle"></button> <a href="index.html" class="home-link"></a> <nav class="breadcrumbs" aria-label="breadcrumbs"> <ul> <li><a href="index.html">User manual</a></li> <li><a href="dead-letter-channel.html">Dead Letter Channel</a></li> </ul> </nav> <div> <label id="toggle-width-label" for="toggle-width">Wide / Narrow</label> </div> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/master/docs/user-manual/modules/ROOT/pages/dead-letter-channel.adoc">Edit this Page</a></div> </div> <input type="checkbox" id="toggle-width"> <article class="doc"> <h1 class="page">Dead Letter Channel</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Camel supports the <a href="http://www.enterpriseintegrationpatterns.com/DeadLetterChannel.html">Dead Letter Channel</a> from the <a href="enterprise-integration-patterns.html" class="page">EIP patterns</a> using the <a href="https://www.javadoc.io/doc/org.apache.camel/camel-base/current/org/apache/camel/processor/errorhandler/DeadLetterChannel.html">DeadLetterChannel</a> processor which is an <a href="error-handler.html" class="page">Error Handler</a>.</p> </div> <div class="imageblock"> <div class="content"> <img src="_images/eip/DeadLetterChannelSolution.gif" alt="image"> </div> </div> <div class="paragraph"> <p>The Dead Letter Channel lets you control behaviors including redelivery, whether to propagate the thrown Exception to the caller (the <strong>handled</strong> option), and where the (failed) Exchange should now be routed to.</p> </div> <div class="paragraph"> <p>The Dead Letter Channel is also by default configured to not be verbose in the logs, so when a message is handled and moved to the dead letter endpoint, then there is nothing logged. If you want some level of logging you can use the various options on the redelivery policy / dead letter channel to configure this. For example if you want the message history then set logExhaustedMessageHistory=true (and logHandled=true for Camel 2.15.x or older).</p> </div> <div class="paragraph"> <p>When the DeadLetterChannel moves a message to the dead letter endpoint, any new Exception thrown is by default handled by the dead letter channel as well. This ensures that the DeadLetterChannel will always succeed. From <strong>Camel 2.15</strong> onwards this behavior can be changed by setting the option deadLetterHandleNewException=false. Then if a new Exception is thrown, then the dead letter channel will fail and propagate back that new Exception (which is the behavior of the default error handler). When a new Exception occurs then the dead letter channel logs this at WARN level. This can be turned off by setting logNewException=false.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <strong>Difference between Dead Letter Channel and Default Error Handler</strong> The Default Error Handler does very little: it ends the Exchange immediately and propagates the thrown Exception back to the caller. </td> </tr> </table></div> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Redelivery"><a class="anchor" href="#deadLetterChannel-Redelivery"></a>Redelivery</h2> <div class="sectionbody"> <div class="paragraph"> <p>It is common for a temporary outage or database deadlock to cause a message to fail to process; but the chances are if its tried a few more times with some time delay then it will complete fine. So we typically wish to use some kind of redelivery policy to decide how many times to try redeliver a message and how long to wait before redelivery attempts.</p> </div> <div class="paragraph"> <p>The <a href="https://www.javadoc.io/doc/org.apache.camel/camel-base/current/org/apache/camel/processor/errorhandler/RedeliveryPolicy.html">RedeliveryPolicy</a> defines how the message is to be redelivered. You can customize things like</p> </div> <div class="ulist"> <ul> <li> <p>how many times a message is attempted to be redelivered before it is considered a failure and sent to the dead letter channel</p> </li> <li> <p>the initial redelivery timeout</p> </li> <li> <p>whether or not exponential backoff is used (i.e. the time between retries increases using a backoff multiplier)</p> </li> <li> <p>whether to use collision avoidance to add some randomness to the timings</p> </li> <li> <p>delay pattern (see below for details)</p> </li> <li> <p><strong>Camel 2.11:</strong> whether to allow redelivery during stopping/shutdown</p> </li> </ul> </div> <div class="paragraph"> <p>Once all attempts at redelivering the message fails then the message is forwarded to the dead letter queue.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-AboutmovingExchangetodeadletterqueueandusinghandled"><a class="anchor" href="#deadLetterChannel-AboutmovingExchangetodeadletterqueueandusinghandled"></a>About moving Exchange to dead letter queue and using handled</h2> <div class="sectionbody"> <div class="paragraph"> <p>When all attempts of redelivery have failed the <a href="exchange.html" class="page">Exchange</a> is moved to the dead letter queue (the dead letter endpoint). The exchange is then complete and from the client point of view it was processed. As such the <a href="#">Dead Letter Channel</a> have handled the <a href="exchange.html" class="page">Exchange</a>.</p> </div> <div class="paragraph"> <p>For instance configuring the dead letter channel as:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">errorHandler(deadLetterChannel("jms:queue:dead")
    .maximumRedeliveries(3).redeliveryDelay(5000));</code></pre> </div> </div> <div class="paragraph"> <p>And in XML:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route errorHandlerRef="myDeadLetterErrorHandler"&gt;
   ...
&lt;/route&gt;

&lt;bean id="myDeadLetterErrorHandler" class="org.apache.camel.builder.DeadLetterChannelBuilder"&gt;
    &lt;property name="deadLetterUri" value="jms:queue:dead"/&gt;
    &lt;property name="redeliveryPolicy" ref="myRedeliveryPolicyConfig"/&gt;
&lt;/bean&gt;

&lt;bean id="myRedeliveryPolicyConfig" class="org.apache.camel.processor.RedeliveryPolicy"&gt;
    &lt;property name="maximumRedeliveries" value="3"/&gt;
    &lt;property name="redeliveryDelay" value="5000"/&gt;
&lt;/bean&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The <a href="#">Dead Letter Channel</a> above will clear the caused exception (<code>setException(null)</code>), by moving the caused exception to a property on the <a href="exchange.html" class="page">Exchange</a>, with the key <code>Exchange.EXCEPTION_CAUGHT</code>. Then the <a href="exchange.html" class="page">Exchange</a> is moved to the <code>"jms:queue:dead"</code> destination and the client will not notice the failure.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-AboutmovingExchangetodeadletterqueueandusingtheoriginalmessage"><a class="anchor" href="#deadLetterChannel-AboutmovingExchangetodeadletterqueueandusingtheoriginalmessage"></a>Moving Exchange to dead letter queue and using the original message</h2> <div class="sectionbody"> <div class="paragraph"> <p>The option <strong>useOriginalMessage</strong> is used for routing the original input message instead of the current message that potentially is modified during routing.</p> </div> <div class="paragraph"> <p>For instance if you have this route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("jms:queue:order:input")
   .to("bean:validateOrder")
   .to("bean:transformOrder")
   .to("bean:handleOrder");</code></pre> </div> </div> <div class="paragraph"> <p>The route listen for JMS messages and validates, transforms and handle it. During this the <a href="exchange.html" class="page">Exchange</a> payload is transformed/modified. So in case something goes wrong and we want to move the message to another JMS destination, then we can configure our <a href="#">Dead Letter Channel</a> with the <strong>useOriginalMessage</strong> option. But when we move the <a href="exchange.html" class="page">Exchange</a> to this destination we do not know in which state the message is in. Did the error happen in before the transformOrder or after? So to be sure we want to move the original input message we received from <code>jms:queue:order:input</code>. So we can do this by enabling the <strong>useOriginalMessage</strong> option as shown below:</p> </div> <div class="admonitionblock note"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> <div class="paragraph"> <p>There is also a <strong>useOriginalBody</strong> option.</p> </div> </td> </tr> </table></div> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// will use original message (body and headers)
errorHandler(deadLetterChannel("jms:queue:dead")
   .useOriginalMessage().maximumRedeliveries(5).redeliveryDelay(5000);</code></pre> </div> </div> <div class="paragraph"> <p>Then the messages routed to the <code>jms:queue:dead</code> is the original input. If we want to manually retry we can move the JMS message from the failed to the input queue, with no problem as the message is the same as the original we received.</p> </div> <div class="sect2"> <h3 id="_boundary_of_original_message"><a class="anchor" href="#_boundary_of_original_message"></a>Boundary of original message</h3> <div class="paragraph"> <p>The original input means the input message that are bounded by the current unit of work. An unit of work typically spans one route, or multiple routes if they are connected using internal endpoints such as direct or seda. When messages is passed via external endpoints such as JMS or HTT then the consumer will create a new unit of work, with the message it received as input as the original input. Also some EIP patterns such as splitter, multicast, will create a new unit of work boundary for the messages in their sub-route (eg the splitted message); however these EIPs have an option named shareUnitOfWork which allows to combine with the parent unit of work in regard to error handling and therefore use the parent original message.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-OnRedelivery"><a class="anchor" href="#deadLetterChannel-OnRedelivery"></a>OnRedelivery</h2> <div class="sectionbody"> <div class="paragraph"> <p>When <a href="#">Dead Letter Channel</a> is doing redeliver its possible to configure a <a href="processor.html" class="page">Processor</a> that is executed just <strong>before</strong> every redelivery attempt. This can be used for the situations where you need to alter the message before its redelivered. See below for sample.</p> </div> <div class="admonitionblock tip"> <div class="table-wrapper"><table> <tr> <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> <td class="content"> <strong>onException and onRedeliver</strong> We also support for per <a href="exception-clause.html" class="page"><strong>onException</strong></a> to set a <strong>onRedeliver</strong>. That means you can do special on redelivery for different exceptions, as opposed to onRedelivery set on <a href="#">Dead Letter Channel</a> can be viewed as a global scope. </td> </tr> </table></div> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Redeliverydefaultvalues"><a class="anchor" href="#deadLetterChannel-Redeliverydefaultvalues"></a>Redelivery default values</h2> <div class="sectionbody"> <div class="paragraph"> <p>Redelivery is disabled by default.</p> </div> <div class="paragraph"> <p>The default redeliver policy will use the following values:</p> </div> <div class="ulist"> <ul> <li> <p>maximumRedeliveries=0</p> </li> <li> <p>redeliveryDelay=1000L (1 second)</p> </li> <li> <p>maximumRedeliveryDelay = 60 * 1000L (60 seconds)</p> </li> <li> <p>And the exponential backoff and collision avoidance is turned off.</p> </li> <li> <p>The retriesExhaustedLogLevel are set to LoggingLevel.ERROR</p> </li> <li> <p>The retryAttemptedLogLevel are set to LoggingLevel.DEBUG</p> </li> <li> <p>Stack traces is logged for exhausted messages</p> </li> <li> <p>Handled exceptions is not logged</p> </li> <li> <p>logExhaustedMessageHistory is true for default error handler, and false for dead letter channel.</p> </li> <li> <p>logExhaustedMessageBody is disabled by default to avoid logging sensitive message body/header details. If this option is true, then logExhaustedMessageHistory must also be true.</p> </li> </ul> </div> <div class="paragraph"> <p>The maximum redeliver delay ensures that a delay is never longer than the value, default 1 minute. This can happen if you turn on the exponential backoff.</p> </div> <div class="paragraph"> <p>The maximum redeliveries is the number of redelivery attempts. By default Camel will try to process the exchange 1 + 5 times. 1 time for the normal attempt and then 5 attempts as redeliveries. Setting the maximumRedeliveries to a negative value such as -1 will then always redelivery (unlimited). Setting the maximumRedeliveries to 0 will disable any redelivery attempt.</p> </div> <div class="paragraph"> <p>Camel will log delivery failures at the DEBUG logging level by default. You can change this by specifying retriesExhaustedLogLevel and/or retryAttemptedLogLevel.</p> </div> <div class="paragraph"> <p>You can turn logging of stack traces on/off. If turned off Camel will still log the redelivery attempt. Its just much less verbose.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-RedeliverDelayPattern"><a class="anchor" href="#deadLetterChannel-RedeliverDelayPattern"></a>Redeliver Delay Pattern</h2> <div class="sectionbody"> <div class="paragraph"> <p>Delay pattern is used as a single option to set a range pattern for delays. If used then the following options does not apply: (delay, backOffMultiplier, useExponentialBackOff, useCollisionAvoidance, maximumRedeliveryDelay).</p> </div> <div class="paragraph"> <p>The idea is to set groups of ranges using the following syntax: <code>limit:delay;limit 2:delay 2;limit 3:delay 3;&#8230;&#8203;;limit N:delay N</code></p> </div> <div class="paragraph"> <p>Each group has two values separated with colon</p> </div> <div class="ulist"> <ul> <li> <p>limit = upper limit</p> </li> <li> <p>delay = delay in millis And the groups is again separated with semi colon. The rule of thumb is that the next groups should have a higher limit than the previous group.</p> </li> </ul> </div> <div class="paragraph"> <p>Lets clarify this with an example:</p> </div> <div class="paragraph"> <p><code>delayPattern=5:1000;10:5000;20:20000</code></p> </div> <div class="paragraph"> <p>That gives us 3 groups:</p> </div> <div class="ulist"> <ul> <li> <p>5:1000</p> </li> <li> <p>10:5000</p> </li> <li> <p>20:20000</p> </li> </ul> </div> <div class="paragraph"> <p>Resulting in these delays for redelivery attempt:</p> </div> <div class="ulist"> <ul> <li> <p>Redelivery attempt number 1..4 = 0 millis (as the first group start with 5)</p> </li> <li> <p>Redelivery attempt number 5..9 = 1000 millis (the first group)</p> </li> <li> <p>Redelivery attempt number 10..19 = 5000 millis (the second group)</p> </li> <li> <p>Redelivery attempt number 20.. = 20000 millis (the last group)</p> </li> </ul> </div> <div class="paragraph"> <p>Note: The first redelivery attempt is 1, so the first group should start with 1 or higher.</p> </div> <div class="paragraph"> <p>You can start a group with limit 1 to eg have a starting delay: <code>delayPattern=1:1000;5:5000</code></p> </div> <div class="ulist"> <ul> <li> <p>Redelivery attempt number 1..4 = 1000 millis (the first group)</p> </li> <li> <p>Redelivery attempt number 5.. = 5000 millis (the last group)</p> </li> </ul> </div> <div class="paragraph"> <p>There is no requirement that the next delay should be higher than the previous. You can use any delay value you like. For example with <code>delayPattern=1:5000;3:1000</code> we start with 5 sec delay and then later reduce that to 1 second.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Redeliveryheader"><a class="anchor" href="#deadLetterChannel-Redeliveryheader"></a>Redelivery header</h2> <div class="sectionbody"> <div class="paragraph"> <p>When a message is redelivered the <a href="https://www.javadoc.io/doc/org.apache.camel/camel-base/current/org/apache/camel/processor/errorhandler/DeadLetterChannel.html">DeadLetterChannel</a> will append a customizable header to the message to indicate how many times its been redelivered. Before Camel 2.6: The header is <strong>CamelRedeliveryCounter</strong>, which is also defined on the <code>Exchange.REDELIVERY_COUNTER</code>. Starting with 2.6: The header <strong>CamelRedeliveryMaxCounter</strong>, which is also defined on the <code>Exchange.REDELIVERY_MAX_COUNTER</code>, contains the maximum redelivery setting. This header is absent if you use <code>retryWhile</code> or have unlimited maximum redelivery configured.</p> </div> <div class="paragraph"> <p>And a boolean flag whether it is being redelivered or not (first attempt) The header <strong>CamelRedelivered</strong> contains a boolean if the message is redelivered or not, which is also defined on the <code>Exchange.REDELIVERED</code>.</p> </div> <div class="paragraph"> <p>Dynamically calculated delay from the exchange In Camel 2.9 and 2.8.2: The header is <strong>CamelRedeliveryDelay</strong>, which is also defined on the <code>Exchange.REDELIVERY_DELAY</code>. Is this header is absent, normal redelivery rules apply.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Whichendpointfailed"><a class="anchor" href="#deadLetterChannel-Whichendpointfailed"></a>Which endpoint failed</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Since Camel 2.1</strong></p> </div> <div class="paragraph"> <p>When Camel routes messages it will decorate the <a href="exchange.html" class="page">Exchange</a> with a property that contains the <strong>last</strong> endpoint Camel send the <a href="exchange.html" class="page">Exchange</a> to:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String lastEndpointUri = exchange.getProperty(Exchange.TO_ENDPOINT, String.class);</code></pre> </div> </div> <div class="paragraph"> <p>The <code>Exchange.TO_ENDPOINT</code> have the constant value <code>CamelToEndpoint</code>.</p> </div> <div class="paragraph"> <p>This information is updated when Camel sends a message to any endpoint. So if it exists its the <strong>last</strong> endpoint which Camel send the Exchange to.</p> </div> <div class="paragraph"> <p>When for example processing the <a href="exchange.html" class="page">Exchange</a> at a given <a href="endpoint.html" class="page">Endpoint</a> and the message is to be moved into the dead letter queue, then Camel also decorates the Exchange with another property that contains that <strong>last</strong> endpoint:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String failedEndpointUri = exchange.getProperty(Exchange.FAILURE_ENDPOINT, String.class);</code></pre> </div> </div> <div class="paragraph"> <p>The <code>Exchange.FAILURE_ENDPOINT</code> have the constant value <code>CamelFailureEndpoint</code>.</p> </div> <div class="paragraph"> <p>This allows for example you to fetch this information in your dead letter queue and use that for error reporting.<br> This is useable if the Camel route is a bit dynamic such as the dynamic <a href="recipientList-eip.html" class="page">Recipient List</a> so you know which endpoints failed.</p> </div> <div class="paragraph"> <p>These information is kept on the Exchange even if the message was successfully processed by a given endpoint, and then later fails for example in a local <a href="../../components/latest/bean-component.html" class="page">Bean</a> processing instead. So beware that this is a hint that helps pinpoint errors.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("activemq:queue:foo")
    .to("http://someserver/somepath")
    .beanRef("foo");</code></pre> </div> </div> <div class="paragraph"> <p>Now suppose the route above and a failure happens in the <code>foo</code> bean. Then the <code>Exchange.TO_ENDPOINT</code> and <code>Exchange.FAILURE_ENDPOINT</code> will still contain the value of <code>http://someserver/somepath</code>.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-OnPrepareFailure"><a class="anchor" href="#deadLetterChannel-OnPrepareFailure"></a>OnPrepareFailure</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Since Camel 2.16</strong></p> </div> <div class="paragraph"> <p>Before the exchange is sent to the dead letter queue, you can use onPrepare to allow a custom <code>Processor</code> to prepare the exchange, such as adding information why the Exchange failed. For example the following processor adds a header with the exception message</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public static class MyPrepareProcessor implements Processor {
    @Override
    public void process(Exchange exchange) throws Exception {
        Exception cause = exchange.getProperty(Exchange.EXCEPTION_CAUGHT, Exception.class);
        exchange.getIn().setHeader("FailedBecause", cause.getMessage());
    }
}</code></pre> </div> </div> <div class="paragraph"> <p>Then configure the error handler to use the processor as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">errorHandler(deadLetterChannel("jms:dead").onPrepareFailure(new MyPrepareProcessor()));</code></pre> </div> </div> <div class="paragraph"> <p>Configuring this from XML DSL is as shown:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="myPrepare"
      class="org.apache.camel.processor.DeadLetterChannelOnPrepareTest.MyPrepareProcessor"/&gt;


&lt;errorHandler id="dlc" type="DeadLetterChannel" deadLetterUri="jms:dead" onPrepareFailureRef="myPrepare"/&gt;</code></pre> </div> </div> <div class="paragraph"> <p>The onPrepare is also available using the default error handler.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Whichroutefailed"><a class="anchor" href="#deadLetterChannel-Whichroutefailed"></a>Which route failed</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Since Camel 2.10.4/2.11</strong></p> </div> <div class="paragraph"> <p>When Camel error handler handles an error such as <a href="#">Dead Letter Channel</a> or using <a href="exception-clause.html" class="page">Exception Clause</a> with handled=true, then Camel will decorate<br> the <a href="exchange.html" class="page">Exchange</a> with the route id where the error occurred.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String failedRouteId = exchange.getProperty(Exchange.FAILURE_ROUTE_ID, String.class);</code></pre> </div> </div> <div class="paragraph"> <p>The <code>Exchange.FAILURE_ROUTE_ID</code> have the constant value <code>CamelFailureRouteId</code>.</p> </div> <div class="paragraph"> <p>This allows for example you to fetch this information in your dead letter queue and use that for error reporting.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Controlifredeliveryisallowedduringstoppingshutdown"><a class="anchor" href="#deadLetterChannel-Controlifredeliveryisallowedduringstoppingshutdown"></a>Control if redelivery is allowed during stopping/shutdown</h2> <div class="sectionbody"> <div class="paragraph"> <p><strong>Since Camel 2.11</strong></p> </div> <div class="paragraph"> <p>Prior to Camel 2.10, Camel will perform redelivery while stopping a route, or shutting down Camel. This has improved a bit in Camel 2.10 onwards, as Camel will not perform redelivery attempts when shutting down aggressively (eg during <a href="graceful-shutdown.html" class="page">Graceful Shutdown</a> and timeout hit). From Camel 2.11 onwards there is a new option <code>allowRedeliveryWhileStopping</code> which you can use to control if redelivery is allowed or not; notice that any in progress redelivery will still be executed. This option can only disallow any redelivery to be executed <strong>after</strong> the stopping of a route/shutdown of Camel has been triggered. If a redelivery is dissallowed then a <code>RejectedExecutionException</code> is set on the <a href="exchange.html" class="page">Exchange</a> and the processing of the <a href="exchange.html" class="page">Exchange</a> stops. This means any consumer will see the <a href="exchange.html" class="page">Exchange</a> as failed due the <code>RejectedExecutionException</code>.</p> </div> <div class="paragraph"> <p>The default value is <code>true</code> to be backwards compatible as before. For example the following sample shows how to do this with Java DSL and XML DSL</p> </div> <div class="paragraph"> <p>And the sample sample with XML DSL</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-Samples"><a class="anchor" href="#deadLetterChannel-Samples"></a>Samples</h2> <div class="sectionbody"> <div class="paragraph"> <p>The following example shows how to configure the Dead Letter Channel configuration using the <a href="dsl.html" class="page">DSL</a></p> </div> <div class="paragraph"> <p>You can also configure the <a href="https://www.javadoc.io/doc/org.apache.camel/camel-base/current/org/apache/camel/processor/errorhandler/RedeliveryPolicy.html">RedeliveryPolicy</a> as this example shows</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-HowcanImodifytheExchangebeforeredelivery"><a class="anchor" href="#deadLetterChannel-HowcanImodifytheExchangebeforeredelivery"></a>How can I modify the Exchange before redelivery?</h2> <div class="sectionbody"> <div class="paragraph"> <p>We support directly in <a href="#">Dead Letter Channel</a> to set a <a href="processor.html" class="page">Processor</a> that is executed <strong>before</strong> each redelivery attempt.</p> </div> <div class="paragraph"> <p>When <a href="#">Dead Letter Channel</a> is doing redeliver its possible to configure a <a href="processor.html" class="page">Processor</a> that is executed just <strong>before</strong> every redelivery attempt. This can be used for the situations where you need to alter the message before its redelivered.</p> </div> <div class="paragraph"> <p>Here we configure the <a href="#">Dead Letter Channel</a> to use our processor <code>MyRedeliveryProcessor</code> to be executed before each redelivery.</p> </div> <div class="paragraph"> <p>And this is the processor <code>MyRedeliveryProcessor</code> where we alter the message.</p> </div> </div> </div> <div class="sect1"> <h2 id="deadLetterChannel-HowcanIlogwhatcausedtheDeadLetterChanneltobeinvoked"><a class="anchor" href="#deadLetterChannel-HowcanIlogwhatcausedtheDeadLetterChanneltobeinvoked"></a>How can I log what caused the Dead Letter Channel to be invoked?</h2> <div class="sectionbody"> <div class="paragraph"> <p>You often need to know what went wrong that caused the Dead Letter Channel to be used and it does not offer logging for this purpose. So the Dead Letter Channel&#8217;s endpoint can be set to a endpoint of our own (such as <code>direct:deadLetterChannel</code>). We write a route to accept this Exchange and log the Exception, then forward on to where we want the failed Exchange moved to (which might be a DLQ queue for instance). See also <a href="http://stackoverflow.com/questions/13711462/logging-camel-exceptions-and-sending-to-the-dead-letter-channel">http://stackoverflow.com/questions/13711462/logging-camel-exceptions-and-sending-to-the-dead-letter-channel</a></p> </div> <div class="sect2"> <h3 id="deadLetterChannel-UsingThisPattern"><a class="anchor" href="#deadLetterChannel-UsingThisPattern"></a>Using This Pattern</h3> <div class="paragraph"> <p>If you would like to use this EIP Pattern then please read the <a href="getting-started.html" class="page">Getting Started</a>, you may also find the <a href="architecture.html" class="page">Architecture</a> useful particularly the description of <a href="endpoint.html" class="page">Endpoint</a> and <a href="uris.html" class="page">URIs</a>. Then you could try out some of the <a href="examples.html" class="page">Examples</a> first before trying this pattern out.</p> </div> <div class="ulist"> <ul> <li> <p><a href="error-handler.html" class="page">Error Handler</a></p> </li> <li> <p><a href="exception-clause.html" class="page">Exception Clause</a></p> </li> </ul> </div> </div> </div> </div> </article> </main> </div> <footer> <div class="footer"> <figure class="logo"> <img src="../../_/img/logo-d.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </figure> <dl> <dt>Overview</dt> <dd><a href="../../blog/">Blog</a></dd> <dd><a href="../../components/latest/">Components</a></dd> <dd><a href="../../download/">Download</a></dd> <dd><a href="../../manual/latest/getting-started.html">Getting started</a></dd> <dd><a href="../../manual/latest/faq.html">FAQ</a></dd> </dl> <dl> <dt>Community</dt> <dd><a href="../../community/support/">Support</a></dd> <dd><a href="../../manual/latest/contributing.html">Contributing</a></dd> <dd><a href="../../community/user-stories/">User stories</a></dd> <dd><a href="../../community/articles/">Articles</a></dd> <dd><a href="../../community/books/">Books</a></dd> <dd><a href="../../community/team/">Team</a></dd> </dl> <dl> <dt>About</dt> <dd><a href="../../acknowledgments/">Acknowledgments</a> </dd><dd><a target="_blank" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd> <dd><a target="_blank" href="https://www.apache.org/licenses/" title="License">License</a></dd> <dd><a target="_blank" href="https://www.apache.org/security/" title="Security">Security</a></dd> <dd><a target="_blank" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd> <dd><a target="_blank" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd> </dl> <p> &copy; 2004-2020 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </p> </div> </footer> <script src="../../_/js/vendor/alogliasearch-bc4f637dc4.js"></script> <script src="../../_/js/site-f4f4dbc142.js"></script> <script async src="../../_/js/vendor/highlight-54157f17f1.js"></script> <script async src="../../_/js/vendor/svg4everybody-195d47ce7d.js"></script> <script type="application/ld+json"> {
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Apache Camel",
  "url": "https://camel.apache.org",
  "sameAs": [
     "https://twitter.com/ApacheCamel"
  ],
  "logo": "../../_/img/logo-d.svg",
  "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL."
} </script> <script type="application/ld+json"> { 
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Apache Camel",
        "item": "https://camel.apache.org"
        },
        {
        "@type": "ListItem",
        "position": 2,
        "name": "User manual",
        "item": "https://camel.apache.org/manual/latest/index.html"
        },
        {
        "@type": "ListItem",
        "position": 3,
        "name": "Dead Letter Channel","item": "https://camel.apache.org/manual/latest/dead-letter-channel.html"}
        ]
    } </script> </body> </html> 