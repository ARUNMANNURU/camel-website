<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Untitled :: Apache Camel</title><link rel="canonical" href="https://camel.apache.org/manual/latest/dozer-type-conversion.html"><meta name="generator" content="Antora 2.0.0-rc.2"><link rel="stylesheet" href="../../_/css/site.css"></head><body class="article"><header class="header"><nav class="navbar"><div class="navbar-brand"><a class="navbar-item" href="https://camel.apache.org">Apache Camel</a><button class="navbar-burger" data-target="topbar-nav"><span></span><span></span><span></span></button></div><div id="topbar-nav" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="#">Home</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Products</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Product A</a><a class="navbar-item" href="#">Product B</a><a class="navbar-item" href="#">Product C</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Services</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Service A</a><a class="navbar-item" href="#">Service B</a><a class="navbar-item" href="#">Service C</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Resources</a><div class="navbar-dropdown"><a class="navbar-item" href="#">Resource A</a><a class="navbar-item" href="#">Resource B</a><a class="navbar-item" href="#">Resource C</a></div></div><div class="navbar-item"><span class="control"><a class="button is-primary" href="#">Download</a></span></div></div></div></nav></header><div class="main-wrapper"><div class="navigation-container" data-component="manual" data-version="latest"><aside class="navigation"><div class="panels"><div class="navigation-menu is-active" data-panel="menu"><nav class="nav-menu"><h3 class="title"><a href="index.html">User manual</a></h3><ul class="nav-list"><li class="nav-item" data-depth="0"><ul class="nav-list"><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="getting-started.html">Getting started</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="architecture.html">Architecture</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="async.html">Async</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="asynchronous-routing-engine.html">Asynchronous Routing Engine</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="backlogdebugger.html">Backlog debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bam.html">Business Activity Monitoring</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="batch-consumer.html">Batch Consumer</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camel-core.html">Core</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camelcontext.html">Context</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="endpoint.html">Endpoints</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="cep.html">Complex Event Processing</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="component.html">Component</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="debugger.html">Debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="delay-interceptor.html">Delay interceptor</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dependency-injection.html">Dependency Injection</a></li><li class="nav-item is-current-page" data-depth="2"><a class="nav-link" href="dozer-type-conversion.html">Dozer Type Conversion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bean-integration.html">Bean Integration</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="error-handler.html">Error Handler</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange.html">Message Exchange</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="expression.html">Expressions</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="injector.html">Injector</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="intercept.html">Intercept</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="inversion-of-control-with-smart-defaults.html">Inversion Of Control With Smart Defaults</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="lifecycle.html">Camel Lifecycle</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="oncompletion.html">OnCompletion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="predicate.html">Predicates</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="registry.html">Registry</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="route-builder.html">RouteBuilder</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="routes.html">Routes</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><span class="nav-text">Domain Specific Languages</span><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="dsl.html">Camel Domain Specific Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="java-dsl.html">Java DSL</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="spring.html">Spring support</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="groovy-dsl.html">Groovy DSL</a></li><li class="nav-item" data-depth="2"><button class="nav-toggle"></button><span class="nav-text">Scala DSL</span><ul class="nav-list"><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl.html">About the Scala DSL</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-getting-started.html">Getting Started</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-eip.html">EIP</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-supported-languages.html">Supported languages</a></li></ul></li></ul></li><li class="nav-item" data-depth="1"><a class="nav-link" href="using-osgi-blueprint-with-camel.html">Using OSGi blueprint with Camel</a></li></ul></li></ul></nav></div><div class="navigation-explore" data-panel="explore"><div class="context"><span class="title">User manual</span><span class="version">latest</span></div><ul class="components"><li class="component"><span class="title">Apache Camel K</span><ul class="versions"><li class="version is-latest"><a href="../../camel-k/latest/index.html">latest</a></li></ul></li><li class="component"><span class="title">Component reference</span><ul class="versions"><li class="version is-latest"><a href="../../components/latest/index.html">latest</a></li></ul></li><li class="component is-current"><span class="title">User manual</span><ul class="versions"><li class="version is-current is-latest"><a href="index.html">latest</a></li></ul></li></ul></div></div></aside></div><main class="main"><div class="toolbar" role="navigation"><button class="navigation-toggle"></button><a href="index.html" class="home-link"></a><nav class="crumbs" aria-label="breadcrumbs"><ul><li class="crumb"><a href="index.html">User manual</a></li><li class="crumb"><a href="architecture.html">Architecture</a></li><li class="crumb"><a href="dozer-type-conversion.html">Dozer Type Conversion</a></li></ul></nav></div><article class="doc"><div class="sect1"><h2 id="DozerTypeConversion-DozerTypeConversion"><a class="anchor" href="#DozerTypeConversion-DozerTypeConversion"></a>Dozer Type Conversion</h2><div class="sectionbody"><div class="paragraph"><p><a href="https://github.com/DozerMapper/dozer/blob/master/docs/asciidoc/about/about.adoc">Dozer</a>is a fast and flexible framework for mapping back and forth between Java Beans. Coupled with Camel&#8217;s automatic type conversion, it&#8217;s a formidable tool for dealing object to object mapping headaches that crop up in enterprise integration projects.</p></div><div class="paragraph"><p>To explain how Dozer can be used within Camel we&#8217;ll use the following example of a simple Customer Support Service. The initial version of the Service defined a 'Customer' object used with a very flat structure.</p></div><div class="paragraph"><p><strong>Legacy Customer Service Class</strong></p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Customer {
    private String firstName;
    private String lastName;
    private String street;
    private String zip;

    public Customer() {}

    public Customer(String firstName, String lastName, String zip, String street) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.zip = zip;
        this.street = street;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    ... getters and setters for each field</code></pre></div></div><div class="paragraph"><p>In the next version it was decided to structure the data better in the model by moving the address data into its own type, with the resulting domain object ending up looking like the below.</p></div><div class="paragraph"><p><strong>Next Gen Customer object</strong></p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Customer {
    private String firstName;
    private String lastName;
    private Address address;

    public Customer() {}

    public Customer(String firstName, String lastName, Address address) {
        this.firstName = firstName;
        this.lastName = lastName;
        this.address = address;
    }
    ....


public class Address {
    private String zipCode;
    private String streetName;

    public Address() {}

    public Address(String zipCode, String streetName) {
        this.zipCode = zipCode;
        this.streetName = streetName;
    }</code></pre></div></div><div class="paragraph"><p>Much nicer! But as often occurs, the previous version of the service, with the old flat 'Customer' object, was in production with a client and the project must support the legacy interface. To support both versions, we must add a mechanism to convert between the old Customer service type and the new Customer domain type and back again. It would be a simple matter to write a custom converter class to map between them, but this may not be the only service/domain inconsistency and these tedious and error prone custom mappings could quickly start to add up, and bugs with them.</p></div><div class="paragraph"><p>To a large extent the two objects share an identical structure, with only the address representation being different. It would be very helpful if there were a practical way to to automate this kind of mapping, such that the similar properties could get mapped automatically and only the inconsistencies requiring custom mapping.</p></div><div class="paragraph"><p>This is where Dozer comes in; it uses reflection to map data between two bean types using a set of simple mapping rules. Where no rule is specified, Dozer will attempt to map between them by using matching properties of two beans. In this way, focus can be given to the inconsistencies between the beans i.e. the address properties, knowing that Dozer will automatically match and convert the others.</p></div><div class="sect2"><h3 id="DozerTypeConversion-ConfiguringDozer"><a class="anchor" href="#DozerTypeConversion-ConfiguringDozer"></a>Configuring Dozer</h3><div class="paragraph"><p>Dozer&#8217;s configuration is extremely flexible and many mapping scenarios are covered<a href="https://github.com/DozerMapper/dozer/blob/master/docs/asciidoc/documentation/mappings.adoc">here</a>. For our simple example, the configuration looks like the following.</p></div><div class="paragraph"><p><strong>mapping.xml</strong></p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;mappings xmlns="http://dozermapper.github.io/schema/bean-mapping"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://dozermapper.github.io/schema/bean-mapping http://dozermapper.github.io/schema/bean-mapping.xsd"&gt;
  &lt;mapping&gt;
    &lt;class-a&gt;org.apache.camel.converter.dozer.service.Customer&lt;/class-a&gt;
    &lt;class-b&gt;org.apache.camel.converter.dozer.model.Customer&lt;/class-b&gt;
    &lt;field&gt;
      &lt;a&gt;street&lt;/a&gt;
      &lt;b&gt;address.streetName&lt;/b&gt;
    &lt;/field&gt;
    &lt;field&gt;
      &lt;a&gt;zip&lt;/a&gt;
      &lt;b&gt;address.zipCode&lt;/b&gt;
    &lt;/field&gt;
  &lt;/mapping&gt;
&lt;/mappings&gt;</code></pre></div></div></div><div class="sect2"><h3 id="DozerTypeConversion-SupportforDozerinCamel"><a class="anchor" href="#DozerTypeConversion-SupportforDozerinCamel"></a>Support for Dozer in Camel</h3><div class="paragraph"><p>Camel provides a simple mechanism to integrate Dozer Mappers with it&#8217;s own powerful<a href="http://camel.apache.org/type-converter.html">Type Conversion</a>framework. Its configured by creating an instance of<code>DozerTypeConverterLoader</code>providing it the camel context and an optional Dozer mapper. If no mapper is supplied, Camel&#8217;s registry will be searched for suitable instances. The loader will query the Dozer Mapper for the types it converts and register them with Camel&#8217;s type conversion framework to be handled by the mapper.</p></div><div class="admonitionblock note"><table><tr><td class="icon"><i class="fa icon-note" title="Note"></i></td><td class="content"><div class="paragraph"><p><strong>Limitation</strong></p></div><div class="paragraph"><p>The Camel Dozer type converter does not support having the same type conversion paris in different mapping ids (eg map-id) in Dozer.</p></div></td></tr></table></div><div class="paragraph"><p>In Java it can be configured as follows:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Mapper mapper = DozerBeanMapperBuilder.create()
                .withMappingFiles("mapping.xml")
                .build();

new DozerTypeConverterLoader(camelContext, mapper);</code></pre></div></div><div class="paragraph"><p>Or in Spring:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="dozerConverterLoader" class="org.apache.camel.converter.dozer.DozerTypeConverterLoader"&gt;
  &lt;argument index="0" ref="myCamel"/&gt;
  &lt;argument index="1" ref="mapperConfiguration"/&gt;
&lt;/bean&gt;

&lt;bean id="mapperConfiguration" class="org.apache.camel.converter.dozer.DozerBeanMapperConfiguration"&gt;
  &lt;property name="mappingFiles"&gt;
    &lt;list&gt;
      &lt;value&gt;mapping.xml&lt;/value&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;

&lt;camelContext id="myCamel" xmlns="http://camel.apache.org/schema/spring"&gt;
  ...
&lt;/camelContext&gt;</code></pre></div></div><div class="paragraph"><p>Or in OSGi Blueprints:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="dozerConverterLoader" class="org.apache.camel.converter.dozer.DozerTypeConverterLoader"&gt;
  &lt;argument index="0" ref="myCamel"/&gt;
  &lt;argument index="1" ref="mapperConfiguration"/&gt;
&lt;/bean&gt;

&lt;bean id="mapperConfiguration" class="org.apache.camel.converter.dozer.DozerBeanMapperConfiguration"&gt;
  &lt;property name="mappingFiles"&gt;
    &lt;list&gt;
      &lt;value&gt;mapping.xml&lt;/value&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;

&lt;camelContext id="myCamel" xmlns="http://camel.apache.org/schema/blueprint"&gt;
  ...
&lt;/camelContext&gt;</code></pre></div></div><div class="paragraph"><p>You should of noticed that the configuration for Spring or OSGi Blueprints is the same, except for the 'xmlns' for the 'camelContext'.</p></div><div class="paragraph"><p>Now, where necessary, Camel will use Dozer to do conversions; in our case between the new domain and legacy Customer types e.g.</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// given the following route
from("direct:legacy-service-in").bean(new CustomerProcessor());

// and a processor

public class CustomerProcessor {

    public Customer processCustomer(org.apache.camel.converter.dozer.model.Customer customer) {
       ...
    }
}

// service objects can be sent to the processor and automagically converted by Camel &amp; Dozer
template.sendBody("direct:legacy-service-in", new org.apache.camel.converter.dozer.service.Customer("Bob", "Roberts", "12345", "1 Main st."));</code></pre></div></div></div></div></div></article></main></div><footer class="footer"><p>This page was built using the Antora default UI.</p><p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p></footer><script src="../../_/js/site.js"></script><script src="../../_/js/vendor/highlight.js"></script><script>hljs.initHighlighting()</script></body></html>