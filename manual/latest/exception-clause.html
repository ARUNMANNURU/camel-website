<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <title>Untitled :: Apache Camel</title> <link rel="canonical" href="https://camel.apache.org/staging/manual/latest/exception-clause.html"> <meta name="generator" content="Antora 2.0.0"> <link rel="stylesheet" href="../../_/css/site.css"> <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../apple-touch-icon-57x57.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../apple-touch-icon-114x114.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../apple-touch-icon-72x72.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../apple-touch-icon-144x144.png"> <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../apple-touch-icon-60x60.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../apple-touch-icon-120x120.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../apple-touch-icon-76x76.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../apple-touch-icon-152x152.png"> <link rel="icon" type="image/png" href="../../favicon-196x196.png" sizes="196x196"> <link rel="icon" type="image/png" href="../../favicon-96x96.png" sizes="96x96"> <link rel="icon" type="image/png" href="../../favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="../../favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="../../favicon-128.png" sizes="128x128"> <meta name="application-name" content="Apache Camel"> <link rel="manifest" href="../../site.webmanifest"> </head> <body class="article"> <header class="header"> <nav class="navbar shadow border-bottom"> <div class="navbar-brand"> <a class="navbar-item nav-logo" href="../.." title="Apache Camel"><span>Apache Camel</span></a> <button class="navbar-burger" data-target="topbar-nav" type="button"> <span></span> <span></span> <span></span> </button> </div> <div id="topbar-nav" class="navbar-menu"> <div class="navbar-end"> <a class="navbar-item" href="../../">Home</a> <a class="navbar-item" href="../../news/">News</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Projects</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../projects/camel-k/">Camel K</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Documentation</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../docs/getting-started/">Getting started</a> <a class="navbar-item" href="../../manual/latest/">User manual</a> <a class="navbar-item" href="../../components/latest/">Component reference</a> <a class="navbar-item" href="../../camel-k/latest/">Camel K</a> </div> </div> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">Community</a> <div class="navbar-dropdown"> <a class="navbar-item" href="../../community/support/">Support</a> <a class="navbar-item" href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a> <a class="navbar-item" href="../../community/user-stories/">User stories</a> <a class="navbar-item" href="../../community/articles/">Articles</a> <a class="navbar-item" href="../../community/books/">Books</a> <a class="navbar-item" href="../../community/team/">Team</a> <a class="navbar-item" href="../../community/camel-extra/">Camel extra</a> </div> </div> <a class="navbar-item" href="../../download/">Download</a> <div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link" href="#">About</a> <div class="navbar-dropdown"> <a class="navbar-item" href="https://www.apache.org/events/current-event.html">Apache events</a> <a class="navbar-item" href="https://www.apache.org/licenses/">License</a> <a class="navbar-item" href="../../security/">Security</a> <a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a> <a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a> </div> </div> </div> </div> </nav> </header> <div class="main-wrapper"> <div class="navigation-container" data-component="manual" data-version="latest"> <aside class="navigation"> <div class="panels"> <div class="navigation-menu is-active" data-panel="menu"> <nav class="nav-menu"> <h3 class="title"><a href="index.html">User manual</a></h3> <ul class="nav-list"> <li class="nav-item" data-depth="0"> <ul class="nav-list"> <li class="nav-item" data-depth="1"> <button class="nav-toggle" type="button"></button> <a class="nav-link" href="getting-started.html">Getting started</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="what-are-the-dependencies.html">What are the dependencies?</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-toggle" type="button"></button> <a class="nav-link" href="architecture.html">Architecture</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="async.html">Async</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="asynchronous-routing-engine.html">Asynchronous Routing Engine</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="backlogdebugger.html">Backlog debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bam.html">Business Activity Monitoring</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-consumer.html">Batch Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camel-core.html">Core</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="camelcontext.html">Context</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="endpoint.html">Endpoints</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="cep.html">Complex Event Processing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="component.html">Component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="debugger.html">Debugger</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-interceptor.html">Delay interceptor</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dependency-injection.html">Dependency Injection</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dozer-type-conversion.html">Dozer Type Conversion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-integration.html">Bean Integration</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-binding.html">Bean Binding</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="parameter-binding-annotations.html">Parameter Binding Annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-producing.html">POJO Producing</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pojo-consuming.html">POJO Consuming</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="error-handler.html">Error Handler</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange.html">Message Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="using-exchange-pattern-annotations.html">Using Exchange pattern annotations</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="expression.html">Expressions</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="content-enricher.html">Content Enrichment</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="injector.html">Injector</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="intercept.html">Intercept</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="inversion-of-control-with-smart-defaults.html">Inversion Of Control With Smart Defaults</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="jmx.html">JMX</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="lifecycle.html">Camel Lifecycle</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="oncompletion.html">OnCompletion</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="predicate.html">Predicates</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="registry.html">Registry</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="route-builder.html">RouteBuilder</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routes.html">Routes</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transformer.html">Transformer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validator.html">Validator</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring-remoting.html">Spring Remoting</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hiding-middleware.html">Hidding Middleware</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-toggle" type="button"></button> <span class="nav-text">Domain Specific Languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dsl.html">Camel Domain Specific Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="java-dsl.html">Java DSL</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="spring.html">Spring support</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="groovy-dsl.html">Groovy DSL</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <a class="nav-link" href="using-osgi-blueprint-with-camel.html">Using OSGi blueprint with Camel</a> </li> <li class="nav-item" data-depth="1"> <button class="nav-toggle" type="button"></button> <span class="nav-text">Supported expression languages</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="constant-language.html">Constant Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="exchangeProperty-language.html">ExchangeProperty Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="file-language.html">File Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="header-language.html">Header Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="ref-language.html">Ref Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="simple-language.html">Simple Language</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="tokenize-language.html">Tokenize Language</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-toggle" type="button"></button> <a class="nav-link" href="enterprise-integration-patterns.html">Enterprise Integration Patterns</a> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="aggregate-eip.html">Aggregate EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="batch-config-eip.html">Batch-config EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="bean-eip.html">Bean EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="choice-eip.html">Choice EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="circuitBreaker-eip.html">Circuit Breaker EIP (deprecated)</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="claimCheck-eip.html">Claim Check EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="content-based-router-eip.html">Content Based Router</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="content-filter-eip.html">Content Filter</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="convertBodyTo-eip.html">Convert Body To EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="customLoadBalancer-eip.html">Custom Load Balancer EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="delay-eip.html">Delay EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dynamic-router.html">Dynamic Router</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="dynamicRouter-eip.html">Dynamic Router EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="enrich-eip.html">Enrich EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="eventDrivenConsumer-eip.html">Event Driven Consumer</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="failover-eip.html">Failover EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="filter-eip.html">Filter EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="from-eip.html">From EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hystrix-eip.html">Hystrix EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="hystrixConfiguration-eip.html">Hystrix Configuration EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="idempotentConsumer-eip.html">Idempotent Consumer EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="inOnly-eip.html">In Only EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="inOut-eip.html">In Out EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="loadBalance-eip.html">Load Balance EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="log-eip.html">Log EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="loop-eip.html">Loop EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="marshal-eip.html">Marshal EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="multicast-eip.html">Multicast EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="onFallback-eip.html">On Fallback EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="otherwise-eip.html">Otherwise EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pipeline-eip.html">Pipeline EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="pollEnrich-eip.html">Poll Enrich EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="process-eip.html">Process EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="random-eip.html">Random EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="recipientList-eip.html">Recipient List EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeHeader-eip.html">Remove Header EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeHeaders-eip.html">Remove Headers EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeProperties-eip.html">Remove Properties EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="removeProperty-eip.html">Remove Property EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="requestReply-eip.html">Request Reply</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="resequence-eip.html">Resequence EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="rollback-eip.html">Rollback EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="roundRobin-eip.html">Round Robin EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="routingSlip-eip.html">Routing Slip EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="saga-eip.html">Saga EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sample-eip.html">Sample EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="script-eip.html">Script EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="serviceCall-eip.html">Service Call EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setBody-eip.html">Set Body EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setHeader-eip.html">Set Header EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setOutHeader-eip.html">Set Out Header EIP (deprecated)</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="setProperty-eip.html">Set Property EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sort-eip.html">Sort EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="split-eip.html">Split EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="step-eip.html">Step EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="sticky-eip.html">Sticky EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stop-eip.html">Stop EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="stream-config-eip.html">Stream-config EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="threads-eip.html">Threads EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="throttle-eip.html">Throttle EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="to-eip.html">To EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="toD-eip.html">To D EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="topic-eip.html">Topic EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="transform-eip.html">Transform EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="unmarshal-eip.html">Unmarshal EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="validate-eip.html">Validate EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="weighted-eip.html">Weighted EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="when-eip.html">When EIP</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="wireTap-eip.html">Wire Tap EIP</a> </li> </ul> </li> <li class="nav-item" data-depth="1"> <button class="nav-toggle" type="button"></button> <span class="nav-text">Frequently asked questions</span> <ul class="nav-list"> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/can-i-get-commercial-support.html">Can I get commercial support?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/can-i-use-camel-on-java-14.html">Can I use Camel on Java 1.4?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/does-camel-work-on-ibms-jdk.html">Does Camel work on IBM&#8217;s JDK?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="support.html">How can I get help?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-source-code.html">How can I get the source code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-mule.html">How does Camel compare to Mule?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-servicemix.html">How does Camel compare to ServiceMix?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-servicemix-eip.html">How does Camel compare to ServiceMix EIP?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-compare-to-synapse.html">How does Camel compare to Synapse?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work.html">How does Camel work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work-with-activemq.html">How does Camel work with ActiveMQ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-work-with-servicemix.html">How does Camel work with ServiceMix?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-camel-api-compare-to.html">How does the Camel API compare to?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-the-website-work.html">How does the website work?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-become-a-committer.html">How do I become a committer?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-compile-the-code.html">How do I compile the code?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-edit-the-website.html">How do I edit the website?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-run-camel-using-java-webstart.html">How do I run Camel using Java WebStart?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/if-i-use-servicemix-when-should-i-use-camel.html">If I use ServiceMix when should I use Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-camel-an-esb.html">Is Camel an ESB?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-camel-ioc-friendly.html">Is Camel IoC friendly?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/running-camel-standalone.html">Running Camel standalone</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-are-the-dependencies.html">What are the dependencies?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-a-router.html">What is a router?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-camel.html">What is Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-is-the-license.html">What is the license?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-jars-do-i-need.html">What jars do I need?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="languages.html">What languages are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/what-platforms-are-supported.html">What platforms are supported?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-the-name-camel.html">Why the name Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/classloader-issue-of-servicemix-camel-component.html">Classloader issue of servicemix-camel component</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-which-method-to-use-when-using-beans-in-routes.html">How do I specify which method to use when using beans in routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-create-a-custom-component-or-endpoint.html">How can I create a custom component or endpoint?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-get-the-remote-connection-ip-address-from-the-camel-cxf-consumer-.html">How can I get the remote connection IP address from the camel-cxf consumer ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-i-stop-a-route-from-a-route.html">How can I stop a route from a route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-can-webservice-clients-see-remote-faults-with-stacktraces-when-using-camel-cxf.html">How can webservice clients see remote faults with stacktraces when using camel-cxf?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-does-camel-look-up-beans-and-endpoints.html">How does Camel look up beans and endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="configuring-camel.html">How do I add a component?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-change-the-logging.html">How do I change the logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-endpoints.html">How do I configure endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-password-options-on-camel-endpoints-without-the-value-being-encoded.html">How do I configure password options on Camel endpoints without the value being encoded?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-default-maximum-cache-size-for-producercache-or-producertemplate.html">How do I configure the default maximum cache size for ProducerCache or ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-configure-the-maximum-endpoint-cache-size-for-camelcontext.html">How do I configure the maximum endpoint cache size for CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-debug-my-route.html">How do I debug my route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-disable-jmx.html">How do I disable JMX?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-streams-when-debug-logging-messages-in-camel.html">How do I enable streams when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-handle-failures-when-consuming-for-example-from-a-ftp-server.html">How do I handle failures when consuming for example from a FTP server?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-rests-from-other-xml-files.html">How do I import rests from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-import-routes-from-other-xml-files.html">How do I import routes from other XML files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-let-jetty-match-wildcards.html">How do I let Jetty match wildcards?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-name-my-routes.html">How do I name my routes?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-restart-camelcontext.html">How do I restart CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retrieve-the-thrown-exception-during-processing-an-exchange.html">How do I retrieve the thrown Exception during processing an Exchange?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-failed-messages-forever.html">How do I retry failed messages forever?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-retry-processing-a-message-from-a-certain-point-back-or-an-entire-route.html">How do I retry processing a message from a certain point back or an entire route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-reuse-the-contexttestsupport-class-in-my-unit-tests.html">How do I reuse the ContextTestSupport class in my unit tests?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-run-activemq-and-camel-in-jboss.html">How do I run ActiveMQ and Camel in JBoss?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-max-chars-when-debug-logging-messages-in-camel.html">How do I set the max chars when debug logging messages in Camel?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-specify-time-period-in-a-human-friendly-syntax.html">How do I specify time period in a human friendly syntax?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-a-big-uber-jar.html">How do I use a big (uber) JAR?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-camel-inside-servicemix.html">How do I use Camel inside ServiceMix?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-spring-property-placeholder-with-camel-xml.html">How do I use Spring Property Placeholder with Camel XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-uris-with-parameters-in-xml.html">How do I use URIs with parameters in XML?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-write-a-custom-processor-which-sends-multiple-messages.html">How do I write a custom Processor which sends multiple messages?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-invoke-my-pojos-or-spring-services.html">How should I invoke my POJOs or Spring Services?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-should-i-package-applications-using-camel-and-activemq.html">How should I package applications using Camel and ActiveMQ?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-importing-bunch-of-cxf-packages-when-start-up-the-camel-cxf-endpoint-from-osgi-platform-.html">How to avoid importing bunch of cxf packages when start up the camel-cxf endpoint from OSGi platform?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-avoid-sending-some-or-all-message-headers.html">How to avoid sending some or all message headers?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-define-a-static-camel-converter-method-in-scala.html">How to define a static Camel converter method in Scala?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-remove-the-http-protocol-headers-in-the-camel-message.html">How to remove the http protocol headers in the camel message?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-send-the-same-message-to-multiple-endpoints.html">How to send the same message to multiple endpoints?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-switch-the-cxf-consumer-between-http-and-https-without-touching-the-spring-configuration.html">How to switch the CXF consumer between HTTP and HTTPS without touching the Spring configuration?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-use-a-dynamic-uri-in-to.html">How to use a dynamic URI in to()?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-to-validate-the-camel-1x-context-xml-from-apache-camel-web-site.html">How to validate the camel 1.x context xml from Apache Camel web site?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/is-there-an-ide.html">Is there an IDE?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/should-i-deploy-camel-inside-the-activemq-broker-or-in-another-application.html">Should I deploy Camel inside the ActiveMQ broker or in another application?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-camel-core-testsjar.html">Using camel-core-tests.jar</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/using-getin-or-getout-methods-on-exchange.html">Using getIn or getOut methods on Exchange</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-cant-i-use-sign-in-my-password.html">Why can&#8217;t I use + sign in my password?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-can-i-not-use-when-or-otherwise-in-a-java-camel-route.html">Why can I not use when or otherwise in a Java Camel route?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-ftp-component-not-download-any-files.html">Why does FTP component not download any files?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-file-consumer-not-pick-up-the-file-and-how-do-i-let-the-file-consumer-use-the-camel-error-handler.html">Why does my file consumer not pick up the file, and how do I let the file consumer use the Camel error handler?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-useoriginalmessage-with-error-handler-not-work-as-expected.html">Why does useOriginalMessage with error handler not work as expected?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-my-message-lose-its-headers-during-routing.html">Why do my message lose its headers during routing?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-message-body-empty.html">Why is my message body empty?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-my-processor-not-showing-up-in-jconsole.html">Why is my processor not showing up in JConsole?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-is-the-exception-null-when-i-use-onexception.html">Why is the exception null when I use onException?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-use-multiple-camelcontext.html">Why use multiple CamelContext?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-enable-debug-logging.html">How do I enable debug logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-java-14-logging.html">How do I use Java 1.4 logging?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-use-log4j.html">How do I use log4j?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-invoke-camel-routes-from-jbi.html">How do I invoke Camel routes from JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-make-my-jms-endpoint-transactional.html">How Do I Make My JMS Endpoint Transactional?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-i-set-the-mep-when-interacting-with-jbi.html">How do I set the MEP when interacting with JBI?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-direct-event-seda-and-vm-endpoints-compare.html">How do the direct, event, seda and vm endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/how-do-the-timer-and-quartz-endpoints-compare.html">How do the Timer and Quartz endpoints compare?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-my-jms-route-only-consume-one-message-at-once.html">Why does my JMS route only consume one message at once?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-beandefinitionstoreexception.html">Exception - BeanDefinitionStoreException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-javaxnamingnoinitialcontextexception.html">Exception - javax.naming.NoInitialContextException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgapachecamelnosuchendpointexception.html">Exception - org.apache.camel.NoSuchEndpointException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/exception-orgxmlsaxsaxparseexception.html">Exception - org.xml.sax.SAXParseException</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/memory-leak-when-adding-and-removing-routes-at-runtime.html">Memory leak when adding and removing routes at runtime</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-do-camel-throw-so-many-noclassdeffoundexception-on-startup.html">Why do Camel throw so many NoClassDefFoundException on startup?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-camel-use-too-many-threads-with-producertemplate.html">Why does Camel use too many threads with ProducerTemplate?</a> </li> <li class="nav-item" data-depth="2"> <a class="nav-link" href="faq/why-does-maven-not-download-dependencies.html">Why does maven not download dependencies?</a> </li> </ul> </li> </ul> </li> </ul> </nav> </div> <div class="navigation-explore" data-panel="explore"> <div class="context"> <span class="title">User manual</span> <span class="version">latest</span> </div> <ul class="components"> <li class="component"> <span class="title">Apache Camel K</span> <ul class="versions"> <li class="version is-latest"> <a href="../../camel-k/latest/index.html">latest</a> </li> </ul> </li> <li class="component"> <span class="title">Component reference</span> <ul class="versions"> <li class="version is-latest"> <a href="../../components/latest/index.html">latest</a> </li> </ul> </li> <li class="component is-current"> <span class="title">User manual</span> <ul class="versions"> <li class="version is-current is-latest"> <a href="index.html">latest</a> </li> </ul> </li> </ul> </div> </div> </aside> </div> <main class="main"> <div class="toolbar" role="navigation"> <button class="navigation-toggle" type="button"></button> <a href="index.html" class="home-link"></a> <nav class="crumbs" aria-label="breadcrumbs"> </nav> <div class="edit-this-page"><a href="https://github.com/apache/camel/edit/master/docs/user-manual/modules/ROOT/pages/exception-clause.adoc">Edit this Page</a></div> </div> <article class="doc"> <div class="sect2"> <h3 id="ExceptionClause-ExceptionClause"><a class="anchor" href="#ExceptionClause-ExceptionClause"></a>Exception Clause</h3> <div class="paragraph"> <p>You can use the <em>Exception Clause</em> in the Java <a href="dsl.html" class="page">DSL</a> to specify the error handling you require on a per exception type basis using the <strong><code>onException()</code></strong> method. To get started we give quick sample before digging into how it works.</p> </div> <div class="paragraph"> <p>For example if you want to perform a specific piece of processing if a certain exception is raised you can do this simply via:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(ValidationException.class)
    .to("activemq:validationFailed");

from("seda:inputA")
    .to("validation:foo/bar.xsd", "activemq:someQueue");

from("seda:inputB")
    .to("direct:foo")
    .to("rnc:mySchema.rnc", "activemq:anotherQueue");</code></pre> </div> </div> <div class="paragraph"> <p>Here if the processing of <strong><code>seda:inputA</code></strong> or <strong><code>seda:inputB</code></strong> cause a <strong><code>ValidationException</code></strong> to be thrown (such as due to the XSD validation of the <a href="../../components/latest/validator-component.html" class="page">Validation</a> component or the Relax NG Compact syntax validation of the <a href="../../components/latest/jing-component.html" class="page">Jing</a> component), then the message will be sent to the <strong><code>activemq:validationFailed</code></strong> queue.</p> </div> <div class="paragraph"> <p>You can define multiple <strong><code>onException</code></strong> clauses for different behavior:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(ValidationException.class)
    .to("activemq:validationFailed");

onException(ShipOrderException.class)
    .to("activemq:shipFailed");

from("seda:order")
    .to("bean:processOrder");</code></pre> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-Scopes"><a class="anchor" href="#ExceptionClause-Scopes"></a>Scopes</h4> <div class="paragraph"> <p>Exception clauses is scoped as either:</p> </div> <div class="ulist"> <ul> <li> <p>global (for Java DSL that is per <strong><code>RouteBuilder</code></strong> instances, to reuse, see note below)</p> </li> <li> <p>or route specific</p> </li> </ul> </div> <div class="paragraph"> <p>Where the <strong>global</strong> are the simplest and most easy to understand. In the advanced section we dig into the route specific and even combining them. However</p> </div> <div class="paragraph"> <p>Global scope for Java DSL is per <strong><code>RouteBuilder</code></strong> instance, so if you want to share among multiple <strong><code>RouteBuilder</code></strong> classes, then create a base abstract <strong><code>RouteBuilder</code></strong> class and put the error handling logic in its <strong><code>configure</code></strong> method. And then extend this class, and make sure to class <strong><code>super.configure()</code></strong>. We are just using the Java inheritance technique.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-HowDoesCamelSelectWhichClauseShouldHandleaGivenThrownException"><a class="anchor" href="#ExceptionClause-HowDoesCamelSelectWhichClauseShouldHandleaGivenThrownException"></a>How Does Camel Select Which Clause Should Handle a Given Thrown Exception?</h4> <div class="paragraph"> <p>Camel uses <strong><code>DefaultExceptionPolicyStrategy</code></strong> to determine a strategy how an exception being thrown should be handled by which <strong><code>onException</code></strong> clause. The strategy is:</p> </div> <div class="ulist"> <ul> <li> <p>the order in which the <strong><code>onException</code></strong> is configured takes precedence. Camel will test from first&#8230;&#8203;last defined.</p> </li> <li> <p>Camel will start from the bottom (nested caused by) and recursive up in the exception hierarchy to find the first matching <strong><code>onException</code></strong> clause.</p> </li> <li> <p><strong><code>instanceof</code></strong> test is used for testing the given exception with the <strong><code>onException</code></strong> clause defined exception list. An exact <strong><code>instanceof</code></strong> match will always be used, otherwise the <strong><code>onException</code></strong> clause that has an exception that is the closets super of the thrown exception is selected (recurring up the exception hierarchy).</p> </li> </ul> </div> <div class="paragraph"> <p>This is best illustrated with an exception:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(IOException.class)
    .maximumRedeliveries(3);

onException(OrderFailedException.class)
    .maximumRedeliveries(2);</code></pre> </div> </div> <div class="paragraph"> <p>In the sample above we have defined two exceptions in which <strong><code>IOException</code></strong> is first, so Camel will pickup this exception if there is a match. <strong><code>IOException</code></strong> that is more general is selected then.</p> </div> <div class="paragraph"> <p>So if an exception is thrown with this hierarchy:</p> </div> <div class="literalblock"> <div class="content"> <pre>+ RuntimeCamelException (wrapper exception by Camel)
    + OrderFailedException
        + IOException
            + FileNotFoundException</pre> </div> </div> <div class="paragraph"> <p>Then Camel will try testing the exception in this order: <strong><code>FileNotFoundException</code></strong>, <strong><code>IOException</code></strong>, <strong><code>OrderFailedException</code></strong> and <strong><code>RuntimeCamelException</code></strong>. As we have defined a <strong><code>onException(IOException.class)</code></strong> Camel will select this as it&#8217;s the <strong>closest</strong> match.</p> </div> <div class="paragraph"> <p>If we add a third <strong><code>onException</code></strong> clause with the <strong><code>FileNotFoundException</code></strong></p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(IOException.class)
    .maximumRedeliveries(3);

onException(OrderFailedException.class)
    .maximumRedeliveries(2);

onException(FileNotFoundException.class)
    .handled(true)
    .to("log:nofile");</code></pre> </div> </div> <div class="paragraph"> <p>Then with the previous example Camel will now use the last <strong><code>onException(FileNotFoundException.class)</code></strong> as its an <strong>exact</strong> match. Since this is an exact match it will override the general <strong><code>IOException</code></strong> that was used before to handle the same exception thrown.</p> </div> <div class="paragraph"> <p>Now a new situation if this exception was thrown instead:</p> </div> <div class="literalblock"> <div class="content"> <pre>+ RuntimeCamelException (wrapper exception by Camel)
    + OrderFailedException
        + OrderNotFoundException</pre> </div> </div> <div class="paragraph"> <p>Then the <strong><code>onException(OrderFailedException.class)</code></strong> will be selected - no surprise here.</p> </div> <div class="paragraph"> <p>And this last sample demonstrates the <strong><code>instanceof</code></strong> test aspect in which Camel will select an exception if it&#8217;s an instance of the defined exception in the <strong><code>onException</code></strong> clause. Illustrated as:</p> </div> <div class="literalblock"> <div class="content"> <pre>+ RuntimeCamelException (wrapper exception by Camel)
    + SocketException</pre> </div> </div> <div class="paragraph"> <p>Since <strong><code>SocketException</code></strong> is an <strong><code>instanceof IOException</code></strong>, Camel will select the <strong><code>onException(IOException.class)</code></strong> clause.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-ConfiguringRedeliveryPolicyredeliveroptions"><a class="anchor" href="#ExceptionClause-ConfiguringRedeliveryPolicyredeliveroptions"></a>Configuring RedeliveryPolicy (redeliver options)</h4> <div class="paragraph"> <p><a href="http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/processor/RedeliveryPolicy.html">RedeliveryPolicy</a> requires to use the <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> as the <a href="error-handler.html" class="page">Error Handler</a>. Dead Letter Channel supports attempting to redeliver the message exchange a number of times before sending it to a dead letter endpoint. See <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> for further information about redeliver and which redeliver options exists.</p> </div> <div class="sect4"> <h5 id="_no_redelivery_is_default_for_onexception"><a class="anchor" href="#_no_redelivery_is_default_for_onexception"></a>No redelivery is default for onException</h5> <div class="paragraph"> <p>By default any <a href="#">Exception Clause</a> will <strong>not</strong> redeliver! (as it sets the <code>maximumRedeliveries</code> option to 0).</p> </div> <div class="paragraph"> <p>Sometimes you want to configure the redelivery policy on a per exception type basis. By default in the top examples, if an <strong><code>org.apache.camel.ValidationException</code></strong> occurs then the message will not be redelivered; however if some other exception occurs, e.g., <strong><code>IOException</code></strong> or whatever, the route will be retried according to the settings from the <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a>.</p> </div> <div class="paragraph"> <p>However if you want to customize any methods on the <a href="http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/processor/RedeliveryPolicy.html">RedeliveryPolicy</a> object, you can do this via the fluent API. So lets retry in case of <strong><code>org.apache.camel.ValidationException</code></strong> up till two times.</p> </div> <div class="paragraph"> <p><strong>Java DSL</strong>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(ValidationException.class)
    .maximumRedeliveries(2);</code></pre> </div> </div> <div class="paragraph"> <p><strong>Spring XML DSL</strong>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;onException&gt;
    &lt;exception&gt;com.mycompany.ValidationException&lt;/exception&gt;
    &lt;redeliveryPolicy maximumRedeliveries="2"/&gt;
&lt;/onException&gt;</code></pre> </div> </div> <div class="paragraph"> <p>You can customize any of the <a href="http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/processor/RedeliveryPolicy.html">RedeliveryPolicy</a> so we can for instance set a different delay of <strong><code>5000</code></strong> millis:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;onException&gt;
    &lt;exception&gt;com.mycompany.ValidationException&lt;/exception&gt;
    &lt;redeliveryPolicy maximumRedeliveries="2" delay="5000"/&gt;
&lt;/onException&gt;</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-PointofEntryforRedeliveryAttempts"><a class="anchor" href="#ExceptionClause-PointofEntryforRedeliveryAttempts"></a>Point of Entry for Redelivery Attempts</h4> <div class="paragraph"> <p>All redelivery attempts start at the point of the failure. So the route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(ConnectException.class)
    .from("direct:start")
    .process("processor1")
    .process("processor2") // &lt;--- throws a ConnectException
    .to("mock:theEnd")</code></pre> </div> </div> <div class="paragraph"> <p>Will retry from <strong><code>processor2</code></strong> - not the complete route.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-ReusingRedeliveryPolicy"><a class="anchor" href="#ExceptionClause-ReusingRedeliveryPolicy"></a>Reusing RedeliveryPolicy</h4> <div class="paragraph"> <p><strong>Available as of Camel 1.5.1 or later</strong></p> </div> <div class="paragraph"> <p>You can reference a <strong><code>RedeliveryPolicy</code></strong> so you can reuse existing configurations and use standard spring bean style configuration that supports property placeholders.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="myRedeliveryPolicy" class="org.apache.camel.processor.RedeliveryPolicy"&gt;
    &lt;property name="maximumRedeliveries" value="${myprop.max}"/&gt;
&lt;/bean&gt;

&lt;!-- here we reference our redelivery policy defined above --&gt;
&lt;onException redeliveryPolicyRef="myRedeliveryPolicy"&gt;
    &lt;!-- you can define multiple exceptions just adding more exception elements as show below --&gt;
    &lt;exception&gt;com.mycompany.MyFirstException&lt;/exception&gt;
    &lt;exception&gt;com.mycompany.MySecondException&lt;/exception&gt;
&lt;/onException&gt;</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-AsynchronousDelayedRedelivery"><a class="anchor" href="#ExceptionClause-AsynchronousDelayedRedelivery"></a>Asynchronous Delayed Redelivery</h4> <div class="paragraph"> <p><strong>Available as of Camel 2.4</strong></p> </div> <div class="paragraph"> <p>From <strong>Camel 2.4</strong>: Camel has a feature to <strong>not block</strong> while waiting for a delayed redelivery to occur. However if you use transacted routes then Camel will block as its mandated by the transaction manager to execute all the work in the same thread context. You can enable the non blocking asynchronous behavior by the <strong><code>asyncDelayedRedelivery</code></strong> option. This option can be set on the <strong><code>errorHandler</code></strong>, <strong><code>onException</code></strong> or the redelivery policies.</p> </div> <div class="paragraph"> <p>By default the error handler will create and use a scheduled thread pool to trigger redelivery in the future. From <strong>Camel 2.8</strong>: you can configure the <strong><code>executorServiceRef</code></strong> on the <a href="error-handler.html" class="page">Error Handler</a> to indicate a reference to either a shared thread pool you can enlist in the registry, or a thread pool profile in case you want to be able to control pool settings.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-CatchingMultipleExceptions"><a class="anchor" href="#ExceptionClause-CatchingMultipleExceptions"></a>Catching Multiple Exceptions</h4> <div class="paragraph"> <p><strong>Available as of Camel 1.5</strong></p> </div> <div class="paragraph"> <p>In Camel 1.5 the <strong>exception</strong> clauses has been renamed to <strong><code>onException</code></strong> and it also supports multiple exception classes:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(MyBusinessException.class, MyOtherBusinessException.class)
    .maximumRedeliveries(2)
    .to("activemq:businessFailed");</code></pre> </div> </div> <div class="paragraph"> <p>And in Spring DSL you just add another exception element:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;onException&gt;
    &lt;exception&gt;com.mycompany.MyBusinessException&lt;/exception&gt;
    &lt;exception&gt;com.mycompany.MyOtherBusinessException&lt;/exception&gt;
    &lt;redeliveryPolicy maximumRedeliveries="2"/&gt;
    &lt;to uri="activemq:businessFailed"/&gt;
&lt;/onException&gt;</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingaProcessorasaFailureHandler"><a class="anchor" href="#ExceptionClause-UsingaProcessorasaFailureHandler"></a>Using a Processor as a Failure Handler</h4> <div class="paragraph"> <p>We want to handle certain exceptions specially so we add a <strong><code>onException</code></strong> clause for that exception.</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionProcessorInspectCausedExceptionTest.java</p> </div> <div class="paragraph"> <p>So what happens is that whenever a <strong><code>MyFunctionalException</code></strong> is thrown it is being routed to our processor <strong><code>MyFunctionFailureHandler</code></strong>. So you can say that the exchange is diverted when a <strong><code>MyFunctionalException</code></strong> is thrown during processing. It&#8217;s important to distinct this as perfect valid. The default redelivery policy from the <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> will not kick in, so our processor receives the Exchange directly, without any redeliver attempted. In our processor we need to determine what to do. Camel regards the Exchange as <strong>failure handled</strong>. So our processor is the end of the route. So lets look the code for our processor.</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionProcessorInspectCausedExceptionTest.java</p> </div> <div class="paragraph"> <p>Notice how we get the <strong>caused by</strong> exception using a property on the Exchange. This is where Camel stores any caught exception during processing. So you can fetch this property and check what the exception message and do what you want. In the code above we just route it to a mock endpoint using a producer template from Exchange.</p> </div> </div> </div> <div class="sect2"> <h3 id="ExceptionClause-MarkingExceptionsasHandled"><a class="anchor" href="#ExceptionClause-MarkingExceptionsasHandled"></a>Marking Exceptions as Handled</h3> <div class="paragraph"> <p><strong>Available as of Camel 1.5</strong></p> </div> <div class="sect3"> <h4 id="_continued"><a class="anchor" href="#_continued"></a>Continued</h4> <div class="paragraph"> <p>See also the section <a href="#">Handle and continue exceptions</a> below.</p> </div> <div class="paragraph"> <p>Using <strong><code>onException</code></strong> to handle known exceptions is a very powerful feature in Camel. However prior to Camel 1.5 you could not mark the exception as being handled, so the caller would still receive the caused exception as a response. In Camel 1.5 you can now change this behavior with the new <strong>handle</strong> DSL. The handle is a <a href="predicate.html" class="page">Predicate</a> that is overloaded to accept three types of parameters:</p> </div> <div class="ulist"> <ul> <li> <p>Boolean</p> </li> <li> <p><a href="predicate.html" class="page">Predicate</a></p> </li> <li> <p><a href="expression.html" class="page">Expression</a> that will be evaluates as a <a href="predicate.html" class="page">Predicate</a> using this rule set: If the expressions returns a Boolean its used directly. For any other response its regarded as <code>true</code> if the response is <code>not null</code>.</p> </li> </ul> </div> <div class="paragraph"> <p>For instance to mark all <strong><code>ValidationException</code></strong> as being handled we can do this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(ValidationException)
    .handled(true);</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-ExampleUsingHandled"><a class="anchor" href="#ExceptionClause-ExampleUsingHandled"></a>Example Using Handled</h4> <div class="paragraph"> <p>In this route below we want to do special handling of all <strong><code>OrderFailedException</code></strong> as we want to return a customized response to the caller. First we setup our routing as:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/DeadLetterChannelHandledExampleTest.java</p> </div> <div class="paragraph"> <p>Then we have our service beans that is just plain POJO demonstrating how you can use <a href="bean-integration.html" class="page">Bean Integration</a> in Camel to avoid being tied to the Camel API:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/DeadLetterChannelHandledExampleTest.java</p> </div> <div class="paragraph"> <p>And finally the exception that is being thrown is just a regular exception:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/DeadLetterChannelHandledExampleTest.java</p> </div> <div class="paragraph"> <p>So what happens?</p> </div> <div class="paragraph"> <p>If we sent an order that is being processed OK then the caller will receive an Exchange as reply containing <strong><code>Order OK</code></strong> as the payload and <strong><code>orderid=123</code></strong> in a header.</p> </div> <div class="paragraph"> <p>If the order could <strong>not</strong> be processed and thus an <strong><code>OrderFailedException</code></strong> was thrown the caller will <strong>not</strong> receive this exception (as opposed to in Camel 1.4, where the caller received the <strong><code>OrderFailedException</code></strong>) but our customized response that we have fabricated in the <strong><code>orderFailed</code></strong> method in our <strong><code>OrderService</code></strong>. So the caller receives an Exchange with the payload <strong><code>Order ERROR</code></strong> and a <strong><code>orderid=failed</code></strong> in a header.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingHandledwithSpringDSL"><a class="anchor" href="#ExceptionClause-UsingHandledwithSpringDSL"></a>Using Handled with Spring DSL</h4> <div class="paragraph"> <p>The same route as above in Spring DSL:</p> </div> <div class="paragraph"> <p>/components/camel-spring/src/test/resources/org/apache/camel/spring/processor/onexception/deadLetterChannelHandledExampleTest.xml</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-HandlingandSendingaFixedResponseBacktotheClient"><a class="anchor" href="#ExceptionClause-HandlingandSendingaFixedResponseBacktotheClient"></a>Handling and Sending a Fixed Response Back to the Client</h4> <div class="paragraph"> <p>In the route above we handled the exception but routed it to a different endpoint. What if you need to alter the response and send a fixed response back to the original caller (the client). No secret here just do as you do in normal Camel routing, use <a href="message-translator.html" class="page">transform</a> to set the response, as shown in the sample below:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionHandleAndTransformTest.java</p> </div> <div class="paragraph"> <p>We modify the sample slightly to return the original caused exception message instead of the fixed text <code>Sorry</code>:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionHandleAndTransformTest.java</p> </div> <div class="paragraph"> <p>And we can use the <a href="simple-language.html" class="page">Simple</a> language to set a readable error message with the caused exception message:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionHandleAndTransformTest.java</p> </div> </div> </div> <div class="sect2"> <h3 id="ExceptionClause-HandleandContinueExceptions"><a class="anchor" href="#ExceptionClause-HandleandContinueExceptions"></a>Handle and Continue Exceptions</h3> <div class="paragraph"> <p><strong>Available as of Camel 2.3</strong></p> </div> <div class="paragraph"> <p>In Camel 2.3 we introduced a new option <code>continued</code> which allows you to both <strong><code>handle</code></strong> and <strong><code>continue</code></strong> routing in the original route as if the exception did not occur.</p> </div> <div class="paragraph"> <p>For example: to ignore and continue when the <strong><code>IDontCareException</code></strong> was thrown we can do this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">onException(IDontCareException)
    .continued(true);</code></pre> </div> </div> <div class="paragraph"> <p>You can maybe compare continued with a having a <strong><code>try &#8230;&#8203; catch</code></strong> block around each step and then just ignore the exception. Using continued makes it easier in Camel as you otherwise had to use <a href="try-catch-finally.html" class="page">Try Catch Finally</a> style for this kind of use case.</p> </div> <div class="sect3"> <h4 id="ExceptionClause-ExampleUsingcontinued"><a class="anchor" href="#ExceptionClause-ExampleUsingcontinued"></a>Example Using continued</h4> <div class="paragraph"> <p>In this route below we want to do special handling of all <strong><code>IllegalArgumentException</code></strong> as we just want to continue routing.</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionContinueTest.java</p> </div> <div class="paragraph"> <p>And the same example in Spring XML:</p> </div> <div class="paragraph"> <p>/components/camel-spring/src/test/resources/org/apache/camel/spring/processor/onexception/OnExceptionContinueTest.xml</p> </div> <div class="paragraph"> <p>[[ExceptionClause-WhatistheDifferenceBetweenHandledandContinued?]] ==== What is the Difference Between Handled and Continued?</p> </div> <div class="paragraph"> <p>If handled is true, then the thrown exception will be <em>handled</em> and Camel will <strong>not</strong> continue routing in the original route, but break out. However you can configure a route in the <strong><code>onException</code></strong> which will be used instead. You use this route if you need to create some custom response message back to the caller, or do any other processing because that exception was thrown.</p> </div> <div class="paragraph"> <p>If continued is true, then Camel will catch the exception and in fact just ignore it and continue routing in the original route. However if you have a route configured in the <strong><code>onException</code></strong> it will route that route first, before it will continue routing in the original route.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsinguseOriginalMessage"><a class="anchor" href="#ExceptionClause-UsinguseOriginalMessage"></a>Using <code>useOriginalMessage</code></h4> <div class="paragraph"> <p>The option <strong><code>useOriginalMessage</code></strong> is used for routing the original input message instead of the current message that potential is modified during routing.</p> </div> <div class="paragraph"> <p>For example: if you have this route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("jms:queue:order:input")
    .to("bean:validateOrder");
    .to("bean:transformOrder")
    .to("bean:handleOrder");</code></pre> </div> </div> <div class="paragraph"> <p>The route listen for JMS messages and validates, transforms and handle it. During this the <a href="exchange.html" class="page">Exchange</a> payload is transformed/modified. So in case something goes wrong and we want to move the message to another JMS destination, then we can add an <strong><code>onException</code></strong>. But when we move the <a href="exchange.html" class="page">Exchange</a> to this destination we do not know in which state the message is in. Did the error happen in before the <strong><code>transformOrder</code></strong> or after? So to be sure we want to move the original input message we received from <code>jms:queue:order:input</code>. So we can do this by enabling the <strong><code>useOriginalMessage</code></strong> option as shown below:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// will use original input message (body and headers)
onException(MyOrderException.class)
    .useOriginalMessage()
    .handled(true)
    .to("jms:queue:order:failed");</code></pre> </div> </div> <div class="paragraph"> <p>Then the messages routed to the <strong><code>jms:queue:order:failed</code></strong> is the original input. If we want to manually retry we can move the JMS message from the failed to the input queue, with no problem as the message is the same as the original we received.</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-useOriginalMessagewithSpringDSL"><a class="anchor" href="#ExceptionClause-useOriginalMessagewithSpringDSL"></a><code>useOriginalMessage</code> with Spring DSL</h4> <div class="paragraph"> <p>The <strong><code>useOriginalMessage</code></strong> option is defined as a boolean attribute on the <strong><code>&lt;onException&gt;</code></strong> XML tag in Spring DSL. So the definition above would be:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;onException useOriginalMessage="true"&gt;
    &lt;exception&gt;com.mycompany.MyOrderException&lt;/exception&gt;
    &lt;handled&gt;&lt;constant&gt;true&lt;/constant&gt;&lt;/handled&gt;
    &lt;to uri="jms:queue:order:failed"/&gt;
&lt;/onException&gt;</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="_boundary_of_original_message"><a class="anchor" href="#_boundary_of_original_message"></a>Boundary of original message</h4> <div class="paragraph"> <p>The original input means the input message that are bounded by the current unit of work. An unit of work typically spans one route, or multiple routes if they are connected using internal endpoints such as direct or seda. When messages is passed via external endpoints such as JMS or HTT then the consumer will create a new unit of work, with the message it received as input as the original input. Also some EIP patterns such as splitter, multicast, will create a new unit of work boundary for the messages in their sub-route (eg the splitted message); however these EIPs have an option named shareUnitOfWork which allows to combine with the parent unit of work in regard to error handling and therefore use the parent original message.</p> </div> </div> <div class="sect3"> <h4 id="_usinguseoriginalbody"><a class="anchor" href="#_usinguseoriginalbody"></a>Using <code>useOriginalBody</code></h4> <div class="paragraph"> <p>The useOriginalBody is similar to useOriginalMessage as documented above. You may want to use useOriginalBody when you want to be able to enrich the message with custom headers and preserve the original message body before sending to an error handler or dead letter channel.</p> </div> <div class="paragraph"> <p>For example: if you have this route:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// will use original input body
onException(MyOrderException.class)
    .useOriginalBody()
    .handled(true)
    .to("jms:queue:order:failed");

from("jms:queue:order:input")
    .setHeader("application", constant("OrderApp"))
    .to("bean:validateOrder");
    .to("bean:transformOrder")
    .to("bean:handleOrder");</code></pre> </div> </div> <div class="paragraph"> <p>Then the message has been enriched with a header named application after the original message was recieved in the JMS endpoint. And in case of an error then the <code>onException</code> will handle the exception and use the original message body and the headers from the current message as-is, which means the headers will include the application header.</p> </div> </div> </div> <div class="sect2"> <h3 id="ExceptionClause-AdvancedUsageofExceptionClause"><a class="anchor" href="#ExceptionClause-AdvancedUsageofExceptionClause"></a>Advanced Usage of <a href="#">Exception Clause</a></h3> <div class="sect3"> <h4 id="ExceptionClause-UsingGlobalandPerRouteExceptionClauses"><a class="anchor" href="#ExceptionClause-UsingGlobalandPerRouteExceptionClauses"></a>Using Global and Per Route Exception Clauses</h4> <div class="paragraph"> <p>Camel supports quite advanced configuration of exception clauses.</p> </div> <div class="paragraph"> <p>You can define exception clauses either as:</p> </div> <div class="ulist"> <ul> <li> <p>global</p> </li> <li> <p>or route specific</p> </li> </ul> </div> <div class="paragraph"> <p>We start off with the sample sample that we change over time. First off we use only global exception clauses:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionRouteTest.java</p> </div> <div class="paragraph"> <p>In the next sample we change the global exception policies to be pure route specific.</p> </div> <div class="sect4"> <h5 id="_must_use_end_for_route_specific_exception_policies"><a class="anchor" href="#_must_use_end_for_route_specific_exception_policies"></a>Must use <code>.end()</code> for route specific exception policies</h5> <div class="paragraph"> <p>[IMPORTANT] This requires to end the <strong><code>onException</code></strong> route with <strong><code>.end()</code></strong> to indicate where it stops and when the regular route continues.</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionSubRouteTest.java</p> </div> <div class="paragraph"> <p>And now it gets complex as we combine global and route specific exception policies as we introduce a second route in the sample:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionComplexRouteTest.java</p> </div> <div class="paragraph"> <p>Notice that we can define the same exception <strong><code>MyFunctionalException</code></strong> in both routes, but they are configured differently and thus is handled different depending on the route. You can of course also add a new <strong><code>onException</code></strong> to one of the routes so it has an additional exception policy.</p> </div> <div class="paragraph"> <p>And finally we top this by throwing in a nested error handler as well, as we add the 3rd route shown below:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionComplexWithNestedErrorHandlerRouteTest.java</p> </div> </div> <div class="sect4"> <h5 id="_global_exception_policies_and_nested_error_handlers"><a class="anchor" href="#_global_exception_policies_and_nested_error_handlers"></a>Global exception policies and nested error handlers</h5> <div class="paragraph"> <p>The sample above with both nested error handlers and both global and per route exception clauses is a bit advanced. It&#8217;s important to get the fact straight that the <strong>global</strong> exception clauses is really global so they also applies for nested error handlers. So if a <strong><code>MyTechnicalException</code></strong> is thrown then it&#8217;s the global exception policy that is selected.</p> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingFineGrainedSelectionUsingonWhenPredicate"><a class="anchor" href="#ExceptionClause-UsingFineGrainedSelectionUsingonWhenPredicate"></a>Using Fine Grained Selection Using <code>onWhen</code> Predicate</h4> <div class="paragraph"> <p><strong>Available as of Camel 1.5.1 or later</strong></p> </div> <div class="paragraph"> <p>You can attach an <a href="expression.html" class="page">Expression</a> to the exception clause to have fine grained control when a clause should be selected or not. As it&#8217;s an <a href="expression.html" class="page">Expression</a> you can use any kind of code to perform the test. Here is a sample:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/exceptionpolicy/DefaultExceptionPolicyStrategyUsingWhenTest.java</p> </div> <div class="paragraph"> <p>In the sample above we have two <strong><code>onException</code></strong>'s defined. The first has an <strong><code>onWhen</code></strong> expression attached to only trigger if the message has a header with the key user that is not null. If so this clause is selected and is handling the thrown exception. The second clause is a for coarse gained selection to select the same exception being thrown but when the expression is evaluated to false.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> <td class="content"> this is not required, if the second clause is omitted, then the default error handler will kick in. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingonRedeliveryProcessor"><a class="anchor" href="#ExceptionClause-UsingonRedeliveryProcessor"></a>Using <code>onRedelivery</code> Processor</h4> <div class="paragraph"> <p><strong>Available as of Camel 2.0</strong></p> </div> <div class="paragraph"> <p><a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> has support for <strong><code>onRedelivery</code></strong> to allow custom processing of a Message before its being redelivered. It can be used to add some customer header or whatnot. In Camel 2.0 we have added this feature to <a href="#">Exception Clause</a> as well, so you can use per exception scoped on redelivery. Camel will fallback to use the one defined on <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> if any, if none exists on the <a href="#">Exception Clause</a>. See <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> for more details on <strong><code>onRedelivery</code></strong>.</p> </div> <div class="paragraph"> <p>In the code below we want to do some custom code before redelivering any <strong><code>IOException</code></strong>. So we configure an <strong><code>onException</code></strong> for the <strong><code>IOException</code></strong> and set the <strong><code>onRedelivery</code></strong> to use our custom processor:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/DeadLetterChannelOnExceptionOnRedeliveryTest.java</p> </div> <div class="paragraph"> <p>And in our custom processor we set a special timeout header to the message. You can of course do anything what you like in your code.</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/DeadLetterChannelOnExceptionOnRedeliveryTest.java</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingonRedeliveryinSpringDSL"><a class="anchor" href="#ExceptionClause-UsingonRedeliveryinSpringDSL"></a>Using <code>onRedelivery</code> in Spring DSL</h4> <div class="paragraph"> <p>In Spring DSL you need to use the <strong><code>onRedeliveryRef</code></strong> attribute to refer to a spring bean id that is your custom processor:</p> </div> <div class="paragraph"> <p>/components/camel-spring/src/test/resources/org/apache/camel/spring/processor/onexception/DeadLetterChannelOnExceptionOnRedeliveryTest.xml</p> </div> <div class="paragraph"> <p>And our processor is just a regular spring bean (we use <strong><code>$</code></strong> for the inner class as this code is based on unit testing):</p> </div> <div class="paragraph"> <p>/components/camel-spring/src/test/resources/org/apache/camel/spring/processor/onexception/DeadLetterChannelOnExceptionOnRedeliveryTest.xml</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingonExceptionOccurredProcessor"><a class="anchor" href="#ExceptionClause-UsingonExceptionOccurredProcessor"></a>Using <code>onExceptionOccurred</code> Processor</h4> <div class="paragraph"> <p><strong>Available as of Camel 2.17</strong></p> </div> <div class="paragraph"> <p><a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> has support for <strong><code>onExceptionOccurred</code></strong> to allow custom processing of a Message just after the exception was thrown. It can be used to do some custom logging or whatnot. The difference between <strong><code>onRedelivery</code></strong> processor and <strong><code>onExceptionOccurred</code></strong> processor, is that the former is processed just before a redelivery attempt is being performed, that means it will not happen right after an exception was thrown. For example if the error handler has been configured to perform 5 seconds delay between redelivery attempts, then the redelivery processor is invoked 5 seconds later sine the exception was thrown. On the other hand the <strong><code>onExceptionOccurred</code></strong> processor is always invoked right after the exception was thrown, and also if redelivery has been disabled.</p> </div> <div class="paragraph"> <p>NOTE: Any new exceptions thrown from the <strong><code>onExceptionOccurred</code></strong> processor is logged as <strong><code>WARN</code></strong> and ignored, to not override the existing exception.</p> </div> <div class="paragraph"> <p>In the code below we want to do some custom logging when an exception happened. Therefore we configure an <strong><code>onExceptionOccurred</code></strong> to use our custom processor:</p> </div> <div class="listingblock java"> <div class="content"> <pre class="highlightjs highlight"><code>errorHandler(defaultErrorHandler()
    .maximumRedeliveries(3)
    .redeliveryDelay(5000)
    .onExceptionOccurred(myProcessor));</code></pre> </div> </div> <div class="sect4"> <h5 id="ExceptionClause-UsingonRedeliveryinSpringDSL.1"><a class="anchor" href="#ExceptionClause-UsingonRedeliveryinSpringDSL.1"></a>Using <code>onRedelivery</code> in Spring DSL</h5> <div class="paragraph"> <p>In Spring DSL you need to use the <strong><code>onExceptionOccurredRef</code></strong> attribute to refer to a spring bean id that is your custom processor:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;bean id="myProcessor" class="com.foo.MyExceptionLoggingProcessor"/&gt;

&lt;camelContext errorHandlerRef="eh" xmlns="http://camel.apache.org/schema/spring"&gt;
    &lt;errorHandler id="eh" type="DefaultErrorHandler" onExceptionOccurredRef="myProcessor"&gt;
        &lt;redeliveryPolicy maximumRedeliveries="3" redeliveryDelay="5000"/&gt;
    &lt;/errorHandler&gt;
    ...
&lt;/camelContext&gt;</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingFineGrainedRetryUsingretryWhilePredicate"><a class="anchor" href="#ExceptionClause-UsingFineGrainedRetryUsingretryWhilePredicate"></a>Using Fine Grained Retry Using <code>retryWhile</code> Predicate</h4> <div class="paragraph"> <p><strong>Available as of Camel 2.0</strong></p> </div> <div class="sect4"> <h5 id="_retryuntil"><a class="anchor" href="#_retryuntil"></a>RetryUntil</h5> <div class="paragraph"> <p>In Camel 2.0 to 2.3 its called <strong><code>retryUntil</code></strong>. From <strong>Camel 2.4</strong>: its named <strong><code>retryWhile</code></strong> because Camel will continue doing retries <em>while</em> the predicate returns true.</p> </div> <div class="paragraph"> <p>When you need fine grained control for determining if an exchange should be retried or not you can use the <strong><code>retryWhile</code></strong> predicate. Camel will redeliver until the predicate returns false.</p> </div> <div class="paragraph"> <p>Example:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionRetryUntilTest.java</p> </div> <div class="paragraph"> <p>Where the bean <strong><code>myRetryHandler</code></strong> is computing if we should retry or not:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/onexception/OnExceptionRetryUntilTest.java</p> </div> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingCustomExceptionPolicyStrategy"><a class="anchor" href="#ExceptionClause-UsingCustomExceptionPolicyStrategy"></a>Using Custom <code>ExceptionPolicyStrategy</code></h4> <div class="paragraph"> <p><strong>Available in Camel 1.4</strong></p> </div> <div class="paragraph"> <p>The default <a href="http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/processor/exceptionpolicy/ExceptionPolicyStrategy.html">ExceptionPolicyStrategy</a> in Camel should be sufficient in nearly all use-cases (see section <a href="#ExceptionClause-HowDoesCamelSelectWhichClauseShouldHandleaGivenThrownException">How does Camel select which clause should handle a given thrown Exception</a>). However, if you need to use your own this can be configured as the sample below illustrates:</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/exceptionpolicy/CustomExceptionPolicyStrategyTest.java</p> </div> <div class="paragraph"> <p>Using our own strategy <strong><code>MyPolicy</code></strong> we can change the default behavior of Camel with our own code to resolve which <a href="http://camel.apache.org/maven/camel-core/apidocs/org/apache/camel/model/ExceptionType.html">ExceptionType</a> from above should be handling the given thrown exception.</p> </div> <div class="paragraph"> <p>/camel-core/src/test/java/org/apache/camel/processor/exceptionpolicy/CustomExceptionPolicyStrategyTest.java</p> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-UsingtheExceptionClauseinSpringDSL"><a class="anchor" href="#ExceptionClause-UsingtheExceptionClauseinSpringDSL"></a>Using the Exception Clause in Spring DSL</h4> <div class="paragraph"> <p>You can use all of the above mentioned exception clause features in the Spring DSL as well. Here are a few examples:</p> </div> <div class="ulist"> <ul> <li> <p>Global scoped - <strong>Available in Camel 2.0</strong> /components/camel-spring/src/test/resources/org/apache/camel/spring/processor/onexception/deadLetterChannelHandledExampleTest.xml</p> </li> <li> <p>Route specific scoped /components/camel-spring/src/test/resources/org/apache/camel/spring/processor/onexception/onExceptionSubRouteTest.xml</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="ExceptionClause-Seealso"><a class="anchor" href="#ExceptionClause-Seealso"></a>See also</h4> <div class="ulist"> <ul> <li> <p>The <a href="error-handler.html" class="page">Error Handler</a> for the general error handling documentation</p> </li> <li> <p>The <a href="dead-letter-channel.html" class="page">Dead Letter Channel</a> for further details</p> </li> <li> <p>The <a href="transactional-client.html" class="page">Transactional Client</a> for transactional behavior</p> </li> </ul> </div> </div> </div> </article> </main> </div> <footer class="footer bg-brown text-white"> <div class="container"> <div class="row"> <div class="col-md-3 pt-5"> <img src="../../_/img/logo-d.svg" class="logo-small mt-60" alt="Apache Camel Logo" aria-label="white silhouette of a camel in front of a sand dune"> </div> <div class="col-md-3"> <h5>Overview</h5> <ul class="list-unstyled"> <li><a href="../../news/">News</a></li> <li><a href="../../components/latest/">Components</a></li> <li><a href="../../download/">Download</a></li> <li><a href="../../docs/getting-started/">Getting started</a></li> <li><a href="../../manual/latest/faq.html">FAQ</a></li> </ul> </div> <div class="col-md-3"> <h5>Community</h5> <ul class="list-unstyled"> <li><a href="../../community/support/">Support</a></li> <li><a href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a></li> <li><a href="../../community/user-stories/">User stories</a></li> <li><a href="../../community/articles/">Articles</a></li> <li><a href="../../community/books/">Books</a></li> <li><a href="../../community/team/">Team</a></li> <li><a href="../../community/camel-extra/">Camel extra</a></li> </ul> </div> <div class="col-md-3"> <h5>About</h5> <ul class="list-unstyled"> <li><a href="../../acknowledgments/">Acknowledgments</a></li> <li><a target="_blank" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></li> <li><a target="_blank" href="https://www.apache.org/licenses/" title="License">License</a></li> <li><a target="_blank" href="https://www.apache.org/security/" title="Security">Security</a></li> <li><a target="_blank" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></li> <li><a target="_blank" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></li> </ul> </div> </div> </div> <div class="container"> © 2004-2018 The <a href="https://apache.org">Apache Software Foundation</a>.<br> Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners. </div> </footer> <script src="../../_/js/site.js"></script> <script src="../../_/js/vendor/highlight.js"></script> <script type="application/ld+json"> {
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Apache Camel",
  "url": "../..",
  "sameAs": [
     "https://twitter.com/cameltweet"
  ],
  "logo": "../../_/img/logo-d.svg",
  "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL."
} </script> </body> </html> 