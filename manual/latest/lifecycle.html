<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Untitled :: Apache Camel</title><link rel="canonical" href="https://camel.apache.org/manual/latest/lifecycle.html"><meta name="generator" content="Antora 2.0.0"><link rel="stylesheet" href="../../_/css/site.css"></head><body class="article"><header class="header"><nav class="navbar shadow border-bottom"><div class="navbar-brand"><a class="navbar-item nav-logo" href="https://camel.apache.org" title="Apache Camel"></a><button class="navbar-burger" data-target="topbar-nav"><span></span><span></span><span></span></button></div><div id="topbar-nav" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/news/">News</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Projects</a><div class="navbar-dropdown"><a class="navbar-item" href="/projects/camel-k/">Camel K</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Documentation</a><div class="navbar-dropdown"><a class="navbar-item" href="/docs/getting-started/">Getting started</a><a class="navbar-item" href="/manual/latest/">User manual</a><a class="navbar-item" href="/components/latest/">Component reference</a><a class="navbar-item" href="/camel-k/latest/">Camel K</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">Community</a><div class="navbar-dropdown"><a class="navbar-item" href="/community/support/">Support</a><a class="navbar-item" href="https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a><a class="navbar-item" href="/community/user-stories/">User stories</a><a class="navbar-item" href="/community/articles/">Articles</a><a class="navbar-item" href="/community/books/">Books</a><a class="navbar-item" href="/community/team/">Team</a><a class="navbar-item" href="/community/camel-extra/">Camel extra</a></div></div><a class="navbar-item" href="/download/">Download</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="#">About</a><div class="navbar-dropdown"><a class="navbar-item" href="https://www.apache.org/events/current-event.html">Apache events</a><a class="navbar-item" href="https://www.apache.org/licenses/">License</a><a class="navbar-item" href="https://www.apache.org/security/">Security</a><a class="navbar-item" href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a><a class="navbar-item" href="https://www.apache.org/foundation/thanks.html">Thanks</a></div></div></div></div></nav></header><div class="main-wrapper"><div class="navigation-container" data-component="manual" data-version="latest"><aside class="navigation"><div class="panels"><div class="navigation-menu is-active" data-panel="menu"><nav class="nav-menu"><h3 class="title"><a href="index.html">User manual</a></h3><ul class="nav-list"><li class="nav-item" data-depth="0"><ul class="nav-list"><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="getting-started.html">Getting started</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="architecture.html">Architecture</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="async.html">Async</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="asynchronous-routing-engine.html">Asynchronous Routing Engine</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="backlogdebugger.html">Backlog debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bam.html">Business Activity Monitoring</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="batch-consumer.html">Batch Consumer</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camel-core.html">Core</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camelcontext.html">Context</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="endpoint.html">Endpoints</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="cep.html">Complex Event Processing</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="component.html">Component</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="debugger.html">Debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="delay-interceptor.html">Delay interceptor</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dependency-injection.html">Dependency Injection</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dozer-type-conversion.html">Dozer Type Conversion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bean-integration.html">Bean Integration</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="error-handler.html">Error Handler</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange.html">Message Exchange</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="expression.html">Expressions</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="injector.html">Injector</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="intercept.html">Intercept</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="inversion-of-control-with-smart-defaults.html">Inversion Of Control With Smart Defaults</a></li><li class="nav-item is-current-page" data-depth="2"><a class="nav-link" href="lifecycle.html">Camel Lifecycle</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="oncompletion.html">OnCompletion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="predicate.html">Predicates</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="registry.html">Registry</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="route-builder.html">RouteBuilder</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="routes.html">Routes</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><span class="nav-text">Domain Specific Languages</span><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="dsl.html">Camel Domain Specific Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="java-dsl.html">Java DSL</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="spring.html">Spring support</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="groovy-dsl.html">Groovy DSL</a></li><li class="nav-item" data-depth="2"><button class="nav-toggle"></button><span class="nav-text">Scala DSL</span><ul class="nav-list"><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl.html">About the Scala DSL</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-getting-started.html">Getting Started</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-eip.html">EIP</a></li><li class="nav-item" data-depth="3"><a class="nav-link" href="scala-dsl-supported-languages.html">Supported languages</a></li></ul></li></ul></li><li class="nav-item" data-depth="1"><a class="nav-link" href="using-osgi-blueprint-with-camel.html">Using OSGi blueprint with Camel</a></li></ul></li></ul></nav></div><div class="navigation-explore" data-panel="explore"><div class="context"><span class="title">User manual</span><span class="version">latest</span></div><ul class="components"><li class="component"><span class="title">Apache Camel K</span><ul class="versions"><li class="version is-latest"><a href="../../camel-k/latest/index.html">latest</a></li></ul></li><li class="component"><span class="title">Component reference</span><ul class="versions"><li class="version is-latest"><a href="../../components/latest/index.html">latest</a></li></ul></li><li class="component is-current"><span class="title">User manual</span><ul class="versions"><li class="version is-current is-latest"><a href="index.html">latest</a></li></ul></li></ul></div></div></aside></div><main class="main"><div class="toolbar" role="navigation"><button class="navigation-toggle"></button><a href="index.html" class="home-link"></a><nav class="crumbs" aria-label="breadcrumbs"><ul><li class="crumb"><a href="index.html">User manual</a></li><li class="crumb"><a href="architecture.html">Architecture</a></li><li class="crumb"><a href="lifecycle.html">Camel Lifecycle</a></li></ul></nav><div class="edit-this-page"><a href="https://github.com/apache/camel/edit/master/docs/user-manual/modules/ROOT/pages/lifecycle.adoc">Edit this Page</a></div></div><article class="doc"><div class="sect2"><h3 id="Lifecycle-CamelLifecycle"><a class="anchor" href="#Lifecycle-CamelLifecycle"></a>Camel Lifecycle</h3><div class="paragraph"><p>Camel uses a simple<em>lifecycle</em>interface called<a href="http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/Service.html">Service</a>which has a single start() and stop() method.</p></div><div class="paragraph"><p>Various classes implement Service such as CamelContext along with a number of Component and Endpoint classes.</p></div><div class="paragraph"><p>When you use Camel you typically have to start the CamelContext which will start all the various components and endpoints and activate the routing rules until the context is stopped again.</p></div><div class="paragraph"><p>If you are working with Spring you may wish to read the Camel Spring documentation.</p></div><div class="sect3"><h4 id="Lifecycle-CamelContextLifecycle"><a class="anchor" href="#Lifecycle-CamelContextLifecycle"></a>CamelContext Lifecycle</h4><div class="paragraph"><p>The<code>CamelContext</code>provides methods to control its lifecycle:</p></div><div class="ulist"><ul><li><p><code>start</code></p></li><li><p><code>stop</code></p></li><li><p><code>suspend</code><strong>Camel 2.5</strong></p></li><li><p><code>resume</code><strong>Camel 2.5</strong></p></li></ul></div><div class="paragraph"><p>The operations is paired: start/stop and suspend/resume.</p></div><div class="paragraph"><p>Stop is performing a Graceful shutdown which means all its internal state, cache, etc is cleared. And the routes is being stopped in a graceful manner to ensure messages are given time to complete. If you start a<code>CamelContext</code>after a stop, then its performing a<em>cold</em>start, recreating all the state, cache etc. again.</p></div><div class="paragraph"><p>Instead you can use the suspend/resume operations. They will keep the<code>CamelContext</code><em>warm</em>and only suspend/stop routes using the same Graceful shutdown feature. This ensures messages are given time to complete.</p></div><div class="paragraph"><p>End users is encouraged to use suspend/resume if you are temporary stopping a Camel application.</p></div><div class="paragraph"><p>All these operations is available in JMX as well, so you can control Camel from a management console.</p></div><div class="paragraph"><p>If you write unit tests and perform<em>cold</em>restarts using stop/start then any previously looked up Endpoints etc. is obsolete, and therefore you need to re-lookup those endpoints again.</p></div><div class="paragraph"><p>Instead use suspend/resume which keeps these Endpoints and therefore you can still use them after resuming.</p></div></div><div class="sect3"><h4 id="Lifecycle-Servicelifecycle"><a class="anchor" href="#Lifecycle-Servicelifecycle"></a>Service lifecycle</h4><div class="paragraph"><p>A service (<code>org.apache.camel.Service</code>) in Camel adheres to the following lifecycle states as illustrated in the diagram below:</p></div><div class="paragraph"><p><span class="image"><img src="_images/lifecycle.data/service_lifecycle.png" alt="image"></span></p></div><div class="paragraph"><p><strong>Notice:</strong>A service can optimally support suspend/resume by the<code>org.apache.camel.SuspendableService</code>. This means not all services in Camel supports suspension. It&#8217;s encouraged that consumers support suspension which allows to suspend/resume routes.</p></div><div class="paragraph"><p>The<code>org.apache.camel.support.service.ServiceSupport</code>is a good base class to extend for custom services as it offers the basic functionally to keep track of state. You implement your custom logic in the<code>doStart</code>,<code>doStop</code>,<code>doSuspend</code>,<code>doResume</code>methods.</p></div></div><div class="sect3"><h4 id="Lifecycle-Routeslifecycle"><a class="anchor" href="#Lifecycle-Routeslifecycle"></a>Routes lifecycle</h4><div class="paragraph"><p>Routes in Camel have the following operations to control its lifecycle</p></div><div class="ulist"><ul><li><p><code>start</code></p></li><li><p><code>stop</code></p></li><li><p><code>suspend</code></p></li><li><p><code>resume</code></p></li><li><p><code>remove</code>(previously named shutdown)</p></li></ul></div><div class="paragraph"><p>The<code>remove</code>operation will<strong>remove</strong>the route, for example in JMX the route will then be unregistered and its gone. So only use remove if you really want to remove the route. The route must have been stopped before you can remove.</p></div><div class="paragraph"><p>The<code>start</code>and<code>resume</code>operations in JMX checks the state beforehand. So if a route is stopped and you click<code>resume</code>, it will know to invoke<code>start</code>. And likewise if a route has been suspended and you click<code>start</code>it knows to<code>resume</code>instead. This makes management a bit easier.</p></div><div class="paragraph"><p>If a route is suspended then it keeps its resources and all their JMX metrics alive. Where as stopping a route will graceful stop the route, and clear its resources, and as well their JMX metrics. If you want to temporary "pause" a route, then consider using suspend/resume over stop/start.</p></div><div class="paragraph"><p>If a route consumer does not support suspension, it will fallback and stop the route instead.</p></div></div><div class="sect3"><h4 id="Lifecycle-SeeAlso"><a class="anchor" href="#Lifecycle-SeeAlso"></a>See Also</h4><div class="ulist"><ul><li><p><a href="camelcontext.adoc">CamelContext</a></p></li><li><p><a href="architecture.adoc">Architecture</a></p></li><li><p>JMX</p></li></ul></div></div></div></article></main></div><footer class="footer"><p>This page was built using the Antora default UI.</p><p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p></footer><script src="../../_/js/site.js"></script><script src="../../_/js/vendor/highlight.js"></script><script>hljs.initHighlighting()</script></body></html>