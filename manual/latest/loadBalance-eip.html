<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Untitled :: Apache Camel</title><link rel="canonical" href="https://camel.apache.org/staging/manual/latest/loadBalance-eip.html"><meta name="generator" content="Antora 2.0.0"><link rel="stylesheet" href="../../_/css/site.css"></head><body class="article"><header class="header"><nav class="navbar shadow border-bottom"><div class="navbar-brand"><a class="navbar-item nav-logo" href="../.." title="Apache Camel"></a><button class="navbar-burger" data-target="topbar-nav"><span></span><span></span><span></span></button></div><div id="topbar-nav" class="navbar-menu"><div class="navbar-end"><a class="navbar-item" href="../../">Home</a><a class="navbar-item" href="../../news/">News</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../..#">Projects</a><div class="navbar-dropdown"><a class="navbar-item" href="../../projects/camel-k/">Camel K</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../..#">Documentation</a><div class="navbar-dropdown"><a class="navbar-item" href="../../docs/getting-started/">Getting started</a><a class="navbar-item" href="../../manual/latest/">User manual</a><a class="navbar-item" href="../../components/latest/">Component reference</a><a class="navbar-item" href="../../camel-k/latest/">Camel K</a></div></div><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../..#">Community</a><div class="navbar-dropdown"><a class="navbar-item" href="../../community/support/">Support</a><a class="navbar-item" href="../..https://github.com/apache/camel/blob/master/CONTRIBUTING.md">Contributing</a><a class="navbar-item" href="../../community/user-stories/">User stories</a><a class="navbar-item" href="../../community/articles/">Articles</a><a class="navbar-item" href="../../community/books/">Books</a><a class="navbar-item" href="../../community/team/">Team</a><a class="navbar-item" href="../../community/camel-extra/">Camel extra</a></div></div><a class="navbar-item" href="../../download/">Download</a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link" href="../..#">About</a><div class="navbar-dropdown"><a class="navbar-item" href="../..https://www.apache.org/events/current-event.html">Apache events</a><a class="navbar-item" href="../..https://www.apache.org/licenses/">License</a><a class="navbar-item" href="../../security/">Security</a><a class="navbar-item" href="../..https://www.apache.org/foundation/sponsorship.html">Sponsorship</a><a class="navbar-item" href="../..https://www.apache.org/foundation/thanks.html">Thanks</a></div></div></div></div></nav></header><div class="main-wrapper"><div class="navigation-container" data-component="manual" data-version="latest"><aside class="navigation"><div class="panels"><div class="navigation-menu is-active" data-panel="menu"><nav class="nav-menu"><h3 class="title"><a href="index.html">User manual</a></h3><ul class="nav-list"><li class="nav-item" data-depth="0"><ul class="nav-list"><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="getting-started.html">Getting started</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="book-getting-started.html">Getting Started with Apache Camel</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="architecture.html">Architecture</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="async.html">Async</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="asynchronous-routing-engine.html">Asynchronous Routing Engine</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="backlogdebugger.html">Backlog debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bam.html">Business Activity Monitoring</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="batch-consumer.html">Batch Consumer</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="browsable-endpoint.html">BrowsableEndpoint</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camel-core.html">Core</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="camelcontext.html">Context</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="endpoint.html">Endpoints</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="cep.html">Complex Event Processing</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="component.html">Component</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="debugger.html">Debugger</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="delay-interceptor.html">Delay interceptor</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dependency-injection.html">Dependency Injection</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dozer-type-conversion.html">Dozer Type Conversion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bean-integration.html">Bean Integration</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="error-handler.html">Error Handler</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange.html">Message Exchange</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchange-pattern.html">Exchange Pattern</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="expression.html">Expressions</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="injector.html">Injector</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="intercept.html">Intercept</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="inversion-of-control-with-smart-defaults.html">Inversion Of Control With Smart Defaults</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="jmx.html">JMX</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="lifecycle.html">Camel Lifecycle</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="oncompletion.html">OnCompletion</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="predicate.html">Predicates</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="registry.html">Registry</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="route-builder.html">RouteBuilder</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="routes.html">Routes</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><span class="nav-text">Domain Specific Languages</span><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="dsl.html">Camel Domain Specific Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="java-dsl.html">Java DSL</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="spring.html">Spring support</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="groovy-dsl.html">Groovy DSL</a></li></ul></li><li class="nav-item" data-depth="1"><a class="nav-link" href="using-osgi-blueprint-with-camel.html">Using OSGi blueprint with Camel</a></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><span class="nav-text">Camel Core Features</span><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="bean-language.html">Bean method Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="clustering.html">Clustering</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="constant-language.html">Constant Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dynamic-router.html">Dynamic Router</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="exchangeProperty-language.html">ExchangeProperty Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="file-language.html">File Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="header-language.html">Header Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="health-check.html">Health Check</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="ref-language.html">Ref Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="rest-dsl.html">REST DSL Component</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="return-address.html">Return Address</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="service-registry.html">Service Registry</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="simple-language.html">Simple Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="tokenize-language.html">Tokenize Language</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="transformer.html">Transformer</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="validator.html">Validator</a></li></ul></li><li class="nav-item" data-depth="1"><button class="nav-toggle"></button><a class="nav-link" href="enterprise-integration-patterns.html">Enterprise Integration Patterns</a><ul class="nav-list"><li class="nav-item" data-depth="2"><a class="nav-link" href="aggregate-eip.html">Aggregate EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="batch-config-eip.html">Batch-config EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="bean-eip.html">Bean EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="choice-eip.html">Choice EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="circuitBreaker-eip.html">Circuit Breaker EIP (deprecated)</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="claimCheck-eip.html">Claim Check EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="content-based-router-eip.html">Content Based Router</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="content-filter-eip.html">Content Filter</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="convertBodyTo-eip.html">Convert Body To EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="correlation-identifier.html">Correlation Identifier</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="customLoadBalancer-eip.html">Custom Load Balancer EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dead-letter-channel.html">Dead Letter Channel</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="delay-eip.html">Delay EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="dynamicRouter-eip.html">Dynamic Router EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="enrich-eip.html">Enrich EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="event-message.html">Event Message</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="eventDrivenConsumer-eip.html">Event Driven Consumer</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="failover-eip.html">Failover EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="filter-eip.html">Filter EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="from-eip.html">From EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="guaranteed-delivery.html">Guaranteed Delivery</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="hystrix-eip.html">Hystrix EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="hystrixConfiguration-eip.html">Hystrix Configuration EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="idempotentConsumer-eip.html">Idempotent Consumer EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="inOnly-eip.html">In Only EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="inOut-eip.html">In Out EIP</a></li><li class="nav-item is-current-page" data-depth="2"><a class="nav-link" href="loadBalance-eip.html">Load Balance EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="log-eip.html">Log EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="loop-eip.html">Loop EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="marshal-eip.html">Marshal EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="message-bus.html">Message Bus</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="message-channel.html">Message Channel</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="message-endpoint.html">Message Endpoint</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="message-router.html">Message Router</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="message-translator.html">Message Translator</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="message.html">Message</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="multicast-eip.html">Multicast EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="onFallback-eip.html">On Fallback EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="otherwise-eip.html">Otherwise EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="pipeline-eip.html">Pipeline EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="point-to-point-channel.html">Point to Point Channel</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="pollEnrich-eip.html">Poll Enrich EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="process-eip.html">Process EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="publish-subscribe-channel.html">Publish Subscribe Channel</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="random-eip.html">Random EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="recipientList-eip.html">Recipient List EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="removeHeader-eip.html">Remove Header EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="removeHeaders-eip.html">Remove Headers EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="removeProperties-eip.html">Remove Properties EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="removeProperty-eip.html">Remove Property EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="requestReply-eip.html">Request Reply</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="resequence-eip.html">Resequence EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="rollback-eip.html">Rollback EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="roundRobin-eip.html">Round Robin EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="routingSlip-eip.html">Routing Slip EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="saga-eip.html">Saga EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="sample-eip.html">Sample EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="script-eip.html">Script EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="serviceCall-eip.html">Service Call EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="setBody-eip.html">Set Body EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="setFaultBody-eip.html">Set Fault Body EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="setHeader-eip.html">Set Header EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="setOutHeader-eip.html">Set Out Header EIP (deprecated)</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="setProperty-eip.html">Set Property EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="sort-eip.html">Sort EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="split-eip.html">Split EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="step-eip.html">Step EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="sticky-eip.html">Sticky EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="stop-eip.html">Stop EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="stream-config-eip.html">Stream-config EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="threads-eip.html">Threads EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="throttle-eip.html">Throttle EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="to-eip.html">To EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="toD-eip.html">To D EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="topic-eip.html">Topic EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="transactional-client.html">Transactional Client</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="transform-eip.html">Transform EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="unmarshal-eip.html">Unmarshal EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="validate-eip.html">Validate EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="weighted-eip.html">Weighted EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="when-eip.html">When EIP</a></li><li class="nav-item" data-depth="2"><a class="nav-link" href="wireTap-eip.html">Wire Tap EIP</a></li></ul></li></ul></li></ul></nav></div><div class="navigation-explore" data-panel="explore"><div class="context"><span class="title">User manual</span><span class="version">latest</span></div><ul class="components"><li class="component"><span class="title">Apache Camel K</span><ul class="versions"><li class="version is-latest"><a href="../../camel-k/latest/index.html">latest</a></li></ul></li><li class="component"><span class="title">Component reference</span><ul class="versions"><li class="version is-latest"><a href="../../components/latest/index.html">latest</a></li></ul></li><li class="component is-current"><span class="title">User manual</span><ul class="versions"><li class="version is-current is-latest"><a href="index.html">latest</a></li></ul></li></ul></div></div></aside></div><main class="main"><div class="toolbar" role="navigation"><button class="navigation-toggle"></button><a href="index.html" class="home-link"></a><nav class="crumbs" aria-label="breadcrumbs"><ul><li class="crumb"><a href="index.html">User manual</a></li><li class="crumb"><a href="enterprise-integration-patterns.html">Enterprise Integration Patterns</a></li><li class="crumb"><a href="loadBalance-eip.html">Load Balance EIP</a></li></ul></nav><div class="edit-this-page"><a href="https://github.com/apache/camel/edit/master/docs/user-manual/modules/ROOT/pages/loadBalance-eip.adoc">Edit this Page</a></div></div><article class="doc"><div class="sect1"><h2 id="loadBalance-eip"><a class="anchor" href="#loadBalance-eip"></a>Load Balance EIP</h2><div class="sectionbody"><div class="paragraph"><p>The Load Balancer Pattern allows you to delegate to one of a number of endpoints using a variety of different load balancing policies.</p></div></div></div><div class="sect1"><h2 id="_built_in_load_balancing_policies"><a class="anchor" href="#_built_in_load_balancing_policies"></a>Built-in load balancing policies</h2><div class="sectionbody"><div class="paragraph"><p>Camel provides the following policies out-of-the-box:</p></div><table class="tableblock frame-all grid-all stretch"><colgroup><col style="width: 33.3333%;"><col style="width: 66.6667%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Policy</th><th class="tableblock halign-left valign-top">Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Round Robin</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">The exchanges are selected from in a round robin fashion. This is a well known and classic policy, which spreads the load evenly.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Random</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">A random endpoint is selected for each exchange.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Sticky</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Sticky load balancing using an Expression to calculate a correlation key to perform the sticky load balancing; rather like jsessionid in the web or JMSXGroupID in JMS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Topic</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Topic which sends to all destinations (rather like JMS Topics)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Failover</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">In case of failures the exchange will be tried on the next endpoint.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Weighted Round-Robin</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Camel 2.5</strong>: The weighted load balancing policy allows you to specify a processing load distribution ratio for each server with respect to the others. In addition to the weight, endpoint selection is then further refined using<strong>round-robin</strong>distribution based on weight.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Weighted Random</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Camel 2.5</strong>: The weighted load balancing policy allows you to specify a processing load distribution ratio for each server with respect to others.In addition to the weight, endpoint selection is then further refined using<strong>random</strong>distribution based on weight.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Custom</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Camel 2.8</strong>: From<strong>Camel 2.8</strong>onwards the preferred way of using a custom Load Balancer is to use this policy, as the ref attribute is not supported anymore.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Circuit Breaker</p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Camel 2.14</strong>: Implements the Circuit Breaker pattern as described in "Release it!" book.</p></td></tr></tbody></table><div class="sect2"><h3 id="_options"><a class="anchor" href="#_options"></a>Options</h3><div class="paragraph"><p>The Load Balance EIP supports 2 options which are listed below:</p></div><table class="tableblock frame-all grid-all stretch"><colgroup><col style="width: 20%;"><col style="width: 50%;"><col style="width: 10%;"><col style="width: 20%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Name</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-center valign-top">Default</th><th class="tableblock halign-left valign-top">Type</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>loadBalancerType</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required</strong>The load balancer to be used</p></td><td class="tableblock halign-center valign-top"></td><td class="tableblock halign-left valign-top"><p class="tableblock">LoadBalancerDefinition</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>inheritErrorHandler</strong></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Sets whether or not to inherit the configured error handler. The default value is true. You can use this to disable using the inherited error handler for a given DSL such as a load balancer where you want to use a custom error handler strategy.</p></td><td class="tableblock halign-center valign-top"><p class="tableblock">false</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td></tr></tbody></table></div><div class="sect2"><h3 id="_round_robin"><a class="anchor" href="#_round_robin"></a>Round Robin</h3><div class="paragraph"><p>The round robin load balancer is not meant to work with failover, for that you should use the dedicated<strong>failover</strong>load balancer. The round robin load balancer will only change to next endpoint per message. The round robin load balancer is stateful as it keeps state of which endpoint to use next time.</p></div><div class="paragraph"><p>Here is a little example:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("direct:start")
    .loadBalance().roundRobin()
        .to("mock:x")
        .to("mock:y")
        .to("mock:z")
    .end() // end load balancer</code></pre></div></div><div class="paragraph"><p>And in XML:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;camelContext id="camel" xmlns="http://camel.apache.org/schema/spring"&gt;
  &lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;loadBalance&gt;
        &lt;roundRobin/&gt;
        &lt;to uri="mock:x"/&gt;
        &lt;to uri="mock:y"/&gt;
        &lt;to uri="mock:z"/&gt;
    &lt;/loadBalance&gt;
  &lt;/route&gt;
&lt;/camelContext&gt;</code></pre></div></div><div class="paragraph"><p>The above example loads balance requests from<strong>direct:start</strong>to one of the available<strong>mock endpoint</strong>instances, in this case using a round robin policy.</p></div></div><div class="sect2"><h3 id="_failover"><a class="anchor" href="#_failover"></a>Failover</h3><div class="paragraph"><p>The failover load balancer is capable of trying the next processor in case an Exchange failed with an exception during processing. You can constrain the failover to activate only when one exception of a list you specify occurs. If you do not specify a list any exception will cause fail over to occur. This balancer uses the same strategy for matching exceptions as the Exception Clause does for the<code>onException</code>.</p></div><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><strong>Enable stream caching if using streams:</strong>If you use streaming then you should enable Stream caching when using the failover load balancer. This is needed so the stream can be re-read after failing over to the next processor.</td></tr></table></div><div class="paragraph"><p>Here is a sample to failover only if a IOException related exception was thrown:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("direct:start")
    // here we will load balance if IOException was thrown
    // any other kind of exception will result in the Exchange as failed
    // to failover over any kind of exception we can just omit the exception
    // in the failOver DSL
    .loadBalance().failover(IOException.class)
        .to("mock:x")
        .to("mock:y")
        .to("mock:z");</code></pre></div></div><div class="paragraph"><p>You can specify multiple exceptions to failover as the option is varargs, for instance:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// enable maximum redelivery so failover can react
errorHandler(defaultErrorHandler().maximumRedeliveries(5));

from("direct:foo").
    loadBalance().failover(IOException.class, MyOtherException.class)
        .to("direct:a")
        .to("direct:b");</code></pre></div></div><div class="paragraph"><p>And in XML:</p></div><div class="paragraph"><p>Failover can also be used from Spring DSL and you configure it as:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route errorHandlerRef="myErrorHandler"&gt;
   &lt;from uri="direct:foo"/&gt;
   &lt;loadBalance&gt;
       &lt;failover&gt;
           &lt;exception&gt;java.io.IOException&lt;/exception&gt;
           &lt;exception&gt;com.mycompany.MyOtherException&lt;/exception&gt;
       &lt;/failover&gt;
       &lt;to uri="direct:a"/&gt;
       &lt;to uri="direct:b"/&gt;
   &lt;/loadBalance&gt;
 &lt;/route&gt;</code></pre></div></div></div><div class="sect2"><h3 id="_using_failover_in_round_robin_mode"><a class="anchor" href="#_using_failover_in_round_robin_mode"></a>Using failover in round robin mode</h3><div class="paragraph"><p>An example using Java DSL:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">from("direct:start")
    // Use failover load balancer in stateful round robin mode
    // which mean it will failover immediately in case of an exception
    // as it does NOT inherit error handler. It will also keep retrying as
    // its configured to newer exhaust.
    .loadBalance().failover(-1, false, true)
        .to("direct:bad")
        .to("direct:bad2")
        .to("direct:good")
        .to("direct:good2");</code></pre></div></div><div class="paragraph"><p>And the same example using Spring XML:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route&gt;
    &lt;from uri="direct:start"/&gt;
    &lt;loadBalance&gt;
        &lt;!-- failover using stateful round robin,
             which will keep retrying forever those 4 endpoints until success.
             You can set the maximumFailoverAttempt to break out after X attempts --&gt;
        &lt;failover roundRobin="true"/&gt;
        &lt;to uri="direct:bad"/&gt;
        &lt;to uri="direct:bad2"/&gt;
        &lt;to uri="direct:good"/&gt;
        &lt;to uri="direct:good2"/&gt;
    &lt;/loadBalance&gt;
&lt;/route&gt;</code></pre></div></div><div class="admonitionblock tip"><table><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><strong>Disabled inheritErrorHandler</strong>: You can configure<code>inheritErrorHandler=false</code>if you want to failover to the next endpoint as fast as possible. By disabling the Error Handler you ensure it does not<em>intervene</em>which allows the<code>failover</code>load balancer to handle failover asap. By also enabling<code>roundRobin</code>mode, then it will keep retrying until it success. You can then configure the<code>maximumFailoverAttempts</code>option to a high value to let it eventually exhaust (give up) and fail.</td></tr></table></div></div><div class="sect2"><h3 id="_weighted_round_robin_and_random_load_balancing"><a class="anchor" href="#_weighted_round_robin_and_random_load_balancing"></a>Weighted Round-Robin and Random Load Balancing</h3><div class="paragraph"><p><strong>Available as of Camel 2.5</strong></p></div><div class="paragraph"><p>In many enterprise environments where server nodes of unequal processing power &amp; performance characteristics are utilized to host services and processing endpoints, it is frequently necessary to distribute processing load based on their individual server capabilities so that some endpoints are not unfairly burdened with requests. Obviously simple round-robin or random load balancing do not alleviate problems of this nature. A Weighted Round-Robin and/or Weighted Random load balancer can be used to address this problem. The weighted load balancing policy allows you to specify a processing load distribution ratio for each server with respect to others. You can specify this as a positive processing weight for each server. A larger number indicates that the server can handle a larger load. The weight is utilized to determine the payload distribution ratio to different processing endpoints with respect to others.</p></div><div class="paragraph"><p>The parameters that can be used are</p></div><table class="tableblock frame-all grid-all stretch"><colgroup><col style="width: 25%;"><col style="width: 8.3333%;"><col style="width: 16.6666%;"><col style="width: 50.0001%;"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Option</th><th class="tableblock halign-left valign-top">Type</th><th class="tableblock halign-left valign-top">Default</th><th class="tableblock halign-left valign-top">Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">roundRobin</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">The default value for round-robin is false. In the absence of this setting or parameter the load balancing algorithm used is random.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">distributionRatio</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">The distributionRatio is a delimited String consisting on integer weights separated by delimiters for example "2,3,5". The distributionRatio must match the number of endpoints and/or processors specified in the load balancer list.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">distributionRatioDelimiter</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">,</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">The distributionRatioDelimiter is the delimiter used to specify the distributionRatio. If this attribute is not specified a default delimiter "," is expected as the delimiter used for specifying the distributionRatio.</p></td></tr></tbody></table></div><div class="sect2"><h3 id="_using_weighted_round_robin_random_load_balancing"><a class="anchor" href="#_using_weighted_round_robin_random_load_balancing"></a>Using Weighted round-robin &amp; random load balancing</h3><div class="paragraph"><p><strong>Available as of Camel 2.5</strong></p></div><div class="paragraph"><p>An example using Java DSL:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">List&lt;integer&gt; distributionRatio = new ArrayList&lt;integer&gt;();
distributionRatio.add(4);
distributionRatio.add(2);
distributionRatio.add(1);

// round-robin
from("direct:start")
    .loadBalance().weighted(true, distributionRatio)
    .to("mock:x", "mock:y", "mock:z");

//random
from("direct:start")
    .loadBalance().weighted(false, distributionRatio)
    .to("mock:x", "mock:y", "mock:z");</code></pre></div></div><div class="paragraph"><p>And the same example using Spring XML:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route&gt;
  &lt;from uri="direct:start"/&gt;
  &lt;loadBalance&gt;
    &lt;weighted roundRobin="false"
              distributionRatio="4 2 1"/&gt;
      &lt;to uri="mock:x"/&gt;
      &lt;to uri="mock:y"/&gt;
      &lt;to uri="mock:z"/&gt;
  &lt;/loadBalance&gt;
&lt;/route&gt;</code></pre></div></div><div class="paragraph"><p>An example using Java DSL:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// round-robin
from("direct:start")
    .loadBalance().weighted(true, "4:2:1" distributionRatioDelimiter=":")
    .to("mock:x", "mock:y", "mock:z");

//random
from("direct:start")
    .loadBalance().weighted(false, "4,2,1")
    .to("mock:x", "mock:y", "mock:z");</code></pre></div></div><div class="paragraph"><p>And the same example using Spring XML:</p></div><div class="listingblock"><div class="content"><pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;route&gt;
  &lt;from uri="direct:start"/&gt;
  &lt;loadBalance&gt;
    &lt;weighted roundRobin="false"
              distributionRatio="4-2-1" distributionRatioDelimiter="-" /&gt;
      &lt;to uri="mock:x"/&gt;
      &lt;to uri="mock:y"/&gt;
      &lt;to uri="mock:z"/&gt;
  &lt;/loadBalance&gt;
&lt;/route&gt;</code></pre></div></div></div></div></div></article></main></div><footer class="footer"><p>This page was built using the Antora default UI.</p><p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p></footer><script src="../../_/js/site.js"></script><script src="../../_/js/vendor/highlight.js"></script><script>hljs.initHighlighting()</script></body></html>